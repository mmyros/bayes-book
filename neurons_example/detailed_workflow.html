
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neurons example via low-level, flexible interface &#8212; Bayes Window examples</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Compare to alternative models" href="model_comparison.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bayes Window examples</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/metropolis.html">
   Intuition for maximal likelihood or posterior inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../radon_example/radon.html">
   Radon example from Gelman and Hill (2006)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_lfp.html">
   Multilevel modeling of LFP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_neurons.html">
   Bayesian Methods for Multilevel Modeling of Neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/quick_lfp.html">
   LFP example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_stim_strength.html">
   LFP example with stim strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_roc.html">
   Compare to ANOVA and LMM: ROC curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Neurons example, pt. 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="posteriors.html">
   Neurons example, no slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_strength.html">
   Neurons example with nominal stim strengths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_type.html">
   Neurons example with stim types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lme.html">
   Linear mixed effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monster.html">
   Neurons example, pt. 2: large datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_comparison.html">
   Compare to alternative models
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Neurons example via low-level, flexible interface
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mmyros/bayes-window"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mmyros/bayes-window/issues/new?title=Issue%20on%20page%20%2Fneurons_example/detailed_workflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mmyros/bayes-window/master?urlpath=tree/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare">
   Prepare
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-data">
   Make some data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimate-model">
   Estimate model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-data-back">
   Add data back
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-elements-of-interactivity-wip">
   Appendix: Elements of interactivity (WIP)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neurons-example-via-low-level-flexible-interface">
<h1>Neurons example via low-level, flexible interface<a class="headerlink" href="#neurons-example-via-low-level-flexible-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare">
<h2>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">bayes_window.fitting</span> <span class="kn">import</span> <span class="n">fit_numpyro</span>
<span class="kn">from</span> <span class="nn">bayes_window.generative_models</span> <span class="kn">import</span> <span class="n">generate_fake_spikes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/optimizers.py:30: FutureWarning: jax.experimental.optimizers is deprecated, import jax.example_libraries.optimizers instead
  FutureWarning)
/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/stax.py:30: FutureWarning: jax.experimental.stax is deprecated, import jax.example_libraries.stax instead
  FutureWarning)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-data">
<h2>Make some data<a class="headerlink" href="#make-some-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">df_monster</span><span class="p">,</span> <span class="n">index_cols</span><span class="p">,</span> <span class="n">firing_rates</span> <span class="o">=</span> <span class="n">generate_fake_spikes</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                                <span class="n">n_neurons</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                                                <span class="n">n_mice</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                <span class="n">dur</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="p">)</span>


<span class="c1"># df[&#39;log_isi&#39;] = np.log10(df[&#39;isi&#39;])</span>

<span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">visualization</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>

<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;isi&#39;</span>
<span class="n">ddf</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_fold_change</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                 <span class="n">index_cols</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">),</span>
                                 <span class="n">treatment_name</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span>
                                 <span class="n">do_take_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span>  <span class="n">df</span><span class="o">=</span><span class="n">ddf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-585135143f0d4162af411e8be9c90f4e"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-585135143f0d4162af411e8be9c90f4e") {
      outputDiv = document.getElementById("altair-viz-585135143f0d4162af411e8be9c90f4e");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.8}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "size": {"value": 1.0}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right"}, "field": "isi diff", "scale": {"domain": [0.7450582039811269, 1.085515293704091], "zero": false}, "title": "isi diff"}}}, {"mark": {"type": "circle", "clip": true, "filled": true, "opacity": 0}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7450582039811269, 1.085515293704091], "zero": false}}}}, {"mark": {"type": "boxplot", "clip": true, "color": "black", "median": {"color": "red", "strokeWidth": 20}, "opacity": 0.3, "size": 9}, "encoding": {"x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7450582039811269, 1.085515293704091], "zero": false}}}}], "data": {"name": "data-0cc0f8dd8c3b5f13a17fe8499aa524d0"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-0cc0f8dd8c3b5f13a17fe8499aa524d0": [{"mouse": "m0bayes", "neuron": "0", "isi diff": 0.7190275147101367}, {"mouse": "m0bayes", "neuron": "1", "isi diff": 0.7969173981392154}, {"mouse": "m0bayes", "neuron": "2", "isi diff": 0.9892519115220654}, {"mouse": "m0bayes", "neuron": "3", "isi diff": 0.9972035306620419}, {"mouse": "m0bayes", "neuron": "4", "isi diff": 1.0675928808863584}, {"mouse": "m0bayes", "neuron": "5", "isi diff": 0.9553571424319972}, {"mouse": "m0bayes", "neuron": "6", "isi diff": 0.9985506445015018}, {"mouse": "m0bayes", "neuron": "7", "isi diff": 0.9791355308074353}, {"mouse": "m1bayes", "neuron": "0", "isi diff": 1.058442328171733}, {"mouse": "m1bayes", "neuron": "1", "isi diff": 1.090125421933474}, {"mouse": "m1bayes", "neuron": "2", "isi diff": 1.171494948487966}, {"mouse": "m1bayes", "neuron": "3", "isi diff": 0.9635678550311328}, {"mouse": "m1bayes", "neuron": "4", "isi diff": 0.9347442850452814}, {"mouse": "m1bayes", "neuron": "5", "isi diff": 0.8818652074460641}, {"mouse": "m1bayes", "neuron": "6", "isi diff": 0.9093873460530065}, {"mouse": "m1bayes", "neuron": "7", "isi diff": 0.9350556457565261}, {"mouse": "m2bayes", "neuron": "0", "isi diff": 0.8470189031385496}, {"mouse": "m2bayes", "neuron": "1", "isi diff": 0.817718393122591}, {"mouse": "m2bayes", "neuron": "2", "isi diff": 0.7528746871985221}, {"mouse": "m2bayes", "neuron": "3", "isi diff": 0.8485723375071108}, {"mouse": "m2bayes", "neuron": "4", "isi diff": 0.8877475756628151}, {"mouse": "m2bayes", "neuron": "5", "isi diff": 0.8066856864067586}, {"mouse": "m2bayes", "neuron": "6", "isi diff": 1.0796664129411726}, {"mouse": "m2bayes", "neuron": "7", "isi diff": 1.0658560853814145}, {"mouse": "m3bayes", "neuron": "0", "isi diff": 0.7817160078796743}, {"mouse": "m3bayes", "neuron": "1", "isi diff": 0.8666663124173568}, {"mouse": "m3bayes", "neuron": "2", "isi diff": 1.0817433706073234}, {"mouse": "m3bayes", "neuron": "3", "isi diff": 0.7480905607798047}, {"mouse": "m3bayes", "neuron": "4", "isi diff": 0.7413519901160761}, {"mouse": "m3bayes", "neuron": "5", "isi diff": 0.9515371061607204}, {"mouse": "m3bayes", "neuron": "6", "isi diff": 0.9540532615197737}, {"mouse": "m3bayes", "neuron": "7", "isi diff": 0.9436336596128089}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>TODO leave axis labels here somehow</p>
</div>
<div class="section" id="estimate-model">
<h2>Estimate model<a class="headerlink" href="#estimate-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y = list(set(df.columns) - set(index_cols))[0]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">fit_numpyro</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">treatment</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">condition</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">]),</span>
                    <span class="n">group</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">]),</span>
                    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">model_hierarchical</span><span class="p">,</span>
                    <span class="n">n_draws</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-data-back">
<h2>Add data back<a class="headerlink" href="#add-data-back" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload(utils)</span>
<span class="c1"># df_both, trace = utils.add_data_to_posterior(df, posterior=trace.posterior, y=y,</span>
<span class="c1">#                                              fold_change_index_cols=[&#39;neuron&#39;, &#39;stim&#39;, &#39;mouse_code&#39;, ],</span>
<span class="c1">#                                              treatment_name=&#39;stim&#39;, b_name=&#39;slope_per_condition&#39;,</span>
<span class="c1">#                                              posterior_index_name=&#39;neuron&#39;, group_name=&#39;mouse&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + [markdown] hideCode=false hidePrompt=false</span>
<span class="c1"># # ## Plot data and posterior</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># # BayesWindow.lot(df_both, y=f&#39;{y} diff&#39;, x=&#39;neuron&#39;,color=&#39;mouse_code&#39;,title=y,hold_for_facet=False,add_box=False)</span>
<span class="c1"># reload(visualization)</span>
<span class="c1">#</span>
<span class="c1"># chart_d, _ = visualization.plot_data(df=df_both, x=&#39;neuron&#39;, y=f&#39;{y} diff&#39;, color=&#39;mouse_code&#39;, highlight=False)</span>
<span class="c1"># chart_d</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># chart_p = visualization.plot_posterior(df=df_both, title=f&#39;d_{y}&#39;, x=&#39;neuron&#39;, )</span>
<span class="c1"># chart_p</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).resolve_scale(y=&#39;independent&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).facet(column=&#39;neuron&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix-elements-of-interactivity-wip">
<h2>Appendix: Elements of interactivity (WIP)<a class="headerlink" href="#appendix-elements-of-interactivity-wip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="c1">#axis=alt.Axis(labels=False, tickCount=0, title=&#39;&#39;)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">lines</span><span class="o">+</span><span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-58dd712636274d4483b16bfc72265693"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-58dd712636274d4483b16bfc72265693") {
      outputDiv = document.getElementById("altair-viz-58dd712636274d4483b16bfc72265693");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector001"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04519778488110683, 0.0906936690568172], "zero": false}}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04519778488110683, 0.0906936690568172], "zero": false}}}, "selection": {"selector001": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}], "data": {"name": "data-3ba3f59f2fc89b817c4c9e41752b2a18"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3ba3f59f2fc89b817c4c9e41752b2a18": [{"stim": 0, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "neuron": "0", "log_firing_rate": 1.4823317424776943, "Firing rate": 30.3620955369312, "firing_rate": 30.3620955369312, "i_spike": 31.0, "isi": 0.11391531426344723}, {"stim": 0, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "neuron": "0", "log_firing_rate": 1.9053599858476944, "Firing rate": 80.41924395351046, "firing_rate": 80.41924395351046, "i_spike": 41.0, "isi": 0.08564449352619705}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "neuron": "1", "log_firing_rate": 1.5347866161337962, "Firing rate": 34.25994142711491, "firing_rate": 34.25994142711491, "i_spike": 35.5, "isi": 0.09876929102598327}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "neuron": "1", "log_firing_rate": 1.931927010005301, "Firing rate": 85.49230175969583, "firing_rate": 85.49230175969583, "i_spike": 43.5, "isi": 0.07951405583879766}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "neuron": "2", "log_firing_rate": 1.9637049724985198, "Firing rate": 91.98244988328057, "firing_rate": 91.98244988328057, "i_spike": 44.5, "isi": 0.0786894371144926}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "neuron": "2", "log_firing_rate": 2.1726406756275276, "Firing rate": 148.81293273032165, "firing_rate": 148.81293273032165, "i_spike": 57.0, "isi": 0.06061765839988263}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "neuron": "3", "log_firing_rate": 1.8697345602859143, "Firing rate": 74.08572927480215, "firing_rate": 74.08572927480215, "i_spike": 55.0, "isi": 0.06308793011716636}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "neuron": "3", "log_firing_rate": 2.309429278139167, "Firing rate": 203.90565862707345, "firing_rate": 203.90565862707345, "i_spike": 53.5, "isi": 0.06383527230970894}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "neuron": "4", "log_firing_rate": 1.983561126526814, "Firing rate": 96.28555244170859, "firing_rate": 96.28555244170859, "i_spike": 63.0, "isi": 0.05293131331875113}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "neuron": "4", "log_firing_rate": 2.2016876229839437, "Firing rate": 159.10639034301386, "firing_rate": 159.10639034301386, "i_spike": 60.5, "isi": 0.05786932098862121}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "neuron": "5", "log_firing_rate": 1.7935199493911673, "Firing rate": 62.16128009868512, "firing_rate": 62.16128009868512, "i_spike": 55.0, "isi": 0.06381429644474441}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "neuron": "5", "log_firing_rate": 2.1392160547878367, "Firing rate": 137.7894779756089, "firing_rate": 137.7894779756089, "i_spike": 67.0, "isi": 0.05244195010573857}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "neuron": "6", "log_firing_rate": 2.0023106465379197, "Firing rate": 100.53346390568842, "firing_rate": 100.53346390568842, "i_spike": 76.0, "isi": 0.045713594739345935}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "neuron": "6", "log_firing_rate": 1.931772670141282, "Firing rate": 85.46192484620785, "firing_rate": 85.46192484620785, "i_spike": 58.0, "isi": 0.059966278112984744}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "neuron": "7", "log_firing_rate": 1.8706429054289384, "Firing rate": 74.24084484693493, "firing_rate": 74.24084484693493, "i_spike": 70.5, "isi": 0.04786867724301966}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "neuron": "7", "log_firing_rate": 1.9251002131539279, "Firing rate": 84.15893153991013, "firing_rate": 84.15893153991013, "i_spike": 62.0, "isi": 0.05669230167600466}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "neuron": "0", "log_firing_rate": 1.5963997051779304, "Firing rate": 39.48205100127425, "firing_rate": 39.48205100127425, "i_spike": 46.5, "isi": 0.07544081391415867}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "neuron": "0", "log_firing_rate": 2.022931289796446, "Firing rate": 105.42200938859865, "firing_rate": 105.42200938859865, "i_spike": 43.5, "isi": 0.07928190519695166}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "neuron": "1", "log_firing_rate": 1.8847620122199715, "Firing rate": 76.69411003478032, "firing_rate": 76.69411003478032, "i_spike": 42.5, "isi": 0.0805221466849667}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "neuron": "1", "log_firing_rate": 1.6870690559160828, "Firing rate": 48.64845540511306, "firing_rate": 48.64845540511306, "i_spike": 49.0, "isi": 0.07119213900726805}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "neuron": "2", "log_firing_rate": 1.8042814957889326, "Firing rate": 63.72084051865186, "firing_rate": 63.72084051865186, "i_spike": 53.5, "isi": 0.06486078462562267}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "neuron": "2", "log_firing_rate": 1.812738739577918, "Firing rate": 64.97387066097617, "firing_rate": 64.97387066097617, "i_spike": 45.0, "isi": 0.07751264004859136}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "neuron": "3", "log_firing_rate": 1.7932113483134788, "Firing rate": 62.117125210934645, "firing_rate": 62.117125210934645, "i_spike": 57.5, "isi": 0.06025107059853679}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "neuron": "3", "log_firing_rate": 2.1560879909583157, "Firing rate": 143.24780994903625, "firing_rate": 143.24780994903625, "i_spike": 47.0, "isi": 0.07294401903311896}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.9478247986519952, "Firing rate": 88.679819127756, "firing_rate": 88.679819127756, "i_spike": 44.5, "isi": 0.07899076533196152}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.924157793434988, "Firing rate": 83.9765045291744, "firing_rate": 83.9765045291744, "i_spike": 58.5, "isi": 0.05836092870299298}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "neuron": "5", "log_firing_rate": 2.861262290866386, "Firing rate": 726.5446194290978, "firing_rate": 726.5446194290978, "i_spike": 60.5, "isi": 0.05789903793933455}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "neuron": "5", "log_firing_rate": 1.8487649597017897, "Firing rate": 70.59353984206975, "firing_rate": 70.59353984206975, "i_spike": 59.5, "isi": 0.05868423330107067}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "neuron": "6", "log_firing_rate": 2.041974857150948, "Firing rate": 110.14755393669158, "firing_rate": 110.14755393669158, "i_spike": 66.5, "isi": 0.05204810322034346}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "neuron": "6", "log_firing_rate": 2.7091944511883925, "Firing rate": 511.9109874704302, "firing_rate": 511.9109874704302, "i_spike": 60.0, "isi": 0.05833167857133595}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.9923758766699924, "Firing rate": 98.25980019053365, "firing_rate": 98.25980019053365, "i_spike": 77.0, "isi": 0.04446589229128702}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.9848078530698992, "Firing rate": 96.56235591381318, "firing_rate": 96.56235591381318, "i_spike": 58.0, "isi": 0.05424408303495761}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "neuron": "0", "log_firing_rate": 1.7549399772313259, "Firing rate": 56.87743165166483, "firing_rate": 56.87743165166483, "i_spike": 47.5, "isi": 0.07384261951928615}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "neuron": "0", "log_firing_rate": 1.8886497835791791, "Firing rate": 77.38375211434187, "firing_rate": 77.38375211434187, "i_spike": 38.5, "isi": 0.08981085312208036}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "neuron": "1", "log_firing_rate": 1.8307854908280923, "Firing rate": 67.73068857538004, "firing_rate": 67.73068857538004, "i_spike": 50.5, "isi": 0.06855270197512729}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "neuron": "1", "log_firing_rate": 1.7033585216589386, "Firing rate": 50.507808091168535, "firing_rate": 50.507808091168535, "i_spike": 37.5, "isi": 0.0918919978578989}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "neuron": "2", "log_firing_rate": 1.659050313572892, "Firing rate": 45.60897514735388, "firing_rate": 45.60897514735388, "i_spike": 37.0, "isi": 0.09352384428152762}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "neuron": "2", "log_firing_rate": 1.7217985206149538, "Firing rate": 52.69853238656132, "firing_rate": 52.69853238656132, "i_spike": 46.0, "isi": 0.07427842999245243}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "neuron": "3", "log_firing_rate": 2.1853531939344584, "Firing rate": 153.23331389359254, "firing_rate": 153.23331389359254, "i_spike": 53.0, "isi": 0.06315218364811459}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "neuron": "3", "log_firing_rate": 2.1751011659674813, "Firing rate": 149.65842346868348, "firing_rate": 149.65842346868348, "i_spike": 59.5, "isi": 0.0582094323739187}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "neuron": "4", "log_firing_rate": 1.7060634238375918, "Firing rate": 50.82336589662166, "firing_rate": 50.82336589662166, "i_spike": 48.0, "isi": 0.07251369061675603}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "neuron": "4", "log_firing_rate": 2.6135669467981613, "Firing rate": 410.7399508457043, "firing_rate": 410.7399508457043, "i_spike": 62.0, "isi": 0.05516325491725799}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "neuron": "5", "log_firing_rate": 3.0691272937097653, "Firing rate": 1172.5389917569075, "firing_rate": 1172.5389917569075, "i_spike": 64.5, "isi": 0.05345086578862158}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "neuron": "5", "log_firing_rate": 1.7176847350769948, "Firing rate": 52.20171065142432, "firing_rate": 52.20171065142432, "i_spike": 49.5, "isi": 0.07008222173096817}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "neuron": "6", "log_firing_rate": 2.5183521085267144, "Firing rate": 329.8770548572346, "firing_rate": 329.8770548572346, "i_spike": 60.0, "isi": 0.05757694442790462}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "neuron": "6", "log_firing_rate": 1.8939724903973418, "Firing rate": 78.3380019396553, "firing_rate": 78.3380019396553, "i_spike": 68.0, "isi": 0.05081750969708566}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "neuron": "7", "log_firing_rate": 2.0786055738039177, "Firing rate": 119.84104125669292, "firing_rate": 119.84104125669292, "i_spike": 69.0, "isi": 0.0500787356983985}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "neuron": "7", "log_firing_rate": 2.1578811978986114, "Firing rate": 143.8405045930675, "firing_rate": 143.8405045930675, "i_spike": 80.5, "isi": 0.04338727081483027}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.6495160227810624, "Firing rate": 44.618608578502176, "firing_rate": 44.618608578502176, "i_spike": 39.5, "isi": 0.08690581451575252}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.5695589998224289, "Firing rate": 37.115814868631325, "firing_rate": 37.115814868631325, "i_spike": 43.5, "isi": 0.07934652022518383}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "neuron": "1", "log_firing_rate": 2.041470871921473, "Firing rate": 110.01980526704189, "firing_rate": 110.01980526704189, "i_spike": 39.0, "isi": 0.08786302151316318}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "neuron": "1", "log_firing_rate": 2.598221822860374, "Firing rate": 396.4804913061626, "firing_rate": 396.4804913061626, "i_spike": 44.5, "isi": 0.07825404149274197}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "neuron": "2", "log_firing_rate": 1.7893723311682102, "Firing rate": 61.57045048722248, "firing_rate": 61.57045048722248, "i_spike": 51.0, "isi": 0.06711996849774152}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "neuron": "2", "log_firing_rate": 1.8028200206363394, "Firing rate": 63.50676939538161, "firing_rate": 63.50676939538161, "i_spike": 48.0, "isi": 0.07271103788042554}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "neuron": "3", "log_firing_rate": 2.106342800006212, "Firing rate": 127.74467331238401, "firing_rate": 127.74467331238401, "i_spike": 49.0, "isi": 0.0700079139710958}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "neuron": "3", "log_firing_rate": 1.6706697147616425, "Firing rate": 46.84569804833687, "firing_rate": 46.84569804833687, "i_spike": 40.0, "isi": 0.08761506017802866}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "neuron": "4", "log_firing_rate": 2.7102678550724413, "Firing rate": 513.1777934795683, "firing_rate": 513.1777934795683, "i_spike": 47.5, "isi": 0.07347941678267618}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "neuron": "4", "log_firing_rate": 3.1668266852320066, "Firing rate": 1468.3401872485758, "firing_rate": 1468.3401872485758, "i_spike": 59.0, "isi": 0.05942748790035042}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "neuron": "5", "log_firing_rate": 1.971869583257289, "Firing rate": 93.72805034050616, "firing_rate": 93.72805034050616, "i_spike": 66.0, "isi": 0.05254892158472448}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "neuron": "5", "log_firing_rate": 1.9899311498545278, "Firing rate": 97.70823085758096, "firing_rate": 97.70823085758096, "i_spike": 68.5, "isi": 0.050690184077282666}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "neuron": "6", "log_firing_rate": 1.962244917785584, "Firing rate": 91.67373329301628, "firing_rate": 91.67373329301628, "i_spike": 61.5, "isi": 0.057112679326457236}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "neuron": "6", "log_firing_rate": 2.543936332959464, "Firing rate": 349.8938692545325, "firing_rate": 349.8938692545325, "i_spike": 65.5, "isi": 0.052605231977249735}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "neuron": "7", "log_firing_rate": 2.556646395604115, "Firing rate": 360.28517785867393, "firing_rate": 360.28517785867393, "i_spike": 71.5, "isi": 0.048928820001547454}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "neuron": "7", "log_firing_rate": 2.7006924280809823, "Firing rate": 501.986951166253, "firing_rate": 501.986951166253, "i_spike": 73.5, "isi": 0.04745902391969764}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "neuron": "0", "log_firing_rate": 1.8157482608211528, "Firing rate": 65.42568235885871, "firing_rate": 65.42568235885871, "i_spike": 43.0, "isi": 0.0820462056300113}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "neuron": "0", "log_firing_rate": 2.0686484914958863, "Firing rate": 117.12469999693175, "firing_rate": 117.12469999693175, "i_spike": 57.0, "isi": 0.0614427870010092}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "neuron": "1", "log_firing_rate": 2.052030434702376, "Firing rate": 112.72764512413218, "firing_rate": 112.72764512413218, "i_spike": 46.5, "isi": 0.07561260164371376}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "neuron": "1", "log_firing_rate": 1.888445959490549, "Firing rate": 77.34744271426439, "firing_rate": 77.34744271426439, "i_spike": 52.5, "isi": 0.06646449927131867}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "neuron": "2", "log_firing_rate": 2.005458197759584, "Firing rate": 101.26472735670671, "firing_rate": 101.26472735670671, "i_spike": 48.0, "isi": 0.07239270124823917}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "neuron": "2", "log_firing_rate": 1.8184814904540205, "Firing rate": 65.83873690043593, "firing_rate": 65.83873690043593, "i_spike": 53.5, "isi": 0.06541710927794345}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "neuron": "3", "log_firing_rate": 1.7989952424305082, "Firing rate": 62.949928683818015, "firing_rate": 62.949928683818015, "i_spike": 53.0, "isi": 0.06569288184252477}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "neuron": "3", "log_firing_rate": 2.4064787880974885, "Firing rate": 254.96395547261963, "firing_rate": 254.96395547261963, "i_spike": 55.5, "isi": 0.06087538374048833}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "neuron": "4", "log_firing_rate": 2.157219736409156, "Firing rate": 143.62159199144037, "firing_rate": 143.62159199144037, "i_spike": 66.5, "isi": 0.05211215524610607}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "neuron": "4", "log_firing_rate": 1.9485930327896461, "Firing rate": 88.83682585567857, "firing_rate": 88.83682585567857, "i_spike": 53.0, "isi": 0.06617781313813742}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "neuron": "5", "log_firing_rate": 2.157721525173758, "Firing rate": 143.78762990851953, "firing_rate": 143.78762990851953, "i_spike": 63.5, "isi": 0.05507801948866226}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "neuron": "5", "log_firing_rate": 2.0845069606438726, "Firing rate": 121.48060905892208, "firing_rate": 121.48060905892208, "i_spike": 62.5, "isi": 0.05598821600567689}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "neuron": "6", "log_firing_rate": 2.155530565937196, "Firing rate": 143.06406667274257, "firing_rate": 143.06406667274257, "i_spike": 60.0, "isi": 0.05860746081802394}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "neuron": "6", "log_firing_rate": 1.9273583892304664, "Firing rate": 84.59766754982638, "firing_rate": 84.59766754982638, "i_spike": 74.0, "isi": 0.046919244329507635}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "neuron": "7", "log_firing_rate": 2.058769190225085, "Firing rate": 114.49043098604926, "firing_rate": 114.49043098604926, "i_spike": 81.5, "isi": 0.04220296233513159}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "neuron": "7", "log_firing_rate": 1.8819189062255404, "Firing rate": 76.1936723865919, "firing_rate": 76.1936723865919, "i_spike": 58.0, "isi": 0.06017640726049235}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "neuron": "0", "log_firing_rate": 1.7260877625179443, "Firing rate": 53.2215798923444, "firing_rate": 53.2215798923444, "i_spike": 37.5, "isi": 0.09116903148321397}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "neuron": "0", "log_firing_rate": 2.0360258835620932, "Firing rate": 108.64903755406046, "firing_rate": 108.64903755406046, "i_spike": 48.0, "isi": 0.07259604355381076}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "neuron": "1", "log_firing_rate": 1.8469371744524645, "Firing rate": 70.2970619976188, "firing_rate": 70.2970619976188, "i_spike": 40.0, "isi": 0.08362748223310025}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "neuron": "1", "log_firing_rate": 2.151491088546796, "Firing rate": 141.73956270659167, "firing_rate": 141.73956270659167, "i_spike": 42.5, "isi": 0.08176011747048276}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "neuron": "2", "log_firing_rate": 2.3761003147325033, "Firing rate": 237.73893602293487, "firing_rate": 237.73893602293487, "i_spike": 54.0, "isi": 0.06432226395484242}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "neuron": "2", "log_firing_rate": 1.6090125224977256, "Firing rate": 40.645504876851454, "firing_rate": 40.645504876851454, "i_spike": 34.5, "isi": 0.10246748384993126}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "neuron": "3", "log_firing_rate": 2.019692452083581, "Firing rate": 104.63872809716156, "firing_rate": 104.63872809716156, "i_spike": 59.0, "isi": 0.058339631155058795}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "neuron": "3", "log_firing_rate": 1.8642502172578344, "Firing rate": 73.15604481000024, "firing_rate": 73.15604481000024, "i_spike": 49.5, "isi": 0.07000287566199523}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.9842317522535966, "Firing rate": 96.43434882706228, "firing_rate": 96.43434882706228, "i_spike": 61.5, "isi": 0.05584934693586277}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.8831112012925575, "Firing rate": 76.4031389106439, "firing_rate": 76.4031389106439, "i_spike": 48.5, "isi": 0.072539364104599}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "neuron": "5", "log_firing_rate": 2.04058385947147, "Firing rate": 109.7953277523224, "firing_rate": 109.7953277523224, "i_spike": 66.0, "isi": 0.052291309837891015}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "neuron": "5", "log_firing_rate": 1.9307949942198694, "Firing rate": 85.26975088953641, "firing_rate": 85.26975088953641, "i_spike": 69.5, "isi": 0.05051942083926969}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "neuron": "6", "log_firing_rate": 1.8213943985376837, "Firing rate": 66.28181596281642, "firing_rate": 66.28181596281642, "i_spike": 69.0, "isi": 0.050243663071001955}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "neuron": "6", "log_firing_rate": 1.9492466456708883, "Firing rate": 88.97062587356683, "firing_rate": 88.97062587356683, "i_spike": 68.5, "isi": 0.05013431375044336}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.9764463717891647, "Firing rate": 94.72102124322306, "firing_rate": 94.72102124322306, "i_spike": 77.5, "isi": 0.04492004111128577}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.8982779616134384, "Firing rate": 79.1184848234488, "firing_rate": 79.1184848234488, "i_spike": 73.5, "isi": 0.04737927861000665}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "neuron": "0", "log_firing_rate": 3.0597699512948493, "Firing rate": 1147.5455978602884, "firing_rate": 1147.5455978602884, "i_spike": 50.5, "isi": 0.06940620036095985}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "neuron": "0", "log_firing_rate": 1.7187954318987329, "Firing rate": 52.335386029064445, "firing_rate": 52.335386029064445, "i_spike": 49.0, "isi": 0.06921138453054503}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "neuron": "1", "log_firing_rate": 2.267728837078611, "Firing rate": 185.2374684528774, "firing_rate": 185.2374684528774, "i_spike": 60.0, "isi": 0.05706158394260935}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "neuron": "1", "log_firing_rate": 2.7221202897293386, "Firing rate": 527.3759123716188, "firing_rate": 527.3759123716188, "i_spike": 45.0, "isi": 0.07413699818988925}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "neuron": "2", "log_firing_rate": 2.1465400002906048, "Firing rate": 140.1328647072155, "firing_rate": 140.1328647072155, "i_spike": 56.5, "isi": 0.06152497968380627}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "neuron": "2", "log_firing_rate": 1.8187454558383904, "Firing rate": 65.87876603005617, "firing_rate": 65.87876603005617, "i_spike": 53.0, "isi": 0.06480910507141709}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "neuron": "3", "log_firing_rate": 1.750544558252304, "Firing rate": 56.30468825722925, "firing_rate": 56.30468825722925, "i_spike": 61.5, "isi": 0.05682537420824388}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "neuron": "3", "log_firing_rate": 1.781308649088516, "Firing rate": 60.4378002662769, "firing_rate": 60.4378002662769, "i_spike": 75.5, "isi": 0.04615873598321334}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "neuron": "4", "log_firing_rate": 1.8554697503351503, "Firing rate": 71.69184387318583, "firing_rate": 71.69184387318583, "i_spike": 60.5, "isi": 0.05537329454482614}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "neuron": "4", "log_firing_rate": 1.9572951472449862, "Firing rate": 90.63483474725928, "firing_rate": 90.63483474725928, "i_spike": 59.0, "isi": 0.057971604321028096}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "neuron": "5", "log_firing_rate": 2.256833829639822, "Firing rate": 180.64827947946827, "firing_rate": 180.64827947946827, "i_spike": 76.5, "isi": 0.044918286699734335}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "neuron": "5", "log_firing_rate": 2.363987762896306, "Firing rate": 231.1999644107287, "firing_rate": 231.1999644107287, "i_spike": 63.0, "isi": 0.05473408679995211}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "neuron": "6", "log_firing_rate": 1.8074839380700038, "Firing rate": 64.19244801593484, "firing_rate": 64.19244801593484, "i_spike": 56.0, "isi": 0.06241532763121318}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "neuron": "6", "log_firing_rate": 2.0877278242221977, "Firing rate": 122.38489630740098, "firing_rate": 122.38489630740098, "i_spike": 64.0, "isi": 0.05461452383663155}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "neuron": "7", "log_firing_rate": 2.1637843384895654, "Firing rate": 145.80900236145777, "firing_rate": 145.80900236145777, "i_spike": 79.5, "isi": 0.04388456694526845}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "neuron": "7", "log_firing_rate": 1.8715681643498534, "Firing rate": 74.39918263977742, "firing_rate": 74.39918263977742, "i_spike": 61.0, "isi": 0.055736744873155365}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.9910246618254734, "Firing rate": 97.95456082589853, "firing_rate": 97.95456082589853, "i_spike": 53.5, "isi": 0.06568851226535011}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.871631935950813, "Firing rate": 74.41010818349469, "firing_rate": 74.41010818349469, "i_spike": 54.5, "isi": 0.06427359914900996}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "neuron": "1", "log_firing_rate": 2.1708605495722813, "Firing rate": 148.2042130230905, "firing_rate": 148.2042130230905, "i_spike": 41.0, "isi": 0.08168326138273442}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "neuron": "1", "log_firing_rate": 1.9190778160718585, "Firing rate": 82.99994719425747, "firing_rate": 82.99994719425747, "i_spike": 55.5, "isi": 0.06228480104219513}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "neuron": "2", "log_firing_rate": 2.0820304090274253, "Firing rate": 120.7898408435358, "firing_rate": 120.7898408435358, "i_spike": 60.5, "isi": 0.057254067032338485}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "neuron": "2", "log_firing_rate": 1.7485007583259302, "Firing rate": 56.0403395889294, "firing_rate": 56.0403395889294, "i_spike": 37.5, "isi": 0.09400719712259409}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "neuron": "3", "log_firing_rate": 1.84651993285477, "Firing rate": 70.22955763223278, "firing_rate": 70.22955763223278, "i_spike": 50.0, "isi": 0.07028932338617956}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "neuron": "3", "log_firing_rate": 3.151072877211593, "Firing rate": 1416.0313785559429, "firing_rate": 1416.0313785559429, "i_spike": 73.0, "isi": 0.047626935736819635}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "neuron": "4", "log_firing_rate": 2.129312522880888, "Firing rate": 134.68291978875666, "firing_rate": 134.68291978875666, "i_spike": 68.5, "isi": 0.05051981834806181}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "neuron": "4", "log_firing_rate": 2.0086504867474653, "Firing rate": 102.0118178472014, "firing_rate": 102.0118178472014, "i_spike": 71.5, "isi": 0.04801097993886758}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "neuron": "5", "log_firing_rate": 1.9265820224573607, "Firing rate": 84.44657157582667, "firing_rate": 84.44657157582667, "i_spike": 67.5, "isi": 0.050529316338654345}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "neuron": "5", "log_firing_rate": 2.0477025898343255, "Firing rate": 111.60986680137891, "firing_rate": 111.60986680137891, "i_spike": 73.5, "isi": 0.04770652350559278}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "neuron": "6", "log_firing_rate": 1.9989257837574768, "Firing rate": 99.75295822102956, "firing_rate": 99.75295822102956, "i_spike": 64.5, "isi": 0.05451380323883546}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "neuron": "6", "log_firing_rate": 2.022997943099717, "Firing rate": 105.43819026285938, "firing_rate": 105.43819026285938, "i_spike": 69.5, "isi": 0.05016292788760342}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "neuron": "7", "log_firing_rate": 2.420117725372556, "Firing rate": 263.0981082355189, "firing_rate": 263.0981082355189, "i_spike": 80.5, "isi": 0.04322027044612176}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "neuron": "7", "log_firing_rate": 1.9314909157498026, "Firing rate": 85.4064982533188, "firing_rate": 85.4064982533188, "i_spike": 73.0, "isi": 0.04773454345547097}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>

<span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-value</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>


<span class="c1"># Transparent selectors across the chart. This is what tells us</span>
<span class="c1"># the x-value of the cursor</span>
<span class="n">selectors</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="c1">#tooltip=color,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">text</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-5fe7623af6f44552ae1a4e9dc8d78d1c"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-5fe7623af6f44552ae1a4e9dc8d78d1c") {
      outputDiv = document.getElementById("altair-viz-5fe7623af6f44552ae1a4e9dc8d78d1c");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04519778488110683, 0.0906936690568172], "zero": false}}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}}, "selection": {"selector002": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["neuron"], "empty": "none"}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04519778488110683, 0.0906936690568172], "zero": false}}}, "selection": {"selector003": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "text": {"condition": {"type": "quantitative", "field": "isi", "selection": "selector002"}, "value": " "}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04519778488110683, 0.0906936690568172], "zero": false}}}}], "data": {"name": "data-3ba3f59f2fc89b817c4c9e41752b2a18"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-3ba3f59f2fc89b817c4c9e41752b2a18": [{"stim": 0, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "neuron": "0", "log_firing_rate": 1.4823317424776943, "Firing rate": 30.3620955369312, "firing_rate": 30.3620955369312, "i_spike": 31.0, "isi": 0.11391531426344723}, {"stim": 0, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "neuron": "0", "log_firing_rate": 1.9053599858476944, "Firing rate": 80.41924395351046, "firing_rate": 80.41924395351046, "i_spike": 41.0, "isi": 0.08564449352619705}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "neuron": "1", "log_firing_rate": 1.5347866161337962, "Firing rate": 34.25994142711491, "firing_rate": 34.25994142711491, "i_spike": 35.5, "isi": 0.09876929102598327}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "neuron": "1", "log_firing_rate": 1.931927010005301, "Firing rate": 85.49230175969583, "firing_rate": 85.49230175969583, "i_spike": 43.5, "isi": 0.07951405583879766}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "neuron": "2", "log_firing_rate": 1.9637049724985198, "Firing rate": 91.98244988328057, "firing_rate": 91.98244988328057, "i_spike": 44.5, "isi": 0.0786894371144926}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "neuron": "2", "log_firing_rate": 2.1726406756275276, "Firing rate": 148.81293273032165, "firing_rate": 148.81293273032165, "i_spike": 57.0, "isi": 0.06061765839988263}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "neuron": "3", "log_firing_rate": 1.8697345602859143, "Firing rate": 74.08572927480215, "firing_rate": 74.08572927480215, "i_spike": 55.0, "isi": 0.06308793011716636}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "neuron": "3", "log_firing_rate": 2.309429278139167, "Firing rate": 203.90565862707345, "firing_rate": 203.90565862707345, "i_spike": 53.5, "isi": 0.06383527230970894}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "neuron": "4", "log_firing_rate": 1.983561126526814, "Firing rate": 96.28555244170859, "firing_rate": 96.28555244170859, "i_spike": 63.0, "isi": 0.05293131331875113}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "neuron": "4", "log_firing_rate": 2.2016876229839437, "Firing rate": 159.10639034301386, "firing_rate": 159.10639034301386, "i_spike": 60.5, "isi": 0.05786932098862121}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "neuron": "5", "log_firing_rate": 1.7935199493911673, "Firing rate": 62.16128009868512, "firing_rate": 62.16128009868512, "i_spike": 55.0, "isi": 0.06381429644474441}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "neuron": "5", "log_firing_rate": 2.1392160547878367, "Firing rate": 137.7894779756089, "firing_rate": 137.7894779756089, "i_spike": 67.0, "isi": 0.05244195010573857}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "neuron": "6", "log_firing_rate": 2.0023106465379197, "Firing rate": 100.53346390568842, "firing_rate": 100.53346390568842, "i_spike": 76.0, "isi": 0.045713594739345935}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "neuron": "6", "log_firing_rate": 1.931772670141282, "Firing rate": 85.46192484620785, "firing_rate": 85.46192484620785, "i_spike": 58.0, "isi": 0.059966278112984744}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "neuron": "7", "log_firing_rate": 1.8706429054289384, "Firing rate": 74.24084484693493, "firing_rate": 74.24084484693493, "i_spike": 70.5, "isi": 0.04786867724301966}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "neuron": "7", "log_firing_rate": 1.9251002131539279, "Firing rate": 84.15893153991013, "firing_rate": 84.15893153991013, "i_spike": 62.0, "isi": 0.05669230167600466}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "neuron": "0", "log_firing_rate": 1.5963997051779304, "Firing rate": 39.48205100127425, "firing_rate": 39.48205100127425, "i_spike": 46.5, "isi": 0.07544081391415867}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "neuron": "0", "log_firing_rate": 2.022931289796446, "Firing rate": 105.42200938859865, "firing_rate": 105.42200938859865, "i_spike": 43.5, "isi": 0.07928190519695166}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "neuron": "1", "log_firing_rate": 1.8847620122199715, "Firing rate": 76.69411003478032, "firing_rate": 76.69411003478032, "i_spike": 42.5, "isi": 0.0805221466849667}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "neuron": "1", "log_firing_rate": 1.6870690559160828, "Firing rate": 48.64845540511306, "firing_rate": 48.64845540511306, "i_spike": 49.0, "isi": 0.07119213900726805}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "neuron": "2", "log_firing_rate": 1.8042814957889326, "Firing rate": 63.72084051865186, "firing_rate": 63.72084051865186, "i_spike": 53.5, "isi": 0.06486078462562267}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "neuron": "2", "log_firing_rate": 1.812738739577918, "Firing rate": 64.97387066097617, "firing_rate": 64.97387066097617, "i_spike": 45.0, "isi": 0.07751264004859136}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "neuron": "3", "log_firing_rate": 1.7932113483134788, "Firing rate": 62.117125210934645, "firing_rate": 62.117125210934645, "i_spike": 57.5, "isi": 0.06025107059853679}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "neuron": "3", "log_firing_rate": 2.1560879909583157, "Firing rate": 143.24780994903625, "firing_rate": 143.24780994903625, "i_spike": 47.0, "isi": 0.07294401903311896}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.9478247986519952, "Firing rate": 88.679819127756, "firing_rate": 88.679819127756, "i_spike": 44.5, "isi": 0.07899076533196152}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.924157793434988, "Firing rate": 83.9765045291744, "firing_rate": 83.9765045291744, "i_spike": 58.5, "isi": 0.05836092870299298}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "neuron": "5", "log_firing_rate": 2.861262290866386, "Firing rate": 726.5446194290978, "firing_rate": 726.5446194290978, "i_spike": 60.5, "isi": 0.05789903793933455}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "neuron": "5", "log_firing_rate": 1.8487649597017897, "Firing rate": 70.59353984206975, "firing_rate": 70.59353984206975, "i_spike": 59.5, "isi": 0.05868423330107067}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "neuron": "6", "log_firing_rate": 2.041974857150948, "Firing rate": 110.14755393669158, "firing_rate": 110.14755393669158, "i_spike": 66.5, "isi": 0.05204810322034346}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "neuron": "6", "log_firing_rate": 2.7091944511883925, "Firing rate": 511.9109874704302, "firing_rate": 511.9109874704302, "i_spike": 60.0, "isi": 0.05833167857133595}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.9923758766699924, "Firing rate": 98.25980019053365, "firing_rate": 98.25980019053365, "i_spike": 77.0, "isi": 0.04446589229128702}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.9848078530698992, "Firing rate": 96.56235591381318, "firing_rate": 96.56235591381318, "i_spike": 58.0, "isi": 0.05424408303495761}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "neuron": "0", "log_firing_rate": 1.7549399772313259, "Firing rate": 56.87743165166483, "firing_rate": 56.87743165166483, "i_spike": 47.5, "isi": 0.07384261951928615}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "neuron": "0", "log_firing_rate": 1.8886497835791791, "Firing rate": 77.38375211434187, "firing_rate": 77.38375211434187, "i_spike": 38.5, "isi": 0.08981085312208036}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "neuron": "1", "log_firing_rate": 1.8307854908280923, "Firing rate": 67.73068857538004, "firing_rate": 67.73068857538004, "i_spike": 50.5, "isi": 0.06855270197512729}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "neuron": "1", "log_firing_rate": 1.7033585216589386, "Firing rate": 50.507808091168535, "firing_rate": 50.507808091168535, "i_spike": 37.5, "isi": 0.0918919978578989}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "neuron": "2", "log_firing_rate": 1.659050313572892, "Firing rate": 45.60897514735388, "firing_rate": 45.60897514735388, "i_spike": 37.0, "isi": 0.09352384428152762}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "neuron": "2", "log_firing_rate": 1.7217985206149538, "Firing rate": 52.69853238656132, "firing_rate": 52.69853238656132, "i_spike": 46.0, "isi": 0.07427842999245243}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "neuron": "3", "log_firing_rate": 2.1853531939344584, "Firing rate": 153.23331389359254, "firing_rate": 153.23331389359254, "i_spike": 53.0, "isi": 0.06315218364811459}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "neuron": "3", "log_firing_rate": 2.1751011659674813, "Firing rate": 149.65842346868348, "firing_rate": 149.65842346868348, "i_spike": 59.5, "isi": 0.0582094323739187}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "neuron": "4", "log_firing_rate": 1.7060634238375918, "Firing rate": 50.82336589662166, "firing_rate": 50.82336589662166, "i_spike": 48.0, "isi": 0.07251369061675603}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "neuron": "4", "log_firing_rate": 2.6135669467981613, "Firing rate": 410.7399508457043, "firing_rate": 410.7399508457043, "i_spike": 62.0, "isi": 0.05516325491725799}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "neuron": "5", "log_firing_rate": 3.0691272937097653, "Firing rate": 1172.5389917569075, "firing_rate": 1172.5389917569075, "i_spike": 64.5, "isi": 0.05345086578862158}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "neuron": "5", "log_firing_rate": 1.7176847350769948, "Firing rate": 52.20171065142432, "firing_rate": 52.20171065142432, "i_spike": 49.5, "isi": 0.07008222173096817}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "neuron": "6", "log_firing_rate": 2.5183521085267144, "Firing rate": 329.8770548572346, "firing_rate": 329.8770548572346, "i_spike": 60.0, "isi": 0.05757694442790462}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "neuron": "6", "log_firing_rate": 1.8939724903973418, "Firing rate": 78.3380019396553, "firing_rate": 78.3380019396553, "i_spike": 68.0, "isi": 0.05081750969708566}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "neuron": "7", "log_firing_rate": 2.0786055738039177, "Firing rate": 119.84104125669292, "firing_rate": 119.84104125669292, "i_spike": 69.0, "isi": 0.0500787356983985}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "neuron": "7", "log_firing_rate": 2.1578811978986114, "Firing rate": 143.8405045930675, "firing_rate": 143.8405045930675, "i_spike": 80.5, "isi": 0.04338727081483027}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.6495160227810624, "Firing rate": 44.618608578502176, "firing_rate": 44.618608578502176, "i_spike": 39.5, "isi": 0.08690581451575252}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.5695589998224289, "Firing rate": 37.115814868631325, "firing_rate": 37.115814868631325, "i_spike": 43.5, "isi": 0.07934652022518383}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "neuron": "1", "log_firing_rate": 2.041470871921473, "Firing rate": 110.01980526704189, "firing_rate": 110.01980526704189, "i_spike": 39.0, "isi": 0.08786302151316318}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "neuron": "1", "log_firing_rate": 2.598221822860374, "Firing rate": 396.4804913061626, "firing_rate": 396.4804913061626, "i_spike": 44.5, "isi": 0.07825404149274197}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "neuron": "2", "log_firing_rate": 1.7893723311682102, "Firing rate": 61.57045048722248, "firing_rate": 61.57045048722248, "i_spike": 51.0, "isi": 0.06711996849774152}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "neuron": "2", "log_firing_rate": 1.8028200206363394, "Firing rate": 63.50676939538161, "firing_rate": 63.50676939538161, "i_spike": 48.0, "isi": 0.07271103788042554}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "neuron": "3", "log_firing_rate": 2.106342800006212, "Firing rate": 127.74467331238401, "firing_rate": 127.74467331238401, "i_spike": 49.0, "isi": 0.0700079139710958}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "neuron": "3", "log_firing_rate": 1.6706697147616425, "Firing rate": 46.84569804833687, "firing_rate": 46.84569804833687, "i_spike": 40.0, "isi": 0.08761506017802866}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "neuron": "4", "log_firing_rate": 2.7102678550724413, "Firing rate": 513.1777934795683, "firing_rate": 513.1777934795683, "i_spike": 47.5, "isi": 0.07347941678267618}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "neuron": "4", "log_firing_rate": 3.1668266852320066, "Firing rate": 1468.3401872485758, "firing_rate": 1468.3401872485758, "i_spike": 59.0, "isi": 0.05942748790035042}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "neuron": "5", "log_firing_rate": 1.971869583257289, "Firing rate": 93.72805034050616, "firing_rate": 93.72805034050616, "i_spike": 66.0, "isi": 0.05254892158472448}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "neuron": "5", "log_firing_rate": 1.9899311498545278, "Firing rate": 97.70823085758096, "firing_rate": 97.70823085758096, "i_spike": 68.5, "isi": 0.050690184077282666}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "neuron": "6", "log_firing_rate": 1.962244917785584, "Firing rate": 91.67373329301628, "firing_rate": 91.67373329301628, "i_spike": 61.5, "isi": 0.057112679326457236}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "neuron": "6", "log_firing_rate": 2.543936332959464, "Firing rate": 349.8938692545325, "firing_rate": 349.8938692545325, "i_spike": 65.5, "isi": 0.052605231977249735}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "neuron": "7", "log_firing_rate": 2.556646395604115, "Firing rate": 360.28517785867393, "firing_rate": 360.28517785867393, "i_spike": 71.5, "isi": 0.048928820001547454}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "neuron": "7", "log_firing_rate": 2.7006924280809823, "Firing rate": 501.986951166253, "firing_rate": 501.986951166253, "i_spike": 73.5, "isi": 0.04745902391969764}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 0, "neuron": "0", "log_firing_rate": 1.8157482608211528, "Firing rate": 65.42568235885871, "firing_rate": 65.42568235885871, "i_spike": 43.0, "isi": 0.0820462056300113}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 0, "neuron": "0", "log_firing_rate": 2.0686484914958863, "Firing rate": 117.12469999693175, "firing_rate": 117.12469999693175, "i_spike": 57.0, "isi": 0.0614427870010092}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 1, "neuron": "1", "log_firing_rate": 2.052030434702376, "Firing rate": 112.72764512413218, "firing_rate": 112.72764512413218, "i_spike": 46.5, "isi": 0.07561260164371376}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 1, "neuron": "1", "log_firing_rate": 1.888445959490549, "Firing rate": 77.34744271426439, "firing_rate": 77.34744271426439, "i_spike": 52.5, "isi": 0.06646449927131867}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 2, "neuron": "2", "log_firing_rate": 2.005458197759584, "Firing rate": 101.26472735670671, "firing_rate": 101.26472735670671, "i_spike": 48.0, "isi": 0.07239270124823917}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 2, "neuron": "2", "log_firing_rate": 1.8184814904540205, "Firing rate": 65.83873690043593, "firing_rate": 65.83873690043593, "i_spike": 53.5, "isi": 0.06541710927794345}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 3, "neuron": "3", "log_firing_rate": 1.7989952424305082, "Firing rate": 62.949928683818015, "firing_rate": 62.949928683818015, "i_spike": 53.0, "isi": 0.06569288184252477}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 3, "neuron": "3", "log_firing_rate": 2.4064787880974885, "Firing rate": 254.96395547261963, "firing_rate": 254.96395547261963, "i_spike": 55.5, "isi": 0.06087538374048833}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 4, "neuron": "4", "log_firing_rate": 2.157219736409156, "Firing rate": 143.62159199144037, "firing_rate": 143.62159199144037, "i_spike": 66.5, "isi": 0.05211215524610607}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 4, "neuron": "4", "log_firing_rate": 1.9485930327896461, "Firing rate": 88.83682585567857, "firing_rate": 88.83682585567857, "i_spike": 53.0, "isi": 0.06617781313813742}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 5, "neuron": "5", "log_firing_rate": 2.157721525173758, "Firing rate": 143.78762990851953, "firing_rate": 143.78762990851953, "i_spike": 63.5, "isi": 0.05507801948866226}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 5, "neuron": "5", "log_firing_rate": 2.0845069606438726, "Firing rate": 121.48060905892208, "firing_rate": 121.48060905892208, "i_spike": 62.5, "isi": 0.05598821600567689}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 6, "neuron": "6", "log_firing_rate": 2.155530565937196, "Firing rate": 143.06406667274257, "firing_rate": 143.06406667274257, "i_spike": 60.0, "isi": 0.05860746081802394}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 6, "neuron": "6", "log_firing_rate": 1.9273583892304664, "Firing rate": 84.59766754982638, "firing_rate": 84.59766754982638, "i_spike": 74.0, "isi": 0.046919244329507635}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 0, "neuron_code": 7, "neuron": "7", "log_firing_rate": 2.058769190225085, "Firing rate": 114.49043098604926, "firing_rate": 114.49043098604926, "i_spike": 81.5, "isi": 0.04220296233513159}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "mouse_code": 0, "i_trial": 1, "neuron_code": 7, "neuron": "7", "log_firing_rate": 1.8819189062255404, "Firing rate": 76.1936723865919, "firing_rate": 76.1936723865919, "i_spike": 58.0, "isi": 0.06017640726049235}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 8, "neuron": "0", "log_firing_rate": 1.7260877625179443, "Firing rate": 53.2215798923444, "firing_rate": 53.2215798923444, "i_spike": 37.5, "isi": 0.09116903148321397}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 8, "neuron": "0", "log_firing_rate": 2.0360258835620932, "Firing rate": 108.64903755406046, "firing_rate": 108.64903755406046, "i_spike": 48.0, "isi": 0.07259604355381076}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 9, "neuron": "1", "log_firing_rate": 1.8469371744524645, "Firing rate": 70.2970619976188, "firing_rate": 70.2970619976188, "i_spike": 40.0, "isi": 0.08362748223310025}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 9, "neuron": "1", "log_firing_rate": 2.151491088546796, "Firing rate": 141.73956270659167, "firing_rate": 141.73956270659167, "i_spike": 42.5, "isi": 0.08176011747048276}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 10, "neuron": "2", "log_firing_rate": 2.3761003147325033, "Firing rate": 237.73893602293487, "firing_rate": 237.73893602293487, "i_spike": 54.0, "isi": 0.06432226395484242}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 10, "neuron": "2", "log_firing_rate": 1.6090125224977256, "Firing rate": 40.645504876851454, "firing_rate": 40.645504876851454, "i_spike": 34.5, "isi": 0.10246748384993126}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 11, "neuron": "3", "log_firing_rate": 2.019692452083581, "Firing rate": 104.63872809716156, "firing_rate": 104.63872809716156, "i_spike": 59.0, "isi": 0.058339631155058795}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 11, "neuron": "3", "log_firing_rate": 1.8642502172578344, "Firing rate": 73.15604481000024, "firing_rate": 73.15604481000024, "i_spike": 49.5, "isi": 0.07000287566199523}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.9842317522535966, "Firing rate": 96.43434882706228, "firing_rate": 96.43434882706228, "i_spike": 61.5, "isi": 0.05584934693586277}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 12, "neuron": "4", "log_firing_rate": 1.8831112012925575, "Firing rate": 76.4031389106439, "firing_rate": 76.4031389106439, "i_spike": 48.5, "isi": 0.072539364104599}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 13, "neuron": "5", "log_firing_rate": 2.04058385947147, "Firing rate": 109.7953277523224, "firing_rate": 109.7953277523224, "i_spike": 66.0, "isi": 0.052291309837891015}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 13, "neuron": "5", "log_firing_rate": 1.9307949942198694, "Firing rate": 85.26975088953641, "firing_rate": 85.26975088953641, "i_spike": 69.5, "isi": 0.05051942083926969}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 14, "neuron": "6", "log_firing_rate": 1.8213943985376837, "Firing rate": 66.28181596281642, "firing_rate": 66.28181596281642, "i_spike": 69.0, "isi": 0.050243663071001955}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 14, "neuron": "6", "log_firing_rate": 1.9492466456708883, "Firing rate": 88.97062587356683, "firing_rate": 88.97062587356683, "i_spike": 68.5, "isi": 0.05013431375044336}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 0, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.9764463717891647, "Firing rate": 94.72102124322306, "firing_rate": 94.72102124322306, "i_spike": 77.5, "isi": 0.04492004111128577}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "mouse_code": 1, "i_trial": 1, "neuron_code": 15, "neuron": "7", "log_firing_rate": 1.8982779616134384, "Firing rate": 79.1184848234488, "firing_rate": 79.1184848234488, "i_spike": 73.5, "isi": 0.04737927861000665}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 16, "neuron": "0", "log_firing_rate": 3.0597699512948493, "Firing rate": 1147.5455978602884, "firing_rate": 1147.5455978602884, "i_spike": 50.5, "isi": 0.06940620036095985}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 16, "neuron": "0", "log_firing_rate": 1.7187954318987329, "Firing rate": 52.335386029064445, "firing_rate": 52.335386029064445, "i_spike": 49.0, "isi": 0.06921138453054503}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 17, "neuron": "1", "log_firing_rate": 2.267728837078611, "Firing rate": 185.2374684528774, "firing_rate": 185.2374684528774, "i_spike": 60.0, "isi": 0.05706158394260935}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 17, "neuron": "1", "log_firing_rate": 2.7221202897293386, "Firing rate": 527.3759123716188, "firing_rate": 527.3759123716188, "i_spike": 45.0, "isi": 0.07413699818988925}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 18, "neuron": "2", "log_firing_rate": 2.1465400002906048, "Firing rate": 140.1328647072155, "firing_rate": 140.1328647072155, "i_spike": 56.5, "isi": 0.06152497968380627}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 18, "neuron": "2", "log_firing_rate": 1.8187454558383904, "Firing rate": 65.87876603005617, "firing_rate": 65.87876603005617, "i_spike": 53.0, "isi": 0.06480910507141709}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 19, "neuron": "3", "log_firing_rate": 1.750544558252304, "Firing rate": 56.30468825722925, "firing_rate": 56.30468825722925, "i_spike": 61.5, "isi": 0.05682537420824388}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 19, "neuron": "3", "log_firing_rate": 1.781308649088516, "Firing rate": 60.4378002662769, "firing_rate": 60.4378002662769, "i_spike": 75.5, "isi": 0.04615873598321334}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 20, "neuron": "4", "log_firing_rate": 1.8554697503351503, "Firing rate": 71.69184387318583, "firing_rate": 71.69184387318583, "i_spike": 60.5, "isi": 0.05537329454482614}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 20, "neuron": "4", "log_firing_rate": 1.9572951472449862, "Firing rate": 90.63483474725928, "firing_rate": 90.63483474725928, "i_spike": 59.0, "isi": 0.057971604321028096}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 21, "neuron": "5", "log_firing_rate": 2.256833829639822, "Firing rate": 180.64827947946827, "firing_rate": 180.64827947946827, "i_spike": 76.5, "isi": 0.044918286699734335}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 21, "neuron": "5", "log_firing_rate": 2.363987762896306, "Firing rate": 231.1999644107287, "firing_rate": 231.1999644107287, "i_spike": 63.0, "isi": 0.05473408679995211}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 22, "neuron": "6", "log_firing_rate": 1.8074839380700038, "Firing rate": 64.19244801593484, "firing_rate": 64.19244801593484, "i_spike": 56.0, "isi": 0.06241532763121318}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 22, "neuron": "6", "log_firing_rate": 2.0877278242221977, "Firing rate": 122.38489630740098, "firing_rate": 122.38489630740098, "i_spike": 64.0, "isi": 0.05461452383663155}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 0, "neuron_code": 23, "neuron": "7", "log_firing_rate": 2.1637843384895654, "Firing rate": 145.80900236145777, "firing_rate": 145.80900236145777, "i_spike": 79.5, "isi": 0.04388456694526845}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "mouse_code": 2, "i_trial": 1, "neuron_code": 23, "neuron": "7", "log_firing_rate": 1.8715681643498534, "Firing rate": 74.39918263977742, "firing_rate": 74.39918263977742, "i_spike": 61.0, "isi": 0.055736744873155365}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.9910246618254734, "Firing rate": 97.95456082589853, "firing_rate": 97.95456082589853, "i_spike": 53.5, "isi": 0.06568851226535011}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 24, "neuron": "0", "log_firing_rate": 1.871631935950813, "Firing rate": 74.41010818349469, "firing_rate": 74.41010818349469, "i_spike": 54.5, "isi": 0.06427359914900996}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 25, "neuron": "1", "log_firing_rate": 2.1708605495722813, "Firing rate": 148.2042130230905, "firing_rate": 148.2042130230905, "i_spike": 41.0, "isi": 0.08168326138273442}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 25, "neuron": "1", "log_firing_rate": 1.9190778160718585, "Firing rate": 82.99994719425747, "firing_rate": 82.99994719425747, "i_spike": 55.5, "isi": 0.06228480104219513}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 26, "neuron": "2", "log_firing_rate": 2.0820304090274253, "Firing rate": 120.7898408435358, "firing_rate": 120.7898408435358, "i_spike": 60.5, "isi": 0.057254067032338485}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 26, "neuron": "2", "log_firing_rate": 1.7485007583259302, "Firing rate": 56.0403395889294, "firing_rate": 56.0403395889294, "i_spike": 37.5, "isi": 0.09400719712259409}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 27, "neuron": "3", "log_firing_rate": 1.84651993285477, "Firing rate": 70.22955763223278, "firing_rate": 70.22955763223278, "i_spike": 50.0, "isi": 0.07028932338617956}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 27, "neuron": "3", "log_firing_rate": 3.151072877211593, "Firing rate": 1416.0313785559429, "firing_rate": 1416.0313785559429, "i_spike": 73.0, "isi": 0.047626935736819635}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 28, "neuron": "4", "log_firing_rate": 2.129312522880888, "Firing rate": 134.68291978875666, "firing_rate": 134.68291978875666, "i_spike": 68.5, "isi": 0.05051981834806181}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 28, "neuron": "4", "log_firing_rate": 2.0086504867474653, "Firing rate": 102.0118178472014, "firing_rate": 102.0118178472014, "i_spike": 71.5, "isi": 0.04801097993886758}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 29, "neuron": "5", "log_firing_rate": 1.9265820224573607, "Firing rate": 84.44657157582667, "firing_rate": 84.44657157582667, "i_spike": 67.5, "isi": 0.050529316338654345}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 29, "neuron": "5", "log_firing_rate": 2.0477025898343255, "Firing rate": 111.60986680137891, "firing_rate": 111.60986680137891, "i_spike": 73.5, "isi": 0.04770652350559278}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 30, "neuron": "6", "log_firing_rate": 1.9989257837574768, "Firing rate": 99.75295822102956, "firing_rate": 99.75295822102956, "i_spike": 64.5, "isi": 0.05451380323883546}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 30, "neuron": "6", "log_firing_rate": 2.022997943099717, "Firing rate": 105.43819026285938, "firing_rate": 105.43819026285938, "i_spike": 69.5, "isi": 0.05016292788760342}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 0, "neuron_code": 31, "neuron": "7", "log_firing_rate": 2.420117725372556, "Firing rate": 263.0981082355189, "firing_rate": 263.0981082355189, "i_spike": 80.5, "isi": 0.04322027044612176}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "mouse_code": 3, "i_trial": 1, "neuron_code": 31, "neuron": "7", "log_firing_rate": 1.9314909157498026, "Firing rate": 85.4064982533188, "firing_rate": 85.4064982533188, "i_spike": 73.0, "isi": 0.04773454345547097}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./neurons_example"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="model_comparison.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Compare to alternative models</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Max Myroshnychenko<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>