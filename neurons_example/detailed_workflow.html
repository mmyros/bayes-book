
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neurons example via low-level, flexible interface &#8212; Bayes Window examples</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Compare to alternative models" href="model_comparison.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bayes Window examples</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/metropolis.html">
   Intuition for maximal likelihood or posterior inference
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../radon_example/radon.html">
   Radon example from Gelman and Hill (2006)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_lfp.html">
   Multilevel modeling of LFP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_neurons.html">
   Bayesian Methods for Multilevel Modeling of Neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/quick_lfp.html">
   LFP example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_stim_strength.html">
   LFP example with stim strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_roc.html">
   Compare to ANOVA and LMM: ROC curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Neurons example, pt. 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="posteriors.html">
   Neurons example, no slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_strength.html">
   Neurons example with nominal stim strengths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_type.html">
   Neurons example with stim types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lme.html">
   Linear mixed effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monster.html">
   Neurons example, pt. 2: large datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_comparison.html">
   Compare to alternative models
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Neurons example via low-level, flexible interface
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mmyros/bayes-window"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mmyros/bayes-window/issues/new?title=Issue%20on%20page%20%2Fneurons_example/detailed_workflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mmyros/bayes-window/master?urlpath=tree/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare">
   Prepare
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-data">
   Make some data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimate-model">
   Estimate model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-data-back">
   Add data back
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-elements-of-interactivity-wip">
   Appendix: Elements of interactivity (WIP)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neurons-example-via-low-level-flexible-interface">
<h1>Neurons example via low-level, flexible interface<a class="headerlink" href="#neurons-example-via-low-level-flexible-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare">
<h2>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">bayes_window.fitting</span> <span class="kn">import</span> <span class="n">fit_numpyro</span>
<span class="kn">from</span> <span class="nn">bayes_window.generative_models</span> <span class="kn">import</span> <span class="n">generate_fake_spikes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/optimizers.py:30: FutureWarning: jax.experimental.optimizers is deprecated, import jax.example_libraries.optimizers instead
  FutureWarning)
/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/stax.py:30: FutureWarning: jax.experimental.stax is deprecated, import jax.example_libraries.stax instead
  FutureWarning)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-data">
<h2>Make some data<a class="headerlink" href="#make-some-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">df_monster</span><span class="p">,</span> <span class="n">index_cols</span><span class="p">,</span> <span class="n">firing_rates</span> <span class="o">=</span> <span class="n">generate_fake_spikes</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                                <span class="n">n_neurons</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                                                <span class="n">n_mice</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                <span class="n">dur</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="p">)</span>


<span class="c1"># df[&#39;log_isi&#39;] = np.log10(df[&#39;isi&#39;])</span>

<span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">visualization</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>

<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;isi&#39;</span>
<span class="n">ddf</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_fold_change</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                 <span class="n">index_cols</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">),</span>
                                 <span class="n">treatment_name</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span>
                                 <span class="n">do_take_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span>  <span class="n">df</span><span class="o">=</span><span class="n">ddf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-310d7accb70240c08b308d174cf9075a"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-310d7accb70240c08b308d174cf9075a") {
      outputDiv = document.getElementById("altair-viz-310d7accb70240c08b308d174cf9075a");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.8}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "size": {"value": 1.0}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right"}, "field": "isi diff", "scale": {"domain": [0.7827527548841393, 1.217204032925407], "zero": false}, "title": "isi diff"}}}, {"mark": {"type": "circle", "clip": true, "filled": true, "opacity": 0}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7827527548841393, 1.217204032925407], "zero": false}}}}, {"mark": {"type": "boxplot", "clip": true, "color": "black", "median": {"color": "red", "strokeWidth": 20}, "opacity": 0.3, "size": 9}, "encoding": {"x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7827527548841393, 1.217204032925407], "zero": false}}}}], "data": {"name": "data-11dcb457f13876aa8da2f92781563093"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-11dcb457f13876aa8da2f92781563093": [{"mouse": "m0bayes", "neuron": "0", "isi diff": 0.9787385378168959}, {"mouse": "m0bayes", "neuron": "1", "isi diff": 1.1581281471309464}, {"mouse": "m0bayes", "neuron": "2", "isi diff": 1.2073499668163963}, {"mouse": "m0bayes", "neuron": "3", "isi diff": 1.031722883047693}, {"mouse": "m0bayes", "neuron": "4", "isi diff": 1.2292478915030867}, {"mouse": "m0bayes", "neuron": "5", "isi diff": 0.9892751149097866}, {"mouse": "m0bayes", "neuron": "6", "isi diff": 0.9400485811991115}, {"mouse": "m0bayes", "neuron": "7", "isi diff": 1.036034237919406}, {"mouse": "m1bayes", "neuron": "0", "isi diff": 0.7768125734424864}, {"mouse": "m1bayes", "neuron": "1", "isi diff": 1.1664692148221947}, {"mouse": "m1bayes", "neuron": "2", "isi diff": 1.0332676927570819}, {"mouse": "m1bayes", "neuron": "3", "isi diff": 0.9059139858835805}, {"mouse": "m1bayes", "neuron": "4", "isi diff": 1.0310353170874633}, {"mouse": "m1bayes", "neuron": "5", "isi diff": 0.8651313840224889}, {"mouse": "m1bayes", "neuron": "6", "isi diff": 1.1267811057770039}, {"mouse": "m1bayes", "neuron": "7", "isi diff": 1.0642747119774278}, {"mouse": "m2bayes", "neuron": "0", "isi diff": 0.7037373869863093}, {"mouse": "m2bayes", "neuron": "1", "isi diff": 1.1731835561199893}, {"mouse": "m2bayes", "neuron": "2", "isi diff": 1.0818965026384757}, {"mouse": "m2bayes", "neuron": "3", "isi diff": 0.8467045481616522}, {"mouse": "m2bayes", "neuron": "4", "isi diff": 0.9476351868268941}, {"mouse": "m2bayes", "neuron": "5", "isi diff": 0.8955771064946726}, {"mouse": "m2bayes", "neuron": "6", "isi diff": 1.0060499991054412}, {"mouse": "m2bayes", "neuron": "7", "isi diff": 1.0721237029339379}, {"mouse": "m3bayes", "neuron": "0", "isi diff": 0.8640205568387596}, {"mouse": "m3bayes", "neuron": "1", "isi diff": 0.7876129033364007}, {"mouse": "m3bayes", "neuron": "2", "isi diff": 0.948874079087696}, {"mouse": "m3bayes", "neuron": "3", "isi diff": 0.8866927328047733}, {"mouse": "m3bayes", "neuron": "4", "isi diff": 1.2665886066129208}, {"mouse": "m3bayes", "neuron": "5", "isi diff": 0.9837173607704792}, {"mouse": "m3bayes", "neuron": "6", "isi diff": 0.8669738301302768}, {"mouse": "m3bayes", "neuron": "7", "isi diff": 1.0718351040918448}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>TODO leave axis labels here somehow</p>
</div>
<div class="section" id="estimate-model">
<h2>Estimate model<a class="headerlink" href="#estimate-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y = list(set(df.columns) - set(index_cols))[0]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">fit_numpyro</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">treatment</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">condition</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">]),</span>
                    <span class="n">group</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">]),</span>
                    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">model_hierarchical</span><span class="p">,</span>
                    <span class="n">n_draws</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-data-back">
<h2>Add data back<a class="headerlink" href="#add-data-back" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload(utils)</span>
<span class="c1"># df_both, trace = utils.add_data_to_posterior(df, posterior=trace.posterior, y=y,</span>
<span class="c1">#                                              fold_change_index_cols=[&#39;neuron&#39;, &#39;stim&#39;, &#39;mouse_code&#39;, ],</span>
<span class="c1">#                                              treatment_name=&#39;stim&#39;, b_name=&#39;slope_per_condition&#39;,</span>
<span class="c1">#                                              posterior_index_name=&#39;neuron&#39;, group_name=&#39;mouse&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + [markdown] hideCode=false hidePrompt=false</span>
<span class="c1"># # ## Plot data and posterior</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># # BayesWindow.lot(df_both, y=f&#39;{y} diff&#39;, x=&#39;neuron&#39;,color=&#39;mouse_code&#39;,title=y,hold_for_facet=False,add_box=False)</span>
<span class="c1"># reload(visualization)</span>
<span class="c1">#</span>
<span class="c1"># chart_d, _ = visualization.plot_data(df=df_both, x=&#39;neuron&#39;, y=f&#39;{y} diff&#39;, color=&#39;mouse_code&#39;, highlight=False)</span>
<span class="c1"># chart_d</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># chart_p = visualization.plot_posterior(df=df_both, title=f&#39;d_{y}&#39;, x=&#39;neuron&#39;, )</span>
<span class="c1"># chart_p</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).resolve_scale(y=&#39;independent&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).facet(column=&#39;neuron&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix-elements-of-interactivity-wip">
<h2>Appendix: Elements of interactivity (WIP)<a class="headerlink" href="#appendix-elements-of-interactivity-wip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="c1">#axis=alt.Axis(labels=False, tickCount=0, title=&#39;&#39;)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">lines</span><span class="o">+</span><span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-2e24342d79834f29891ac9653f4f0afc"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-2e24342d79834f29891ac9653f4f0afc") {
      outputDiv = document.getElementById("altair-viz-2e24342d79834f29891ac9653f4f0afc");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector001"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04630447508085968, 0.0891758451103827], "zero": false}}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04630447508085968, 0.0891758451103827], "zero": false}}}, "selection": {"selector001": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}], "data": {"name": "data-059c747a2f214a0041922eec6309ff15"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-059c747a2f214a0041922eec6309ff15": [{"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 0, "log_firing_rate": 1.6887275519942662, "Firing rate": 48.834590688764294, "firing_rate": 48.834590688764294, "i_spike": 40.5, "isi": 0.08661908594766465}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 0, "log_firing_rate": 1.6896577223695246, "Firing rate": 48.93929653052425, "firing_rate": 48.93929653052425, "i_spike": 42.0, "isi": 0.08303850116966006}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 0, "log_firing_rate": 2.156703864922972, "Firing rate": 143.45109408970592, "firing_rate": 143.45109408970592, "i_spike": 40.0, "isi": 0.08778836609019434}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 0, "log_firing_rate": 2.065866587875543, "Firing rate": 116.37684732342004, "firing_rate": 116.37684732342004, "i_spike": 44.0, "isi": 0.07826205265455866}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 1, "log_firing_rate": 1.9078669431673876, "Firing rate": 80.88480506509484, "firing_rate": 80.88480506509484, "i_spike": 43.0, "isi": 0.07982288326099447}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 1, "log_firing_rate": 1.7925279073547937, "Firing rate": 62.01944954881104, "firing_rate": 62.01944954881104, "i_spike": 42.0, "isi": 0.08256525983674243}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 1, "log_firing_rate": 1.6938829710992502, "Firing rate": 49.41775035243923, "firing_rate": 49.41775035243923, "i_spike": 35.0, "isi": 0.09851837461050665}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 1, "log_firing_rate": 1.688469528014286, "Firing rate": 48.80558559291466, "firing_rate": 48.80558559291466, "i_spike": 38.5, "isi": 0.08954790467131037}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 2, "log_firing_rate": 1.9333429902501778, "Firing rate": 85.77149704198094, "firing_rate": 85.77149704198094, "i_spike": 48.5, "isi": 0.07081825883146776}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 2, "log_firing_rate": 1.604383922192121, "Firing rate": 40.214615639850784, "firing_rate": 40.214615639850784, "i_spike": 50.0, "isi": 0.06864141353187887}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 2, "log_firing_rate": 1.8324715514075043, "Firing rate": 67.99415037689097, "firing_rate": 67.99415037689097, "i_spike": 37.5, "isi": 0.08966065750231338}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 2, "log_firing_rate": 2.0740894924817264, "Firing rate": 118.60131176599585, "firing_rate": 118.60131176599585, "i_spike": 44.5, "isi": 0.07871597329779868}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 3, "log_firing_rate": 1.8965515729204827, "Firing rate": 78.80460071763832, "firing_rate": 78.80460071763832, "i_spike": 48.0, "isi": 0.07334316058998626}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 3, "log_firing_rate": 1.7815502352272699, "Firing rate": 60.471429513741704, "firing_rate": 60.471429513741704, "i_spike": 53.5, "isi": 0.06434138723859818}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 3, "log_firing_rate": 2.2105028886559275, "Firing rate": 162.36891502136947, "firing_rate": 162.36891502136947, "i_spike": 52.0, "isi": 0.06557798631965818}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 3, "log_firing_rate": 2.3328548797698323, "Firing rate": 215.2062499267452, "firing_rate": 215.2062499267452, "i_spike": 44.0, "isi": 0.07647431231716693}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 4, "log_firing_rate": 2.3848601814567303, "Firing rate": 242.58289880383262, "firing_rate": 242.58289880383262, "i_spike": 70.0, "isi": 0.04969941645976929}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 4, "log_firing_rate": 1.8649488871117155, "Firing rate": 73.27382907942179, "firing_rate": 73.27382907942179, "i_spike": 59.0, "isi": 0.059217363184240895}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 4, "log_firing_rate": 2.338552421656702, "Firing rate": 218.04815770400268, "firing_rate": 218.04815770400268, "i_spike": 52.5, "isi": 0.06590306665687393}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 4, "log_firing_rate": 1.9188155810304741, "Firing rate": 82.94984541859063, "firing_rate": 82.94984541859063, "i_spike": 50.5, "isi": 0.0679826550698319}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 5, "log_firing_rate": 1.7864599014501399, "Firing rate": 61.15893321070427, "firing_rate": 61.15893321070427, "i_spike": 52.5, "isi": 0.06652461428096555}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 5, "log_firing_rate": 1.7417804618975035, "Firing rate": 55.179843181109234, "firing_rate": 55.179843181109234, "i_spike": 57.5, "isi": 0.0609718908700121}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 5, "log_firing_rate": 1.7538175051436196, "Firing rate": 56.730616762678764, "firing_rate": 56.730616762678764, "i_spike": 53.5, "isi": 0.06315829780471077}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 5, "log_firing_rate": 1.9646866695976861, "Firing rate": 92.19060596771398, "firing_rate": 92.19060596771398, "i_spike": 52.5, "isi": 0.06297082197911887}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 6, "log_firing_rate": 1.8706314664013188, "Firing rate": 74.23888941824322, "firing_rate": 74.23888941824322, "i_spike": 59.0, "isi": 0.057575374292849674}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 6, "log_firing_rate": 1.7734357810058716, "Firing rate": 59.35205779932927, "firing_rate": 59.35205779932927, "i_spike": 57.5, "isi": 0.0602897013781917}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 6, "log_firing_rate": 1.9021045981413156, "Firing rate": 79.81869043393812, "firing_rate": 79.81869043393812, "i_spike": 73.5, "isi": 0.04752901503457727}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 6, "log_firing_rate": 2.0367201755100917, "Firing rate": 108.82287002083052, "firing_rate": 108.82287002083052, "i_spike": 55.0, "isi": 0.0632698821229111}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 7, "log_firing_rate": 1.9076582833727478, "Firing rate": 80.84595273393901, "firing_rate": 80.84595273393901, "i_spike": 69.5, "isi": 0.05051839060821045}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 7, "log_firing_rate": 3.1660809026434187, "Firing rate": 1465.8208762893737, "firing_rate": 1465.8208762893737, "i_spike": 61.5, "isi": 0.05717852422924131}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 7, "log_firing_rate": 2.1143017257384162, "Firing rate": 130.10731836444617, "firing_rate": 130.10731836444617, "i_spike": 61.5, "isi": 0.056477774843989734}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 7, "log_firing_rate": 1.9320173788695907, "Firing rate": 85.51009301976838, "firing_rate": 85.51009301976838, "i_spike": 63.0, "isi": 0.055099916245900764}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 8, "log_firing_rate": 1.741415664703257, "Firing rate": 55.13351286598358, "firing_rate": 55.13351286598358, "i_spike": 40.5, "isi": 0.08720896342959988}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 8, "log_firing_rate": 1.7656575508058434, "Firing rate": 58.298522840217295, "firing_rate": 58.298522840217295, "i_spike": 30.0, "isi": 0.11207170319534417}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 8, "log_firing_rate": 2.724652072394708, "Firing rate": 530.4593055464218, "firing_rate": 530.4593055464218, "i_spike": 46.5, "isi": 0.07555639892253982}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 8, "log_firing_rate": 2.5275969835834102, "Firing rate": 336.9744581013488, "firing_rate": 336.9744581013488, "i_spike": 43.5, "isi": 0.07924732855571716}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 9, "log_firing_rate": 1.845741324303013, "Firing rate": 70.10376200501136, "firing_rate": 70.10376200501136, "i_spike": 47.5, "isi": 0.07325050887848013}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 9, "log_firing_rate": 2.158733302279486, "Firing rate": 144.12300287217445, "firing_rate": 144.12300287217445, "i_spike": 52.0, "isi": 0.06606114249088231}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 9, "log_firing_rate": 1.643623010951351, "Firing rate": 44.017260607080225, "firing_rate": 44.017260607080225, "i_spike": 36.5, "isi": 0.09545389776955199}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 9, "log_firing_rate": 1.9718189462907927, "Firing rate": 93.71712266892573, "firing_rate": 93.71712266892573, "i_spike": 50.5, "isi": 0.06704885481885153}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 10, "log_firing_rate": 1.8760772871850429, "Firing rate": 75.17566649716716, "firing_rate": 75.17566649716716, "i_spike": 50.5, "isi": 0.06926125704049137}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 10, "log_firing_rate": 1.8692908397944996, "Firing rate": 74.01007422997728, "firing_rate": 74.01007422997728, "i_spike": 47.5, "isi": 0.06948787918850445}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 10, "log_firing_rate": 1.9129959506894436, "Firing rate": 81.84571569011588, "firing_rate": 81.84571569011588, "i_spike": 44.5, "isi": 0.0783191993336848}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 10, "log_firing_rate": 2.0383861015724274, "Firing rate": 109.24110929866026, "firing_rate": 109.24110929866026, "i_spike": 53.5, "isi": 0.06504580052968774}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 11, "log_firing_rate": 2.0385486086916247, "Firing rate": 109.28199349242516, "firing_rate": 109.28199349242516, "i_spike": 53.0, "isi": 0.06615709302847267}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 11, "log_firing_rate": 2.484360784373903, "Firing rate": 305.0428039921299, "firing_rate": 305.0428039921299, "i_spike": 57.0, "isi": 0.06083948934948562}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 11, "log_firing_rate": 1.8859743482742592, "Firing rate": 76.90850127224068, "firing_rate": 76.90850127224068, "i_spike": 53.5, "isi": 0.06465551531941119}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 11, "log_firing_rate": 2.5418308936269356, "Firing rate": 348.2017052241973, "firing_rate": 348.2017052241973, "i_spike": 69.0, "isi": 0.050392464816197496}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 12, "log_firing_rate": 2.227278359232471, "Firing rate": 168.76343610009496, "firing_rate": 168.76343610009496, "i_spike": 51.0, "isi": 0.06881515356514982}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 12, "log_firing_rate": 1.9443446397902158, "Firing rate": 87.97203529387892, "firing_rate": 87.97203529387892, "i_spike": 45.5, "isi": 0.07541890034797137}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 12, "log_firing_rate": 1.9295079925732, "Firing rate": 85.01743392948504, "firing_rate": 85.01743392948504, "i_spike": 49.5, "isi": 0.06733789577879536}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 12, "log_firing_rate": 1.7284786663312917, "Firing rate": 53.51538649830219, "firing_rate": 53.51538649830219, "i_spike": 43.0, "isi": 0.08137250773232985}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 13, "log_firing_rate": 2.24990799672452, "Firing rate": 177.79027296786288, "firing_rate": 177.79027296786288, "i_spike": 57.5, "isi": 0.06072861537915975}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 13, "log_firing_rate": 2.30020923258845, "Firing rate": 199.6223815740288, "firing_rate": 199.6223815740288, "i_spike": 50.5, "isi": 0.06846887679507098}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 13, "log_firing_rate": 1.758530538964343, "Firing rate": 57.34961925568642, "firing_rate": 57.34961925568642, "i_spike": 50.5, "isi": 0.06609940270732545}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 13, "log_firing_rate": 1.9496665666845494, "Firing rate": 89.05669351857429, "firing_rate": 89.05669351857429, "i_spike": 75.5, "isi": 0.045673402509601474}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 14, "log_firing_rate": 2.307326258171, "Firing rate": 202.92065625241457, "firing_rate": 202.92065625241457, "i_spike": 74.5, "isi": 0.04623494001202999}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 14, "log_firing_rate": 2.142365226495226, "Firing rate": 138.79225326130677, "firing_rate": 138.79225326130677, "i_spike": 74.5, "isi": 0.04626425039135619}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 14, "log_firing_rate": 1.8963614141207914, "Firing rate": 78.77010313901712, "firing_rate": 78.77010313901712, "i_spike": 66.5, "isi": 0.052669784890028715}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 14, "log_firing_rate": 1.7901508425771353, "Firing rate": 61.68091996861071, "firing_rate": 61.68091996861071, "i_spike": 66.5, "isi": 0.05155655515617638}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 15, "log_firing_rate": 1.995746775461033, "Firing rate": 99.02543878664201, "firing_rate": 99.02543878664201, "i_spike": 72.0, "isi": 0.04859355660049189}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 15, "log_firing_rate": 1.77160330199358, "Firing rate": 59.10215302014841, "firing_rate": 59.10215302014841, "i_spike": 74.5, "isi": 0.04687476814859498}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 15, "log_firing_rate": 2.1152395492137184, "Firing rate": 130.38857806510893, "firing_rate": 130.38857806510893, "i_spike": 68.0, "isi": 0.05083381131182607}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 15, "log_firing_rate": 1.9033395350740483, "Firing rate": 80.04598166490523, "firing_rate": 80.04598166490523, "i_spike": 68.5, "isi": 0.0507707125134759}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 16, "log_firing_rate": 1.7086398228348378, "Firing rate": 51.12576539772191, "firing_rate": 51.12576539772191, "i_spike": 36.0, "isi": 0.09607182721856297}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 16, "log_firing_rate": 1.6220125898880433, "Firing rate": 41.880570582138674, "firing_rate": 41.880570582138674, "i_spike": 35.0, "isi": 0.10099040688484592}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 16, "log_firing_rate": 1.9690156010568653, "Firing rate": 93.11413240342598, "firing_rate": 93.11413240342598, "i_spike": 41.0, "isi": 0.08141383537898222}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 16, "log_firing_rate": 2.5733612141895073, "Firing rate": 374.42187536278504, "firing_rate": 374.42187536278504, "i_spike": 61.5, "isi": 0.05726622632263513}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 17, "log_firing_rate": 1.9891557748418727, "Firing rate": 97.53394144346845, "firing_rate": 97.53394144346845, "i_spike": 53.0, "isi": 0.06504517706484976}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 17, "log_firing_rate": 2.1958306525175124, "Firing rate": 156.97505811624328, "firing_rate": 156.97505811624328, "i_spike": 46.0, "isi": 0.07496682862273192}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 17, "log_firing_rate": 3.8065339903865567, "Firing rate": 6405.219105400792, "firing_rate": 6405.219105400792, "i_spike": 42.0, "isi": 0.08078537138452181}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 17, "log_firing_rate": 1.6740614631182729, "Firing rate": 47.21298542694329, "firing_rate": 47.21298542694329, "i_spike": 41.5, "isi": 0.08347441134752744}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 18, "log_firing_rate": 2.188744150829064, "Firing rate": 154.43443758540707, "firing_rate": 154.43443758540707, "i_spike": 53.0, "isi": 0.06643416233804157}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 18, "log_firing_rate": 2.321322978561387, "Firing rate": 209.56703964098526, "firing_rate": 209.56703964098526, "i_spike": 60.0, "isi": 0.056783102442331326}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 18, "log_firing_rate": 2.0049352480983127, "Firing rate": 101.14286422802444, "firing_rate": 101.14286422802444, "i_spike": 55.0, "isi": 0.06370873938787187}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 18, "log_firing_rate": 2.249721374899006, "Firing rate": 177.71389065386114, "firing_rate": 177.71389065386114, "i_spike": 50.0, "isi": 0.06959958844269257}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 19, "log_firing_rate": 1.9450458459269624, "Firing rate": 88.11418850909227, "firing_rate": 88.11418850909227, "i_spike": 45.5, "isi": 0.07396152248596287}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 19, "log_firing_rate": 2.0298704782743826, "Firing rate": 107.11997885455379, "firing_rate": 107.11997885455379, "i_spike": 54.0, "isi": 0.06463437729091173}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 19, "log_firing_rate": 2.0337841155211023, "Firing rate": 108.0896512307599, "firing_rate": 108.0896512307599, "i_spike": 61.5, "isi": 0.055583945112591494}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 19, "log_firing_rate": 1.9135986865987353, "Firing rate": 81.95938418475069, "firing_rate": 81.95938418475069, "i_spike": 56.0, "isi": 0.061765833585044734}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 20, "log_firing_rate": 2.139468310187871, "Firing rate": 137.86953479820608, "firing_rate": 137.86953479820608, "i_spike": 58.5, "isi": 0.06002487157470855}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 20, "log_firing_rate": 1.7959484793886857, "Firing rate": 62.50985325682151, "firing_rate": 62.50985325682151, "i_spike": 57.5, "isi": 0.06011480464495722}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 20, "log_firing_rate": 2.5403836515014317, "Firing rate": 347.04328973074774, "firing_rate": 347.04328973074774, "i_spike": 65.0, "isi": 0.05297731547241637}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 20, "log_firing_rate": 1.884463486389939, "Firing rate": 76.641410065616, "firing_rate": 76.641410065616, "i_spike": 57.0, "isi": 0.060871269047329174}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 21, "log_firing_rate": 2.078236565564541, "Firing rate": 119.73925882209322, "firing_rate": 119.73925882209322, "i_spike": 54.5, "isi": 0.06384447274517112}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 21, "log_firing_rate": 1.7731483919791464, "Firing rate": 59.31279529794517, "firing_rate": 59.31279529794517, "i_spike": 57.0, "isi": 0.06155832160775059}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 21, "log_firing_rate": 2.977682678590328, "Firing rate": 949.9104788725558, "firing_rate": 949.9104788725558, "i_spike": 65.0, "isi": 0.054172188193835756}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 21, "log_firing_rate": 1.8938829311732672, "Firing rate": 78.32184891996293, "firing_rate": 78.32184891996293, "i_spike": 60.5, "isi": 0.05813568351910033}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 22, "log_firing_rate": 1.9492847280000618, "Firing rate": 88.97842785438657, "firing_rate": 88.97842785438657, "i_spike": 74.5, "isi": 0.04670398294647705}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 22, "log_firing_rate": 2.369092530689896, "Firing rate": 233.9335603912629, "firing_rate": 233.9335603912629, "i_spike": 62.0, "isi": 0.056658746136891196}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 22, "log_firing_rate": 2.4573353342358026, "Firing rate": 286.63903577395683, "firing_rate": 286.63903577395683, "i_spike": 70.0, "isi": 0.04878877758952833}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 22, "log_firing_rate": 2.066995084345716, "Firing rate": 116.67964103533673, "firing_rate": 116.67964103533673, "i_spike": 63.0, "isi": 0.055199295912330276}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 23, "log_firing_rate": 2.5563181614425714, "Firing rate": 360.0129818475457, "firing_rate": 360.0129818475457, "i_spike": 73.5, "isi": 0.04735845320695969}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 23, "log_firing_rate": 2.782307902148811, "Firing rate": 605.7701959876032, "firing_rate": 605.7701959876032, "i_spike": 81.5, "isi": 0.04220372859993227}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 23, "log_firing_rate": 2.2982878238937614, "Firing rate": 198.74116161967183, "firing_rate": 198.74116161967183, "i_spike": 76.5, "isi": 0.04585448173423462}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 23, "log_firing_rate": 1.889190355290103, "Firing rate": 77.48013259786075, "firing_rate": 77.48013259786075, "i_spike": 70.0, "isi": 0.05016725626741295}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 24, "log_firing_rate": 1.973692145552248, "Firing rate": 94.12221642492935, "firing_rate": 94.12221642492935, "i_spike": 41.5, "isi": 0.08269552365996499}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 24, "log_firing_rate": 1.9073546502874952, "Firing rate": 80.78944976649038, "firing_rate": 80.78944976649038, "i_spike": 38.5, "isi": 0.08791332951685947}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 24, "log_firing_rate": 1.7996318830276015, "Firing rate": 63.04227585987959, "firing_rate": 63.04227585987959, "i_spike": 47.0, "isi": 0.07477093298114776}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 24, "log_firing_rate": 2.068780972223097, "Firing rate": 117.16043411973907, "firing_rate": 117.16043411973907, "i_spike": 47.5, "isi": 0.07263862334231426}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 25, "log_firing_rate": 1.970626697999907, "Firing rate": 93.46019826610335, "firing_rate": 93.46019826610335, "i_spike": 38.0, "isi": 0.08848487735437423}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 25, "log_firing_rate": 2.1240994561684614, "Firing rate": 133.07591352993308, "firing_rate": 133.07591352993308, "i_spike": 42.0, "isi": 0.08318701829262512}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 25, "log_firing_rate": 2.23803248938828, "Firing rate": 172.994577089293, "firing_rate": 172.994577089293, "i_spike": 55.5, "isi": 0.06341536922068766}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 25, "log_firing_rate": 2.149313985387711, "Firing rate": 141.03080517263834, "firing_rate": 141.03080517263834, "i_spike": 45.5, "isi": 0.07179563093110909}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 26, "log_firing_rate": 1.8659493056372958, "Firing rate": 73.44281347645597, "firing_rate": 73.44281347645597, "i_spike": 59.5, "isi": 0.05893713163744227}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 26, "log_firing_rate": 1.7413968932849544, "Firing rate": 55.13112989334736, "firing_rate": 55.13112989334736, "i_spike": 50.0, "isi": 0.06993551788380258}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 26, "log_firing_rate": 1.866718372350793, "Firing rate": 73.57298428403088, "firing_rate": 73.57298428403088, "i_spike": 58.5, "isi": 0.06000198121520447}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 26, "log_firing_rate": 3.2718116152639616, "Firing rate": 1869.870867014138, "firing_rate": 1869.870867014138, "i_spike": 56.0, "isi": 0.062281935418858125}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 27, "log_firing_rate": 1.749568167718549, "Firing rate": 56.17824499171529, "firing_rate": 56.17824499171529, "i_spike": 49.5, "isi": 0.06951149066954315}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 27, "log_firing_rate": 1.7899307727618248, "Firing rate": 61.6496723460608, "firing_rate": 61.6496723460608, "i_spike": 49.0, "isi": 0.07195592595779107}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 27, "log_firing_rate": 1.8735709616485159, "Firing rate": 74.74307508368325, "firing_rate": 74.74307508368325, "i_spike": 50.0, "isi": 0.07042250020988806}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 27, "log_firing_rate": 1.6987962556881748, "Firing rate": 49.980000448564816, "firing_rate": 49.980000448564816, "i_spike": 63.0, "isi": 0.055015630042234344}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 28, "log_firing_rate": 1.9101414298624124, "Firing rate": 81.30952610163935, "firing_rate": 81.30952610163935, "i_spike": 58.0, "isi": 0.06026380292489554}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 28, "log_firing_rate": 2.084533472154831, "Firing rate": 121.48802507026085, "firing_rate": 121.48802507026085, "i_spike": 65.0, "isi": 0.053335072983841235}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 28, "log_firing_rate": 2.534252826270018, "Firing rate": 342.1785851744676, "firing_rate": 342.1785851744676, "i_spike": 57.0, "isi": 0.061756004885249814}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 28, "log_firing_rate": 1.7696007904753346, "Firing rate": 58.830263077912996, "firing_rate": 58.830263077912996, "i_spike": 42.5, "isi": 0.08212703706479119}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 29, "log_firing_rate": 1.8835393535771705, "Firing rate": 76.47849862601299, "firing_rate": 76.47849862601299, "i_spike": 64.5, "isi": 0.053956260959706376}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 29, "log_firing_rate": 2.168910362705421, "Firing rate": 147.54019825695732, "firing_rate": 147.54019825695732, "i_spike": 65.0, "isi": 0.05405890542330824}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 29, "log_firing_rate": 1.9059581053392107, "Firing rate": 80.5300753292297, "firing_rate": 80.5300753292297, "i_spike": 66.5, "isi": 0.05205593535663821}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 29, "log_firing_rate": 1.9813875358379143, "Firing rate": 95.80485895434695, "firing_rate": 95.80485895434695, "i_spike": 63.5, "isi": 0.054200459040845125}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 30, "log_firing_rate": 2.7537347995989934, "Firing rate": 567.1981420814013, "firing_rate": 567.1981420814013, "i_spike": 63.0, "isi": 0.055351840866159935}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 30, "log_firing_rate": 1.8052267706724339, "Firing rate": 63.859684809370016, "firing_rate": 63.859684809370016, "i_spike": 57.0, "isi": 0.06101157501033578}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 30, "log_firing_rate": 2.2058420195636033, "Firing rate": 160.63568129079695, "firing_rate": 160.63568129079695, "i_spike": 63.5, "isi": 0.05510622030033548}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 30, "log_firing_rate": 2.3698690584429887, "Firing rate": 234.35221273141588, "firing_rate": 234.35221273141588, "i_spike": 75.5, "isi": 0.04577781604915227}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 31, "log_firing_rate": 1.9175489190337187, "Firing rate": 82.70826661093837, "firing_rate": 82.70826661093837, "i_spike": 71.5, "isi": 0.04919635535475317}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 31, "log_firing_rate": 2.08961932958046, "Firing rate": 122.91908806751098, "firing_rate": 122.91908806751098, "i_spike": 74.0, "isi": 0.046379178075651874}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 31, "log_firing_rate": 2.124961163050731, "Firing rate": 133.34021868337808, "firing_rate": 133.34021868337808, "i_spike": 82.0, "isi": 0.04280364427720457}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 31, "log_firing_rate": 1.9193921388279007, "Firing rate": 83.06004055592165, "firing_rate": 83.06004055592165, "i_spike": 59.0, "isi": 0.05963756754580721}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>

<span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-value</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>


<span class="c1"># Transparent selectors across the chart. This is what tells us</span>
<span class="c1"># the x-value of the cursor</span>
<span class="n">selectors</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="c1">#tooltip=color,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">text</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-7482cfc0a3834642acda7890de041c34"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-7482cfc0a3834642acda7890de041c34") {
      outputDiv = document.getElementById("altair-viz-7482cfc0a3834642acda7890de041c34");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04630447508085968, 0.0891758451103827], "zero": false}}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}}, "selection": {"selector002": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["neuron"], "empty": "none"}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04630447508085968, 0.0891758451103827], "zero": false}}}, "selection": {"selector003": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "text": {"condition": {"type": "quantitative", "field": "isi", "selection": "selector002"}, "value": " "}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04630447508085968, 0.0891758451103827], "zero": false}}}}], "data": {"name": "data-059c747a2f214a0041922eec6309ff15"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-059c747a2f214a0041922eec6309ff15": [{"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 0, "log_firing_rate": 1.6887275519942662, "Firing rate": 48.834590688764294, "firing_rate": 48.834590688764294, "i_spike": 40.5, "isi": 0.08661908594766465}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 0, "log_firing_rate": 1.6896577223695246, "Firing rate": 48.93929653052425, "firing_rate": 48.93929653052425, "i_spike": 42.0, "isi": 0.08303850116966006}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 0, "log_firing_rate": 2.156703864922972, "Firing rate": 143.45109408970592, "firing_rate": 143.45109408970592, "i_spike": 40.0, "isi": 0.08778836609019434}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 0, "log_firing_rate": 2.065866587875543, "Firing rate": 116.37684732342004, "firing_rate": 116.37684732342004, "i_spike": 44.0, "isi": 0.07826205265455866}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 1, "log_firing_rate": 1.9078669431673876, "Firing rate": 80.88480506509484, "firing_rate": 80.88480506509484, "i_spike": 43.0, "isi": 0.07982288326099447}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 1, "log_firing_rate": 1.7925279073547937, "Firing rate": 62.01944954881104, "firing_rate": 62.01944954881104, "i_spike": 42.0, "isi": 0.08256525983674243}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 1, "log_firing_rate": 1.6938829710992502, "Firing rate": 49.41775035243923, "firing_rate": 49.41775035243923, "i_spike": 35.0, "isi": 0.09851837461050665}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 1, "log_firing_rate": 1.688469528014286, "Firing rate": 48.80558559291466, "firing_rate": 48.80558559291466, "i_spike": 38.5, "isi": 0.08954790467131037}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 2, "log_firing_rate": 1.9333429902501778, "Firing rate": 85.77149704198094, "firing_rate": 85.77149704198094, "i_spike": 48.5, "isi": 0.07081825883146776}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 2, "log_firing_rate": 1.604383922192121, "Firing rate": 40.214615639850784, "firing_rate": 40.214615639850784, "i_spike": 50.0, "isi": 0.06864141353187887}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 2, "log_firing_rate": 1.8324715514075043, "Firing rate": 67.99415037689097, "firing_rate": 67.99415037689097, "i_spike": 37.5, "isi": 0.08966065750231338}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 2, "log_firing_rate": 2.0740894924817264, "Firing rate": 118.60131176599585, "firing_rate": 118.60131176599585, "i_spike": 44.5, "isi": 0.07871597329779868}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 3, "log_firing_rate": 1.8965515729204827, "Firing rate": 78.80460071763832, "firing_rate": 78.80460071763832, "i_spike": 48.0, "isi": 0.07334316058998626}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 3, "log_firing_rate": 1.7815502352272699, "Firing rate": 60.471429513741704, "firing_rate": 60.471429513741704, "i_spike": 53.5, "isi": 0.06434138723859818}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 3, "log_firing_rate": 2.2105028886559275, "Firing rate": 162.36891502136947, "firing_rate": 162.36891502136947, "i_spike": 52.0, "isi": 0.06557798631965818}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 3, "log_firing_rate": 2.3328548797698323, "Firing rate": 215.2062499267452, "firing_rate": 215.2062499267452, "i_spike": 44.0, "isi": 0.07647431231716693}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 4, "log_firing_rate": 2.3848601814567303, "Firing rate": 242.58289880383262, "firing_rate": 242.58289880383262, "i_spike": 70.0, "isi": 0.04969941645976929}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 4, "log_firing_rate": 1.8649488871117155, "Firing rate": 73.27382907942179, "firing_rate": 73.27382907942179, "i_spike": 59.0, "isi": 0.059217363184240895}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 4, "log_firing_rate": 2.338552421656702, "Firing rate": 218.04815770400268, "firing_rate": 218.04815770400268, "i_spike": 52.5, "isi": 0.06590306665687393}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 4, "log_firing_rate": 1.9188155810304741, "Firing rate": 82.94984541859063, "firing_rate": 82.94984541859063, "i_spike": 50.5, "isi": 0.0679826550698319}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 5, "log_firing_rate": 1.7864599014501399, "Firing rate": 61.15893321070427, "firing_rate": 61.15893321070427, "i_spike": 52.5, "isi": 0.06652461428096555}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 5, "log_firing_rate": 1.7417804618975035, "Firing rate": 55.179843181109234, "firing_rate": 55.179843181109234, "i_spike": 57.5, "isi": 0.0609718908700121}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 5, "log_firing_rate": 1.7538175051436196, "Firing rate": 56.730616762678764, "firing_rate": 56.730616762678764, "i_spike": 53.5, "isi": 0.06315829780471077}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 5, "log_firing_rate": 1.9646866695976861, "Firing rate": 92.19060596771398, "firing_rate": 92.19060596771398, "i_spike": 52.5, "isi": 0.06297082197911887}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 6, "log_firing_rate": 1.8706314664013188, "Firing rate": 74.23888941824322, "firing_rate": 74.23888941824322, "i_spike": 59.0, "isi": 0.057575374292849674}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 6, "log_firing_rate": 1.7734357810058716, "Firing rate": 59.35205779932927, "firing_rate": 59.35205779932927, "i_spike": 57.5, "isi": 0.0602897013781917}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 6, "log_firing_rate": 1.9021045981413156, "Firing rate": 79.81869043393812, "firing_rate": 79.81869043393812, "i_spike": 73.5, "isi": 0.04752901503457727}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 6, "log_firing_rate": 2.0367201755100917, "Firing rate": 108.82287002083052, "firing_rate": 108.82287002083052, "i_spike": 55.0, "isi": 0.0632698821229111}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 7, "log_firing_rate": 1.9076582833727478, "Firing rate": 80.84595273393901, "firing_rate": 80.84595273393901, "i_spike": 69.5, "isi": 0.05051839060821045}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 7, "log_firing_rate": 3.1660809026434187, "Firing rate": 1465.8208762893737, "firing_rate": 1465.8208762893737, "i_spike": 61.5, "isi": 0.05717852422924131}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 7, "log_firing_rate": 2.1143017257384162, "Firing rate": 130.10731836444617, "firing_rate": 130.10731836444617, "i_spike": 61.5, "isi": 0.056477774843989734}, {"mouse": "m0bayes", "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 7, "log_firing_rate": 1.9320173788695907, "Firing rate": 85.51009301976838, "firing_rate": 85.51009301976838, "i_spike": 63.0, "isi": 0.055099916245900764}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 8, "log_firing_rate": 1.741415664703257, "Firing rate": 55.13351286598358, "firing_rate": 55.13351286598358, "i_spike": 40.5, "isi": 0.08720896342959988}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 8, "log_firing_rate": 1.7656575508058434, "Firing rate": 58.298522840217295, "firing_rate": 58.298522840217295, "i_spike": 30.0, "isi": 0.11207170319534417}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 8, "log_firing_rate": 2.724652072394708, "Firing rate": 530.4593055464218, "firing_rate": 530.4593055464218, "i_spike": 46.5, "isi": 0.07555639892253982}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 8, "log_firing_rate": 2.5275969835834102, "Firing rate": 336.9744581013488, "firing_rate": 336.9744581013488, "i_spike": 43.5, "isi": 0.07924732855571716}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 9, "log_firing_rate": 1.845741324303013, "Firing rate": 70.10376200501136, "firing_rate": 70.10376200501136, "i_spike": 47.5, "isi": 0.07325050887848013}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 9, "log_firing_rate": 2.158733302279486, "Firing rate": 144.12300287217445, "firing_rate": 144.12300287217445, "i_spike": 52.0, "isi": 0.06606114249088231}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 9, "log_firing_rate": 1.643623010951351, "Firing rate": 44.017260607080225, "firing_rate": 44.017260607080225, "i_spike": 36.5, "isi": 0.09545389776955199}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 9, "log_firing_rate": 1.9718189462907927, "Firing rate": 93.71712266892573, "firing_rate": 93.71712266892573, "i_spike": 50.5, "isi": 0.06704885481885153}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 10, "log_firing_rate": 1.8760772871850429, "Firing rate": 75.17566649716716, "firing_rate": 75.17566649716716, "i_spike": 50.5, "isi": 0.06926125704049137}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 10, "log_firing_rate": 1.8692908397944996, "Firing rate": 74.01007422997728, "firing_rate": 74.01007422997728, "i_spike": 47.5, "isi": 0.06948787918850445}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 10, "log_firing_rate": 1.9129959506894436, "Firing rate": 81.84571569011588, "firing_rate": 81.84571569011588, "i_spike": 44.5, "isi": 0.0783191993336848}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 10, "log_firing_rate": 2.0383861015724274, "Firing rate": 109.24110929866026, "firing_rate": 109.24110929866026, "i_spike": 53.5, "isi": 0.06504580052968774}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 11, "log_firing_rate": 2.0385486086916247, "Firing rate": 109.28199349242516, "firing_rate": 109.28199349242516, "i_spike": 53.0, "isi": 0.06615709302847267}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 11, "log_firing_rate": 2.484360784373903, "Firing rate": 305.0428039921299, "firing_rate": 305.0428039921299, "i_spike": 57.0, "isi": 0.06083948934948562}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 11, "log_firing_rate": 1.8859743482742592, "Firing rate": 76.90850127224068, "firing_rate": 76.90850127224068, "i_spike": 53.5, "isi": 0.06465551531941119}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 11, "log_firing_rate": 2.5418308936269356, "Firing rate": 348.2017052241973, "firing_rate": 348.2017052241973, "i_spike": 69.0, "isi": 0.050392464816197496}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 12, "log_firing_rate": 2.227278359232471, "Firing rate": 168.76343610009496, "firing_rate": 168.76343610009496, "i_spike": 51.0, "isi": 0.06881515356514982}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 12, "log_firing_rate": 1.9443446397902158, "Firing rate": 87.97203529387892, "firing_rate": 87.97203529387892, "i_spike": 45.5, "isi": 0.07541890034797137}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 12, "log_firing_rate": 1.9295079925732, "Firing rate": 85.01743392948504, "firing_rate": 85.01743392948504, "i_spike": 49.5, "isi": 0.06733789577879536}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 12, "log_firing_rate": 1.7284786663312917, "Firing rate": 53.51538649830219, "firing_rate": 53.51538649830219, "i_spike": 43.0, "isi": 0.08137250773232985}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 13, "log_firing_rate": 2.24990799672452, "Firing rate": 177.79027296786288, "firing_rate": 177.79027296786288, "i_spike": 57.5, "isi": 0.06072861537915975}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 13, "log_firing_rate": 2.30020923258845, "Firing rate": 199.6223815740288, "firing_rate": 199.6223815740288, "i_spike": 50.5, "isi": 0.06846887679507098}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 13, "log_firing_rate": 1.758530538964343, "Firing rate": 57.34961925568642, "firing_rate": 57.34961925568642, "i_spike": 50.5, "isi": 0.06609940270732545}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 13, "log_firing_rate": 1.9496665666845494, "Firing rate": 89.05669351857429, "firing_rate": 89.05669351857429, "i_spike": 75.5, "isi": 0.045673402509601474}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 14, "log_firing_rate": 2.307326258171, "Firing rate": 202.92065625241457, "firing_rate": 202.92065625241457, "i_spike": 74.5, "isi": 0.04623494001202999}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 14, "log_firing_rate": 2.142365226495226, "Firing rate": 138.79225326130677, "firing_rate": 138.79225326130677, "i_spike": 74.5, "isi": 0.04626425039135619}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 14, "log_firing_rate": 1.8963614141207914, "Firing rate": 78.77010313901712, "firing_rate": 78.77010313901712, "i_spike": 66.5, "isi": 0.052669784890028715}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 14, "log_firing_rate": 1.7901508425771353, "Firing rate": 61.68091996861071, "firing_rate": 61.68091996861071, "i_spike": 66.5, "isi": 0.05155655515617638}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 15, "log_firing_rate": 1.995746775461033, "Firing rate": 99.02543878664201, "firing_rate": 99.02543878664201, "i_spike": 72.0, "isi": 0.04859355660049189}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 15, "log_firing_rate": 1.77160330199358, "Firing rate": 59.10215302014841, "firing_rate": 59.10215302014841, "i_spike": 74.5, "isi": 0.04687476814859498}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 15, "log_firing_rate": 2.1152395492137184, "Firing rate": 130.38857806510893, "firing_rate": 130.38857806510893, "i_spike": 68.0, "isi": 0.05083381131182607}, {"mouse": "m1bayes", "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 15, "log_firing_rate": 1.9033395350740483, "Firing rate": 80.04598166490523, "firing_rate": 80.04598166490523, "i_spike": 68.5, "isi": 0.0507707125134759}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 16, "log_firing_rate": 1.7086398228348378, "Firing rate": 51.12576539772191, "firing_rate": 51.12576539772191, "i_spike": 36.0, "isi": 0.09607182721856297}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 16, "log_firing_rate": 1.6220125898880433, "Firing rate": 41.880570582138674, "firing_rate": 41.880570582138674, "i_spike": 35.0, "isi": 0.10099040688484592}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 16, "log_firing_rate": 1.9690156010568653, "Firing rate": 93.11413240342598, "firing_rate": 93.11413240342598, "i_spike": 41.0, "isi": 0.08141383537898222}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 16, "log_firing_rate": 2.5733612141895073, "Firing rate": 374.42187536278504, "firing_rate": 374.42187536278504, "i_spike": 61.5, "isi": 0.05726622632263513}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 17, "log_firing_rate": 1.9891557748418727, "Firing rate": 97.53394144346845, "firing_rate": 97.53394144346845, "i_spike": 53.0, "isi": 0.06504517706484976}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 17, "log_firing_rate": 2.1958306525175124, "Firing rate": 156.97505811624328, "firing_rate": 156.97505811624328, "i_spike": 46.0, "isi": 0.07496682862273192}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 17, "log_firing_rate": 3.8065339903865567, "Firing rate": 6405.219105400792, "firing_rate": 6405.219105400792, "i_spike": 42.0, "isi": 0.08078537138452181}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 17, "log_firing_rate": 1.6740614631182729, "Firing rate": 47.21298542694329, "firing_rate": 47.21298542694329, "i_spike": 41.5, "isi": 0.08347441134752744}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 18, "log_firing_rate": 2.188744150829064, "Firing rate": 154.43443758540707, "firing_rate": 154.43443758540707, "i_spike": 53.0, "isi": 0.06643416233804157}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 18, "log_firing_rate": 2.321322978561387, "Firing rate": 209.56703964098526, "firing_rate": 209.56703964098526, "i_spike": 60.0, "isi": 0.056783102442331326}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 18, "log_firing_rate": 2.0049352480983127, "Firing rate": 101.14286422802444, "firing_rate": 101.14286422802444, "i_spike": 55.0, "isi": 0.06370873938787187}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 18, "log_firing_rate": 2.249721374899006, "Firing rate": 177.71389065386114, "firing_rate": 177.71389065386114, "i_spike": 50.0, "isi": 0.06959958844269257}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 19, "log_firing_rate": 1.9450458459269624, "Firing rate": 88.11418850909227, "firing_rate": 88.11418850909227, "i_spike": 45.5, "isi": 0.07396152248596287}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 19, "log_firing_rate": 2.0298704782743826, "Firing rate": 107.11997885455379, "firing_rate": 107.11997885455379, "i_spike": 54.0, "isi": 0.06463437729091173}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 19, "log_firing_rate": 2.0337841155211023, "Firing rate": 108.0896512307599, "firing_rate": 108.0896512307599, "i_spike": 61.5, "isi": 0.055583945112591494}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 19, "log_firing_rate": 1.9135986865987353, "Firing rate": 81.95938418475069, "firing_rate": 81.95938418475069, "i_spike": 56.0, "isi": 0.061765833585044734}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 20, "log_firing_rate": 2.139468310187871, "Firing rate": 137.86953479820608, "firing_rate": 137.86953479820608, "i_spike": 58.5, "isi": 0.06002487157470855}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 20, "log_firing_rate": 1.7959484793886857, "Firing rate": 62.50985325682151, "firing_rate": 62.50985325682151, "i_spike": 57.5, "isi": 0.06011480464495722}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 20, "log_firing_rate": 2.5403836515014317, "Firing rate": 347.04328973074774, "firing_rate": 347.04328973074774, "i_spike": 65.0, "isi": 0.05297731547241637}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 20, "log_firing_rate": 1.884463486389939, "Firing rate": 76.641410065616, "firing_rate": 76.641410065616, "i_spike": 57.0, "isi": 0.060871269047329174}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 21, "log_firing_rate": 2.078236565564541, "Firing rate": 119.73925882209322, "firing_rate": 119.73925882209322, "i_spike": 54.5, "isi": 0.06384447274517112}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 21, "log_firing_rate": 1.7731483919791464, "Firing rate": 59.31279529794517, "firing_rate": 59.31279529794517, "i_spike": 57.0, "isi": 0.06155832160775059}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 21, "log_firing_rate": 2.977682678590328, "Firing rate": 949.9104788725558, "firing_rate": 949.9104788725558, "i_spike": 65.0, "isi": 0.054172188193835756}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 21, "log_firing_rate": 1.8938829311732672, "Firing rate": 78.32184891996293, "firing_rate": 78.32184891996293, "i_spike": 60.5, "isi": 0.05813568351910033}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 22, "log_firing_rate": 1.9492847280000618, "Firing rate": 88.97842785438657, "firing_rate": 88.97842785438657, "i_spike": 74.5, "isi": 0.04670398294647705}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 22, "log_firing_rate": 2.369092530689896, "Firing rate": 233.9335603912629, "firing_rate": 233.9335603912629, "i_spike": 62.0, "isi": 0.056658746136891196}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 22, "log_firing_rate": 2.4573353342358026, "Firing rate": 286.63903577395683, "firing_rate": 286.63903577395683, "i_spike": 70.0, "isi": 0.04878877758952833}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 22, "log_firing_rate": 2.066995084345716, "Firing rate": 116.67964103533673, "firing_rate": 116.67964103533673, "i_spike": 63.0, "isi": 0.055199295912330276}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 23, "log_firing_rate": 2.5563181614425714, "Firing rate": 360.0129818475457, "firing_rate": 360.0129818475457, "i_spike": 73.5, "isi": 0.04735845320695969}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 23, "log_firing_rate": 2.782307902148811, "Firing rate": 605.7701959876032, "firing_rate": 605.7701959876032, "i_spike": 81.5, "isi": 0.04220372859993227}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 23, "log_firing_rate": 2.2982878238937614, "Firing rate": 198.74116161967183, "firing_rate": 198.74116161967183, "i_spike": 76.5, "isi": 0.04585448173423462}, {"mouse": "m2bayes", "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 23, "log_firing_rate": 1.889190355290103, "Firing rate": 77.48013259786075, "firing_rate": 77.48013259786075, "i_spike": 70.0, "isi": 0.05016725626741295}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "i_trial": 0, "neuron_code": 24, "log_firing_rate": 1.973692145552248, "Firing rate": 94.12221642492935, "firing_rate": 94.12221642492935, "i_spike": 41.5, "isi": 0.08269552365996499}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "i_trial": 1, "neuron_code": 24, "log_firing_rate": 1.9073546502874952, "Firing rate": 80.78944976649038, "firing_rate": 80.78944976649038, "i_spike": 38.5, "isi": 0.08791332951685947}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "i_trial": 0, "neuron_code": 24, "log_firing_rate": 1.7996318830276015, "Firing rate": 63.04227585987959, "firing_rate": 63.04227585987959, "i_spike": 47.0, "isi": 0.07477093298114776}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "i_trial": 1, "neuron_code": 24, "log_firing_rate": 2.068780972223097, "Firing rate": 117.16043411973907, "firing_rate": 117.16043411973907, "i_spike": 47.5, "isi": 0.07263862334231426}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "i_trial": 0, "neuron_code": 25, "log_firing_rate": 1.970626697999907, "Firing rate": 93.46019826610335, "firing_rate": 93.46019826610335, "i_spike": 38.0, "isi": 0.08848487735437423}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "i_trial": 1, "neuron_code": 25, "log_firing_rate": 2.1240994561684614, "Firing rate": 133.07591352993308, "firing_rate": 133.07591352993308, "i_spike": 42.0, "isi": 0.08318701829262512}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "i_trial": 0, "neuron_code": 25, "log_firing_rate": 2.23803248938828, "Firing rate": 172.994577089293, "firing_rate": 172.994577089293, "i_spike": 55.5, "isi": 0.06341536922068766}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "i_trial": 1, "neuron_code": 25, "log_firing_rate": 2.149313985387711, "Firing rate": 141.03080517263834, "firing_rate": 141.03080517263834, "i_spike": 45.5, "isi": 0.07179563093110909}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "i_trial": 0, "neuron_code": 26, "log_firing_rate": 1.8659493056372958, "Firing rate": 73.44281347645597, "firing_rate": 73.44281347645597, "i_spike": 59.5, "isi": 0.05893713163744227}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "i_trial": 1, "neuron_code": 26, "log_firing_rate": 1.7413968932849544, "Firing rate": 55.13112989334736, "firing_rate": 55.13112989334736, "i_spike": 50.0, "isi": 0.06993551788380258}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "i_trial": 0, "neuron_code": 26, "log_firing_rate": 1.866718372350793, "Firing rate": 73.57298428403088, "firing_rate": 73.57298428403088, "i_spike": 58.5, "isi": 0.06000198121520447}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "i_trial": 1, "neuron_code": 26, "log_firing_rate": 3.2718116152639616, "Firing rate": 1869.870867014138, "firing_rate": 1869.870867014138, "i_spike": 56.0, "isi": 0.062281935418858125}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "i_trial": 0, "neuron_code": 27, "log_firing_rate": 1.749568167718549, "Firing rate": 56.17824499171529, "firing_rate": 56.17824499171529, "i_spike": 49.5, "isi": 0.06951149066954315}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "i_trial": 1, "neuron_code": 27, "log_firing_rate": 1.7899307727618248, "Firing rate": 61.6496723460608, "firing_rate": 61.6496723460608, "i_spike": 49.0, "isi": 0.07195592595779107}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "i_trial": 0, "neuron_code": 27, "log_firing_rate": 1.8735709616485159, "Firing rate": 74.74307508368325, "firing_rate": 74.74307508368325, "i_spike": 50.0, "isi": 0.07042250020988806}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "i_trial": 1, "neuron_code": 27, "log_firing_rate": 1.6987962556881748, "Firing rate": 49.980000448564816, "firing_rate": 49.980000448564816, "i_spike": 63.0, "isi": 0.055015630042234344}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "i_trial": 0, "neuron_code": 28, "log_firing_rate": 1.9101414298624124, "Firing rate": 81.30952610163935, "firing_rate": 81.30952610163935, "i_spike": 58.0, "isi": 0.06026380292489554}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "i_trial": 1, "neuron_code": 28, "log_firing_rate": 2.084533472154831, "Firing rate": 121.48802507026085, "firing_rate": 121.48802507026085, "i_spike": 65.0, "isi": 0.053335072983841235}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "i_trial": 0, "neuron_code": 28, "log_firing_rate": 2.534252826270018, "Firing rate": 342.1785851744676, "firing_rate": 342.1785851744676, "i_spike": 57.0, "isi": 0.061756004885249814}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "i_trial": 1, "neuron_code": 28, "log_firing_rate": 1.7696007904753346, "Firing rate": 58.830263077912996, "firing_rate": 58.830263077912996, "i_spike": 42.5, "isi": 0.08212703706479119}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "i_trial": 0, "neuron_code": 29, "log_firing_rate": 1.8835393535771705, "Firing rate": 76.47849862601299, "firing_rate": 76.47849862601299, "i_spike": 64.5, "isi": 0.053956260959706376}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "i_trial": 1, "neuron_code": 29, "log_firing_rate": 2.168910362705421, "Firing rate": 147.54019825695732, "firing_rate": 147.54019825695732, "i_spike": 65.0, "isi": 0.05405890542330824}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "i_trial": 0, "neuron_code": 29, "log_firing_rate": 1.9059581053392107, "Firing rate": 80.5300753292297, "firing_rate": 80.5300753292297, "i_spike": 66.5, "isi": 0.05205593535663821}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "i_trial": 1, "neuron_code": 29, "log_firing_rate": 1.9813875358379143, "Firing rate": 95.80485895434695, "firing_rate": 95.80485895434695, "i_spike": 63.5, "isi": 0.054200459040845125}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "i_trial": 0, "neuron_code": 30, "log_firing_rate": 2.7537347995989934, "Firing rate": 567.1981420814013, "firing_rate": 567.1981420814013, "i_spike": 63.0, "isi": 0.055351840866159935}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "i_trial": 1, "neuron_code": 30, "log_firing_rate": 1.8052267706724339, "Firing rate": 63.859684809370016, "firing_rate": 63.859684809370016, "i_spike": 57.0, "isi": 0.06101157501033578}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "i_trial": 0, "neuron_code": 30, "log_firing_rate": 2.2058420195636033, "Firing rate": 160.63568129079695, "firing_rate": 160.63568129079695, "i_spike": 63.5, "isi": 0.05510622030033548}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "i_trial": 1, "neuron_code": 30, "log_firing_rate": 2.3698690584429887, "Firing rate": 234.35221273141588, "firing_rate": 234.35221273141588, "i_spike": 75.5, "isi": 0.04577781604915227}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "i_trial": 0, "neuron_code": 31, "log_firing_rate": 1.9175489190337187, "Firing rate": 82.70826661093837, "firing_rate": 82.70826661093837, "i_spike": 71.5, "isi": 0.04919635535475317}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "i_trial": 1, "neuron_code": 31, "log_firing_rate": 2.08961932958046, "Firing rate": 122.91908806751098, "firing_rate": 122.91908806751098, "i_spike": 74.0, "isi": 0.046379178075651874}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "i_trial": 0, "neuron_code": 31, "log_firing_rate": 2.124961163050731, "Firing rate": 133.34021868337808, "firing_rate": 133.34021868337808, "i_spike": 82.0, "isi": 0.04280364427720457}, {"mouse": "m3bayes", "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "i_trial": 1, "neuron_code": 31, "log_firing_rate": 1.9193921388279007, "Firing rate": 83.06004055592165, "firing_rate": 83.06004055592165, "i_spike": 59.0, "isi": 0.05963756754580721}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./neurons_example"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="model_comparison.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Compare to alternative models</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Max Myroshnychenko<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>