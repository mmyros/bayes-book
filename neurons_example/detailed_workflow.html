
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neurons example via low-level, flexible interface &#8212; Bayes Window examples</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Compare to alternative models" href="model_comparison.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bayes Window examples</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/metropolis.html">
   Intuition for maximal likelihood or posterior inference
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../radon_example/radon.html">
   Radon example from Gelman and Hill (2006)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_lfp.html">
   Multilevel modeling of LFP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_neurons.html">
   Bayesian Methods for Multilevel Modeling of Neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/quick_lfp.html">
   LFP example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_stim_strength.html">
   LFP example with stim strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_roc.html">
   Compare to ANOVA and LMM: ROC curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Neurons example, pt. 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="posteriors.html">
   Neurons example, no slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_strength.html">
   Neurons example with nominal stim strengths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_type.html">
   Neurons example with stim types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lme.html">
   Linear mixed effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monster.html">
   Neurons example, pt. 2: large datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_comparison.html">
   Compare to alternative models
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Neurons example via low-level, flexible interface
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mmyros/bayes-window"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mmyros/bayes-window/issues/new?title=Issue%20on%20page%20%2Fneurons_example/detailed_workflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mmyros/bayes-window/master?urlpath=tree/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare">
   Prepare
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-data">
   Make some data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimate-model">
   Estimate model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-data-back">
   Add data back
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-elements-of-interactivity-wip">
   Appendix: Elements of interactivity (WIP)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neurons-example-via-low-level-flexible-interface">
<h1>Neurons example via low-level, flexible interface<a class="headerlink" href="#neurons-example-via-low-level-flexible-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare">
<h2>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">bayes_window.fitting</span> <span class="kn">import</span> <span class="n">fit_numpyro</span>
<span class="kn">from</span> <span class="nn">bayes_window.generative_models</span> <span class="kn">import</span> <span class="n">generate_fake_spikes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/optimizers.py:30: FutureWarning: jax.experimental.optimizers is deprecated, import jax.example_libraries.optimizers instead
  FutureWarning)
/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/stax.py:30: FutureWarning: jax.experimental.stax is deprecated, import jax.example_libraries.stax instead
  FutureWarning)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-data">
<h2>Make some data<a class="headerlink" href="#make-some-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">df_monster</span><span class="p">,</span> <span class="n">index_cols</span><span class="p">,</span> <span class="n">firing_rates</span> <span class="o">=</span> <span class="n">generate_fake_spikes</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                                <span class="n">n_neurons</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                                                <span class="n">n_mice</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                <span class="n">dur</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="p">)</span>


<span class="c1"># df[&#39;log_isi&#39;] = np.log10(df[&#39;isi&#39;])</span>

<span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">visualization</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>

<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;isi&#39;</span>
<span class="n">ddf</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_fold_change</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                 <span class="n">index_cols</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">),</span>
                                 <span class="n">treatment_name</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span>
                                 <span class="n">do_take_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span>  <span class="n">df</span><span class="o">=</span><span class="n">ddf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-6ed751e4c7704201a1f7df0aabcac5fb"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-6ed751e4c7704201a1f7df0aabcac5fb") {
      outputDiv = document.getElementById("altair-viz-6ed751e4c7704201a1f7df0aabcac5fb");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.8}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "size": {"value": 1.0}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right"}, "field": "isi diff", "scale": {"domain": [0.811159523700899, 1.173998764007864], "zero": false}, "title": "isi diff"}}}, {"mark": {"type": "circle", "clip": true, "filled": true, "opacity": 0}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.811159523700899, 1.173998764007864], "zero": false}}}}, {"mark": {"type": "boxplot", "clip": true, "color": "black", "median": {"color": "red", "strokeWidth": 20}, "opacity": 0.3, "size": 9}, "encoding": {"x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.811159523700899, 1.173998764007864], "zero": false}}}}], "data": {"name": "data-7ad90da54cfa0d82d54a17a9733bf397"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-7ad90da54cfa0d82d54a17a9733bf397": [{"mouse": "m0bayes", "neuron": "0", "isi diff": 1.1028730458846974}, {"mouse": "m0bayes", "neuron": "1", "isi diff": 0.9196688379180207}, {"mouse": "m0bayes", "neuron": "2", "isi diff": 1.0492088931580539}, {"mouse": "m0bayes", "neuron": "3", "isi diff": 1.0123222425341682}, {"mouse": "m0bayes", "neuron": "4", "isi diff": 0.8875865562738049}, {"mouse": "m0bayes", "neuron": "5", "isi diff": 0.9302128904019538}, {"mouse": "m0bayes", "neuron": "6", "isi diff": 0.8608902168819293}, {"mouse": "m0bayes", "neuron": "7", "isi diff": 1.021295523848555}, {"mouse": "m1bayes", "neuron": "0", "isi diff": 0.815060702032994}, {"mouse": "m1bayes", "neuron": "1", "isi diff": 0.806723504559418}, {"mouse": "m1bayes", "neuron": "2", "isi diff": 0.9192798007607303}, {"mouse": "m1bayes", "neuron": "3", "isi diff": 1.1982298889509806}, {"mouse": "m1bayes", "neuron": "4", "isi diff": 0.9788022651444417}, {"mouse": "m1bayes", "neuron": "5", "isi diff": 0.9180152693762893}, {"mouse": "m1bayes", "neuron": "6", "isi diff": 0.8265611032918372}, {"mouse": "m1bayes", "neuron": "7", "isi diff": 1.1541732981453139}, {"mouse": "m2bayes", "neuron": "0", "isi diff": 1.036696536815}, {"mouse": "m2bayes", "neuron": "1", "isi diff": 0.8731576105709109}, {"mouse": "m2bayes", "neuron": "2", "isi diff": 0.8500236895529004}, {"mouse": "m2bayes", "neuron": "3", "isi diff": 0.7458420616586149}, {"mouse": "m2bayes", "neuron": "4", "isi diff": 0.9002251691261975}, {"mouse": "m2bayes", "neuron": "5", "isi diff": 0.9284881041112447}, {"mouse": "m2bayes", "neuron": "6", "isi diff": 1.3297247479883152}, {"mouse": "m2bayes", "neuron": "7", "isi diff": 0.980996372921659}, {"mouse": "m3bayes", "neuron": "0", "isi diff": 0.909964465782287}, {"mouse": "m3bayes", "neuron": "1", "isi diff": 0.9239522579137055}, {"mouse": "m3bayes", "neuron": "2", "isi diff": 0.8147889939075654}, {"mouse": "m3bayes", "neuron": "3", "isi diff": 1.0512344529526088}, {"mouse": "m3bayes", "neuron": "4", "isi diff": 0.8427515095322552}, {"mouse": "m3bayes", "neuron": "5", "isi diff": 0.9635952659261068}, {"mouse": "m3bayes", "neuron": "6", "isi diff": 0.8251923119830997}, {"mouse": "m3bayes", "neuron": "7", "isi diff": 1.0508459686743565}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>TODO leave axis labels here somehow</p>
</div>
<div class="section" id="estimate-model">
<h2>Estimate model<a class="headerlink" href="#estimate-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y = list(set(df.columns) - set(index_cols))[0]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">fit_numpyro</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">treatment</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">condition</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">]),</span>
                    <span class="n">group</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">]),</span>
                    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">model_hierarchical</span><span class="p">,</span>
                    <span class="n">n_draws</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-data-back">
<h2>Add data back<a class="headerlink" href="#add-data-back" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload(utils)</span>
<span class="c1"># df_both, trace = utils.add_data_to_posterior(df, posterior=trace.posterior, y=y,</span>
<span class="c1">#                                              fold_change_index_cols=[&#39;neuron&#39;, &#39;stim&#39;, &#39;mouse_code&#39;, ],</span>
<span class="c1">#                                              treatment_name=&#39;stim&#39;, b_name=&#39;slope_per_condition&#39;,</span>
<span class="c1">#                                              posterior_index_name=&#39;neuron&#39;, group_name=&#39;mouse&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + [markdown] hideCode=false hidePrompt=false</span>
<span class="c1"># # ## Plot data and posterior</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># # BayesWindow.lot(df_both, y=f&#39;{y} diff&#39;, x=&#39;neuron&#39;,color=&#39;mouse_code&#39;,title=y,hold_for_facet=False,add_box=False)</span>
<span class="c1"># reload(visualization)</span>
<span class="c1">#</span>
<span class="c1"># chart_d, _ = visualization.plot_data(df=df_both, x=&#39;neuron&#39;, y=f&#39;{y} diff&#39;, color=&#39;mouse_code&#39;, highlight=False)</span>
<span class="c1"># chart_d</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># chart_p = visualization.plot_posterior(df=df_both, title=f&#39;d_{y}&#39;, x=&#39;neuron&#39;, )</span>
<span class="c1"># chart_p</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).resolve_scale(y=&#39;independent&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).facet(column=&#39;neuron&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix-elements-of-interactivity-wip">
<h2>Appendix: Elements of interactivity (WIP)<a class="headerlink" href="#appendix-elements-of-interactivity-wip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="c1">#axis=alt.Axis(labels=False, tickCount=0, title=&#39;&#39;)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">lines</span><span class="o">+</span><span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-8654facd851c4ca0877cd9337498757f"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-8654facd851c4ca0877cd9337498757f") {
      outputDiv = document.getElementById("altair-viz-8654facd851c4ca0877cd9337498757f");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector001"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04461346277836644, 0.08224654231010298], "zero": false}}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04461346277836644, 0.08224654231010298], "zero": false}}}, "selection": {"selector001": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}], "data": {"name": "data-e02b815d5c05b0c721d6b7793c5638b1"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-e02b815d5c05b0c721d6b7793c5638b1": [{"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 0, "neuron_code": 0, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.8861853252285403, "Firing rate": 76.94587191332838, "firing_rate": 76.94587191332838, "i_spike": 53.5, "isi": 0.06405525350296434}, {"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 0, "neuron_code": 0, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.709864917531801, "Firing rate": 51.27018889679863, "firing_rate": 51.27018889679863, "i_spike": 43.0, "isi": 0.0797951773916717}, {"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 1, "neuron_code": 0, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.7931155763167541, "Firing rate": 62.10342845572997, "firing_rate": 62.10342845572997, "i_spike": 42.5, "isi": 0.08302835267953915}, {"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 1, "neuron_code": 0, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.6476056070093916, "Firing rate": 44.42276706870125, "firing_rate": 44.42276706870125, "i_spike": 41.5, "isi": 0.08241936735853124}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 0, "neuron_code": 1, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.6584217387590923, "Firing rate": 45.54301088228545, "firing_rate": 45.54301088228545, "i_spike": 45.5, "isi": 0.07713201367900158}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 0, "neuron_code": 1, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.0189546052291854, "Firing rate": 104.46110252097517, "firing_rate": 104.46110252097517, "i_spike": 45.0, "isi": 0.07507058642150777}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 1, "neuron_code": 1, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.1873049041086916, "Firing rate": 153.92349080912606, "firing_rate": 153.92349080912606, "i_spike": 36.5, "isi": 0.09325156646685658}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 1, "neuron_code": 1, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.7594758674760935, "Firing rate": 57.47458809447245, "firing_rate": 57.47458809447245, "i_spike": 42.5, "isi": 0.08162588273154553}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 0, "neuron_code": 2, "stim": 0, "mouse_code": 0, "log_firing_rate": 3.218995531592447, "Firing rate": 1655.7529275244324, "firing_rate": 1655.7529275244324, "i_spike": 58.0, "isi": 0.05941385255216145}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 0, "neuron_code": 2, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.0779206482743335, "Firing rate": 119.6521889912428, "firing_rate": 119.6521889912428, "i_spike": 63.5, "isi": 0.05436178851995795}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 1, "neuron_code": 2, "stim": 0, "mouse_code": 0, "log_firing_rate": 3.402510289020006, "Firing rate": 2526.447564361446, "firing_rate": 2526.447564361446, "i_spike": 56.0, "isi": 0.06115880825465878}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 1, "neuron_code": 2, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.8153356300025274, "Firing rate": 65.36354978969447, "firing_rate": 65.36354978969447, "i_spike": 47.5, "isi": 0.07214411947028737}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 0, "neuron_code": 3, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.018511966086649, "Firing rate": 104.35468851096518, "firing_rate": 104.35468851096518, "i_spike": 47.5, "isi": 0.06930215968507417}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 0, "neuron_code": 3, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.1542898815197904, "Firing rate": 142.6559471334045, "firing_rate": 142.6559471334045, "i_spike": 50.0, "isi": 0.06826010575413925}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 1, "neuron_code": 3, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.177125225909829, "Firing rate": 150.35754495177983, "firing_rate": 150.35754495177983, "i_spike": 59.0, "isi": 0.05942059498650865}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 1, "neuron_code": 3, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.8374409225439503, "Firing rate": 68.77663484906796, "firing_rate": 68.77663484906796, "i_spike": 56.5, "isi": 0.062048801920173056}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 0, "neuron_code": 4, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.9014627752647772, "Firing rate": 79.70081736049517, "firing_rate": 79.70081736049517, "i_spike": 51.5, "isi": 0.06617708073547568}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 0, "neuron_code": 4, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.545960162630093, "Firing rate": 351.5281937428238, "firing_rate": 351.5281937428238, "i_spike": 55.5, "isi": 0.06283250571485327}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 1, "neuron_code": 4, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.648237212952105, "Firing rate": 44.487419274179445, "firing_rate": 44.487419274179445, "i_spike": 53.5, "isi": 0.06501001309389697}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 1, "neuron_code": 4, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.994035007405457, "Firing rate": 98.63589903886849, "firing_rate": 98.63589903886849, "i_spike": 65.0, "isi": 0.05360739512472813}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 0, "neuron_code": 5, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.9978064925747214, "Firing rate": 99.49619960289007, "firing_rate": 99.49619960289007, "i_spike": 53.0, "isi": 0.06639601247618775}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 0, "neuron_code": 5, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.052551937569613, "Firing rate": 112.86309031871926, "firing_rate": 112.86309031871926, "i_spike": 63.5, "isi": 0.05421430981909002}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 1, "neuron_code": 5, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.0777915305924948, "Firing rate": 119.61662115057057, "firing_rate": 119.61662115057057, "i_spike": 61.0, "isi": 0.05665750609347544}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 1, "neuron_code": 5, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.849087520532959, "Firing rate": 70.6459908173959, "firing_rate": 70.6459908173959, "i_spike": 56.0, "isi": 0.060251659363726846}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 0, "neuron_code": 6, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.8730607095586203, "Firing rate": 74.65531109728305, "firing_rate": 74.65531109728305, "i_spike": 58.0, "isi": 0.05997408771649483}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 0, "neuron_code": 6, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.143609529661916, "Firing rate": 139.19047908726432, "firing_rate": 139.19047908726432, "i_spike": 79.5, "isi": 0.04369199460778513}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 1, "neuron_code": 6, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.7966497454755685, "Firing rate": 62.6108710054724, "firing_rate": 62.6108710054724, "i_spike": 60.5, "isi": 0.05761526524611284}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 1, "neuron_code": 6, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.0295514583980654, "Firing rate": 107.04132058115556, "firing_rate": 107.04132058115556, "i_spike": 60.5, "isi": 0.05753952896719993}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 0, "neuron_code": 7, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.175093772131598, "Firing rate": 149.65587556524846, "firing_rate": 149.65587556524846, "i_spike": 60.5, "isi": 0.05732854228728324}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 0, "neuron_code": 7, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.9049223212120006, "Firing rate": 80.33824147331369, "firing_rate": 80.33824147331369, "i_spike": 66.0, "isi": 0.052575029662015466}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 1, "neuron_code": 7, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.1902881611532146, "Firing rate": 154.98446238740812, "firing_rate": 154.98446238740812, "i_spike": 91.5, "isi": 0.03828699542374697}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 1, "neuron_code": 7, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.9942946116611162, "Firing rate": 98.69487734728786, "firing_rate": 98.69487734728786, "i_spike": 78.0, "isi": 0.04507669101263239}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 0, "neuron_code": 8, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.6634551213358122, "Firing rate": 46.073915485432664, "firing_rate": 46.073915485432664, "i_spike": 46.0, "isi": 0.0751006791688033}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 0, "neuron_code": 8, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.773879469168139, "Firing rate": 59.41272461143767, "firing_rate": 59.41272461143767, "i_spike": 45.0, "isi": 0.07478933236585619}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 1, "neuron_code": 8, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.9950054569094833, "Firing rate": 98.85655159030578, "firing_rate": 98.85655159030578, "i_spike": 35.5, "isi": 0.09777713815951747}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 1, "neuron_code": 8, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.7214698723329067, "Firing rate": 52.658668350965485, "firing_rate": 52.658668350965485, "i_spike": 52.5, "isi": 0.0661165827916966}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 0, "neuron_code": 9, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.4563545861882843, "Firing rate": 285.99246183857093, "firing_rate": 285.99246183857093, "i_spike": 45.5, "isi": 0.07515811429567877}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 0, "neuron_code": 9, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.167908774970964, "Firing rate": 147.20032706762748, "firing_rate": 147.20032706762748, "i_spike": 60.0, "isi": 0.056036909050284946}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 1, "neuron_code": 9, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.4547378540524134, "Firing rate": 284.9297874091862, "firing_rate": 284.9297874091862, "i_spike": 46.5, "isi": 0.07395712749681901}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 1, "neuron_code": 9, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.7568186557108967, "Firing rate": 57.12400594906865, "firing_rate": 57.12400594906865, "i_spike": 54.0, "isi": 0.06425786139178388}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 0, "neuron_code": 10, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.2321194204355397, "Firing rate": 170.6551584733089, "firing_rate": 170.6551584733089, "i_spike": 43.5, "isi": 0.07901096452066207}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 0, "neuron_code": 10, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.01493624354958, "Firing rate": 103.49902141474054, "firing_rate": 103.49902141474054, "i_spike": 47.0, "isi": 0.07267800252431801}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 1, "neuron_code": 10, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.8203422470808517, "Firing rate": 66.12143146872059, "firing_rate": 66.12143146872059, "i_spike": 46.0, "isi": 0.07461729113219553}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 1, "neuron_code": 10, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.7678489286524817, "Firing rate": 58.5934309096138, "firing_rate": 58.5934309096138, "i_spike": 50.5, "isi": 0.06854934972345945}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 0, "neuron_code": 11, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.760836023780515, "Firing rate": 57.654873524720024, "firing_rate": 57.654873524720024, "i_spike": 52.0, "isi": 0.06512556513090531}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 0, "neuron_code": 11, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.5942952308643217, "Firing rate": 392.91194388943694, "firing_rate": 392.91194388943694, "i_spike": 44.0, "isi": 0.07844107254727575}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 1, "neuron_code": 11, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.821622455225177, "Firing rate": 66.31663100554381, "firing_rate": 66.31663100554381, "i_spike": 48.0, "isi": 0.07206539618612508}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 1, "neuron_code": 11, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.4043385033245555, "Firing rate": 253.7105362939055, "firing_rate": 253.7105362939055, "i_spike": 41.0, "isi": 0.08594523779670785}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 0, "neuron_code": 12, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.1285552104369883, "Firing rate": 134.44826754925194, "firing_rate": 134.44826754925194, "i_spike": 55.5, "isi": 0.06277094761056275}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 0, "neuron_code": 12, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.0506322032137656, "Firing rate": 112.36529678620077, "firing_rate": 112.36529678620077, "i_spike": 54.0, "isi": 0.06474773851043349}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 1, "neuron_code": 12, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.9679457674024632, "Firing rate": 92.88503891866263, "firing_rate": 92.88503891866263, "i_spike": 58.0, "isi": 0.0592705429614918}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 1, "neuron_code": 12, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.863484666029211, "Firing rate": 73.02720281394943, "firing_rate": 73.02720281394943, "i_spike": 64.0, "isi": 0.05470674890309753}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 0, "neuron_code": 13, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.1681454649420466, "Firing rate": 147.28057293406712, "firing_rate": 147.28057293406712, "i_spike": 53.0, "isi": 0.06611549815597663}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 0, "neuron_code": 13, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.2540080978409316, "Firing rate": 179.47670916899588, "firing_rate": 179.47670916899588, "i_spike": 61.5, "isi": 0.05610025052052354}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 1, "neuron_code": 13, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.3299510451995236, "Firing rate": 213.77211064524147, "firing_rate": 213.77211064524147, "i_spike": 57.5, "isi": 0.0608540744058374}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 1, "neuron_code": 13, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.177637299531942, "Firing rate": 150.53493505305016, "firing_rate": 150.53493505305016, "i_spike": 58.0, "isi": 0.060459755837402464}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 0, "neuron_code": 14, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.7670645622338097, "Firing rate": 58.48770255223036, "firing_rate": 58.48770255223036, "i_spike": 55.0, "isi": 0.061399898424160194}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 0, "neuron_code": 14, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.0157851743234914, "Firing rate": 103.70153247335134, "firing_rate": 103.70153247335134, "i_spike": 68.0, "isi": 0.051452158988121326}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 1, "neuron_code": 14, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.9261997143061855, "Firing rate": 84.37226621819255, "firing_rate": 84.37226621819255, "i_spike": 50.5, "isi": 0.06790507282263712}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 1, "neuron_code": 14, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.950600461528675, "Firing rate": 89.24840462084015, "firing_rate": 89.24840462084015, "i_spike": 63.0, "isi": 0.05542630070675075}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 0, "neuron_code": 15, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.1245320959983394, "Firing rate": 133.20854848112023, "firing_rate": 133.20854848112023, "i_spike": 84.0, "isi": 0.041627666791160325}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 0, "neuron_code": 15, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.9705985900922807, "Firing rate": 93.45414963845319, "firing_rate": 93.45414963845319, "i_spike": 66.5, "isi": 0.052641613174121964}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 1, "neuron_code": 15, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.4949499402917565, "Firing rate": 312.5719054919104, "firing_rate": 312.5719054919104, "i_spike": 73.5, "isi": 0.04731175497726034}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 1, "neuron_code": 15, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.380472140802884, "Firing rate": 240.14422148164377, "firing_rate": 240.14422148164377, "i_spike": 69.0, "isi": 0.05000989258347325}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 0, "neuron_code": 16, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.8175392351802016, "Firing rate": 65.69604651417774, "firing_rate": 65.69604651417774, "i_spike": 44.0, "isi": 0.08007729735821204}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 0, "neuron_code": 16, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.6320023112936082, "Firing rate": 42.855080111739554, "firing_rate": 42.855080111739554, "i_spike": 45.5, "isi": 0.07752487070657021}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 1, "neuron_code": 16, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.223832471610026, "Firing rate": 167.42968941377015, "firing_rate": 167.42968941377015, "i_spike": 54.0, "isi": 0.06397894030115876}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 1, "neuron_code": 16, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.2841668078139112, "Firing rate": 192.38305095160933, "firing_rate": 192.38305095160933, "i_spike": 49.0, "isi": 0.0718177319814981}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 0, "neuron_code": 17, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.7129134439937952, "Firing rate": 51.63134564184319, "firing_rate": 51.63134564184319, "i_spike": 42.5, "isi": 0.08192558150587909}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 0, "neuron_code": 17, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.7855693658300027, "Firing rate": 61.03365322541321, "firing_rate": 61.03365322541321, "i_spike": 53.5, "isi": 0.06301681169208502}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 1, "neuron_code": 17, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.6559737168968511, "Firing rate": 45.28701717874332, "firing_rate": 45.28701717874332, "i_spike": 51.5, "isi": 0.06572072095488198}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 1, "neuron_code": 17, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.2463657308815885, "Firing rate": 176.34604780422396, "firing_rate": 176.34604780422396, "i_spike": 53.0, "isi": 0.0659016809741831}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 0, "neuron_code": 18, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.8129505005024644, "Firing rate": 65.00555948607246, "firing_rate": 65.00555948607246, "i_spike": 51.0, "isi": 0.0679283884867692}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 0, "neuron_code": 18, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.8781956696897408, "Firing rate": 75.543250818214, "firing_rate": 75.543250818214, "i_spike": 50.5, "isi": 0.06701171607154217}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 1, "neuron_code": 18, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.626890362976629, "Firing rate": 42.353603148448315, "firing_rate": 42.353603148448315, "i_spike": 45.0, "isi": 0.07712433892762321}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 1, "neuron_code": 18, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.999872777687906, "Firing rate": 99.97071027034669, "firing_rate": 99.97071027034669, "i_spike": 60.5, "isi": 0.0562865384649508}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 0, "neuron_code": 19, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.9291234323846713, "Firing rate": 84.94218579503205, "firing_rate": 84.94218579503205, "i_spike": 52.5, "isi": 0.06711409932282497}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 0, "neuron_code": 19, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.6128870657101326, "Firing rate": 410.09744704649194, "firing_rate": 410.09744704649194, "i_spike": 66.5, "isi": 0.052470104934795446}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 1, "neuron_code": 19, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.511650395902551, "Firing rate": 32.48257096293888, "firing_rate": 32.48257096293888, "i_spike": 39.5, "isi": 0.08931413907854545}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 1, "neuron_code": 19, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.641911514113693, "Firing rate": 43.844135787708716, "firing_rate": 43.844135787708716, "i_spike": 54.0, "isi": 0.06420065489610799}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 0, "neuron_code": 20, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.881470549039317, "Firing rate": 76.11505210941523, "firing_rate": 76.11505210941523, "i_spike": 53.5, "isi": 0.0644232199920282}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 0, "neuron_code": 20, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.2239006778085253, "Firing rate": 167.45598640784272, "firing_rate": 167.45598640784272, "i_spike": 69.0, "isi": 0.050836152917855155}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 1, "neuron_code": 20, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.8457444566638233, "Firing rate": 70.10426763213259, "firing_rate": 70.10426763213259, "i_spike": 55.5, "isi": 0.06175140396210567}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 1, "neuron_code": 20, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9329864647122348, "Firing rate": 85.7011135074983, "firing_rate": 85.7011135074983, "i_spike": 54.0, "isi": 0.06274941927068939}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 0, "neuron_code": 21, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.59380457800239, "Firing rate": 392.4682944341622, "firing_rate": 392.4682944341622, "i_spike": 66.0, "isi": 0.05147864250017872}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 0, "neuron_code": 21, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9093511925427442, "Firing rate": 81.16171073137343, "firing_rate": 81.16171073137343, "i_spike": 56.0, "isi": 0.061480799891144085}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 1, "neuron_code": 21, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.9989681719912866, "Firing rate": 99.76269483581075, "firing_rate": 99.76269483581075, "i_spike": 53.0, "isi": 0.065652681998859}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 1, "neuron_code": 21, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.8871609226016017, "Firing rate": 77.118917100983, "firing_rate": 77.118917100983, "i_spike": 74.0, "isi": 0.04727424152500645}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 0, "neuron_code": 22, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.9710420820850796, "Firing rate": 93.54963170868358, "firing_rate": 93.54963170868358, "i_spike": 66.0, "isi": 0.05189133151577384}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 0, "neuron_code": 22, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9347428583469082, "Firing rate": 86.04841168213729, "firing_rate": 86.04841168213729, "i_spike": 58.5, "isi": 0.059984112955849364}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 1, "neuron_code": 22, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.019187282313777, "Firing rate": 104.51708346929767, "firing_rate": 104.51708346929767, "i_spike": 81.0, "isi": 0.04228567734500925}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 1, "neuron_code": 22, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9263865673419622, "Firing rate": 84.40857477534466, "firing_rate": 84.40857477534466, "i_spike": 53.5, "isi": 0.06524538641784876}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 0, "neuron_code": 23, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.169753983516621, "Firing rate": 147.8270749162596, "firing_rate": 147.8270749162596, "i_spike": 78.5, "isi": 0.04436403219068477}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 0, "neuron_code": 23, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.1553506914214804, "Firing rate": 143.00482518477446, "firing_rate": 143.00482518477446, "i_spike": 67.5, "isi": 0.05201048170683691}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 1, "neuron_code": 23, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.1227970292073404, "Firing rate": 132.6774234890127, "firing_rate": 132.6774234890127, "i_spike": 70.5, "isi": 0.049871534290331435}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 1, "neuron_code": 23, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.176110133569741, "Firing rate": 150.00651916786785, "firing_rate": 150.00651916786785, "i_spike": 85.0, "isi": 0.04043426721125785}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 0, "neuron_code": 24, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.6651656547497409, "Firing rate": 46.25574229551771, "firing_rate": 46.25574229551771, "i_spike": 47.5, "isi": 0.0731796043594004}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 0, "neuron_code": 24, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.7356697208936727, "Firing rate": 54.40887183085131, "firing_rate": 54.40887183085131, "i_spike": 44.0, "isi": 0.07632085712026318}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 1, "neuron_code": 24, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.8063215374264456, "Firing rate": 640.2086496024908, "firing_rate": 640.2086496024908, "i_spike": 43.0, "isi": 0.0813296771465568}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 1, "neuron_code": 24, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.8624475690960083, "Firing rate": 72.85302162148069, "firing_rate": 72.85302162148069, "i_spike": 54.0, "isi": 0.06427709868371013}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 0, "neuron_code": 25, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.1521784839762836, "Firing rate": 141.96408380616225, "firing_rate": 141.96408380616225, "i_spike": 56.5, "isi": 0.061976362727346176}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 0, "neuron_code": 25, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.991318955447922, "Firing rate": 98.02096086825098, "firing_rate": 98.02096086825098, "i_spike": 48.0, "isi": 0.0726807144659594}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 1, "neuron_code": 25, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.088102967746123, "Firing rate": 122.49065803877957, "firing_rate": 122.49065803877957, "i_spike": 45.0, "isi": 0.07784761841411925}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 1, "neuron_code": 25, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.8919783190143995, "Firing rate": 77.97911805711679, "firing_rate": 77.97911805711679, "i_spike": 61.0, "isi": 0.05650996862018096}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 0, "neuron_code": 26, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.183084996294012, "Firing rate": 152.43510571796222, "firing_rate": 152.43510571796222, "i_spike": 42.0, "isi": 0.08295681970877901}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 0, "neuron_code": 26, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.273569557827998, "Firing rate": 187.7455092793998, "firing_rate": 187.7455092793998, "i_spike": 67.0, "isi": 0.050336541894118306}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 1, "neuron_code": 26, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.2381690335307285, "Firing rate": 173.0489759151756, "firing_rate": 173.0489759151756, "i_spike": 52.5, "isi": 0.0653632788078801}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 1, "neuron_code": 26, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.1897388819355075, "Firing rate": 154.788567813445, "firing_rate": 154.788567813445, "i_spike": 49.0, "isi": 0.07051304195254136}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 0, "neuron_code": 27, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.134117427799081, "Firing rate": 136.18128498612646, "firing_rate": 136.18128498612646, "i_spike": 57.5, "isi": 0.060031542917066694}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 0, "neuron_code": 27, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.0863872148442737, "Firing rate": 122.00769287695735, "firing_rate": 122.00769287695735, "i_spike": 49.5, "isi": 0.0687118438483838}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 1, "neuron_code": 27, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.862814601004069, "Firing rate": 72.9146173516947, "firing_rate": 72.9146173516947, "i_spike": 48.5, "isi": 0.07036952404287836}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 1, "neuron_code": 27, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.6530891948183473, "Firing rate": 44.98722395633707, "firing_rate": 44.98722395633707, "i_spike": 51.0, "isi": 0.06837025044169054}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 0, "neuron_code": 28, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.9510468191801826, "Firing rate": 89.3401791852871, "firing_rate": 89.3401791852871, "i_spike": 57.5, "isi": 0.06035753017153586}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 0, "neuron_code": 28, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.0153919930202306, "Firing rate": 103.6076904971179, "firing_rate": 103.6076904971179, "i_spike": 72.5, "isi": 0.04800438993221131}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 1, "neuron_code": 28, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.967772341114755, "Firing rate": 92.84795465384421, "firing_rate": 92.84795465384421, "i_spike": 46.0, "isi": 0.07336928552479359}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 1, "neuron_code": 28, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.2375744396066377, "Firing rate": 172.81221613601775, "firing_rate": 172.81221613601775, "i_spike": 54.0, "isi": 0.06469408586081199}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 0, "neuron_code": 29, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.1132551203894527, "Firing rate": 129.79415051725525, "firing_rate": 129.79415051725525, "i_spike": 60.0, "isi": 0.057525966611727604}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 0, "neuron_code": 29, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.7250830558389105, "Firing rate": 530.9859819461409, "firing_rate": 530.9859819461409, "i_spike": 53.0, "isi": 0.06595910920970613}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 1, "neuron_code": 29, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.8189178796308954, "Firing rate": 65.90492644043947, "firing_rate": 65.90492644043947, "i_spike": 54.5, "isi": 0.06458909331093214}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 1, "neuron_code": 29, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.9890085002109945, "Firing rate": 97.50087208489688, "firing_rate": 97.50087208489688, "i_spike": 67.5, "isi": 0.05171038443005165}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 0, "neuron_code": 30, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.0328832816251743, "Firing rate": 107.8656789955257, "firing_rate": 107.8656789955257, "i_spike": 56.0, "isi": 0.062360043799819305}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 0, "neuron_code": 30, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.885628520527244, "Firing rate": 76.84728357771405, "firing_rate": 76.84728357771405, "i_spike": 63.5, "isi": 0.05527770721124143}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 1, "neuron_code": 30, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.078529597501598, "Firing rate": 119.82007787084133, "firing_rate": 119.82007787084133, "i_spike": 56.5, "isi": 0.06158844215710912}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 1, "neuron_code": 30, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.987369516435852, "Firing rate": 97.13360702854472, "firing_rate": 97.13360702854472, "i_spike": 73.5, "isi": 0.04700363048236111}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 0, "neuron_code": 31, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.0940228228841224, "Firing rate": 124.17175601630439, "firing_rate": 124.17175601630439, "i_spike": 79.0, "isi": 0.04427889672978752}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 0, "neuron_code": 31, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.2001486883925896, "Firing rate": 158.54359015582898, "firing_rate": 158.54359015582898, "i_spike": 76.0, "isi": 0.04617597225671832}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 1, "neuron_code": 31, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.9884803432834641, "Firing rate": 97.38237078406969, "firing_rate": 97.38237078406969, "i_spike": 72.5, "isi": 0.04685530781716274}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 1, "neuron_code": 31, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.2010616901142592, "Firing rate": 158.87724125077807, "firing_rate": 158.87724125077807, "i_spike": 71.0, "isi": 0.04959203919978858}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>

<span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-value</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>


<span class="c1"># Transparent selectors across the chart. This is what tells us</span>
<span class="c1"># the x-value of the cursor</span>
<span class="n">selectors</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="c1">#tooltip=color,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">text</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-42bb84fe9e964aa2b0f95662a1177749"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-42bb84fe9e964aa2b0f95662a1177749") {
      outputDiv = document.getElementById("altair-viz-42bb84fe9e964aa2b0f95662a1177749");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04461346277836644, 0.08224654231010298], "zero": false}}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}}, "selection": {"selector002": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["neuron"], "empty": "none"}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04461346277836644, 0.08224654231010298], "zero": false}}}, "selection": {"selector003": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "text": {"condition": {"type": "quantitative", "field": "isi", "selection": "selector002"}, "value": " "}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04461346277836644, 0.08224654231010298], "zero": false}}}}], "data": {"name": "data-e02b815d5c05b0c721d6b7793c5638b1"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-e02b815d5c05b0c721d6b7793c5638b1": [{"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 0, "neuron_code": 0, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.8861853252285403, "Firing rate": 76.94587191332838, "firing_rate": 76.94587191332838, "i_spike": 53.5, "isi": 0.06405525350296434}, {"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 0, "neuron_code": 0, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.709864917531801, "Firing rate": 51.27018889679863, "firing_rate": 51.27018889679863, "i_spike": 43.0, "isi": 0.0797951773916717}, {"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 1, "neuron_code": 0, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.7931155763167541, "Firing rate": 62.10342845572997, "firing_rate": 62.10342845572997, "i_spike": 42.5, "isi": 0.08302835267953915}, {"neuron_x_mouse": "m0bayes0", "mouse": "m0bayes", "neuron": "0", "i_trial": 1, "neuron_code": 0, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.6476056070093916, "Firing rate": 44.42276706870125, "firing_rate": 44.42276706870125, "i_spike": 41.5, "isi": 0.08241936735853124}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 0, "neuron_code": 1, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.6584217387590923, "Firing rate": 45.54301088228545, "firing_rate": 45.54301088228545, "i_spike": 45.5, "isi": 0.07713201367900158}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 0, "neuron_code": 1, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.0189546052291854, "Firing rate": 104.46110252097517, "firing_rate": 104.46110252097517, "i_spike": 45.0, "isi": 0.07507058642150777}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 1, "neuron_code": 1, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.1873049041086916, "Firing rate": 153.92349080912606, "firing_rate": 153.92349080912606, "i_spike": 36.5, "isi": 0.09325156646685658}, {"neuron_x_mouse": "m0bayes1", "mouse": "m0bayes", "neuron": "1", "i_trial": 1, "neuron_code": 1, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.7594758674760935, "Firing rate": 57.47458809447245, "firing_rate": 57.47458809447245, "i_spike": 42.5, "isi": 0.08162588273154553}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 0, "neuron_code": 2, "stim": 0, "mouse_code": 0, "log_firing_rate": 3.218995531592447, "Firing rate": 1655.7529275244324, "firing_rate": 1655.7529275244324, "i_spike": 58.0, "isi": 0.05941385255216145}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 0, "neuron_code": 2, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.0779206482743335, "Firing rate": 119.6521889912428, "firing_rate": 119.6521889912428, "i_spike": 63.5, "isi": 0.05436178851995795}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 1, "neuron_code": 2, "stim": 0, "mouse_code": 0, "log_firing_rate": 3.402510289020006, "Firing rate": 2526.447564361446, "firing_rate": 2526.447564361446, "i_spike": 56.0, "isi": 0.06115880825465878}, {"neuron_x_mouse": "m0bayes2", "mouse": "m0bayes", "neuron": "2", "i_trial": 1, "neuron_code": 2, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.8153356300025274, "Firing rate": 65.36354978969447, "firing_rate": 65.36354978969447, "i_spike": 47.5, "isi": 0.07214411947028737}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 0, "neuron_code": 3, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.018511966086649, "Firing rate": 104.35468851096518, "firing_rate": 104.35468851096518, "i_spike": 47.5, "isi": 0.06930215968507417}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 0, "neuron_code": 3, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.1542898815197904, "Firing rate": 142.6559471334045, "firing_rate": 142.6559471334045, "i_spike": 50.0, "isi": 0.06826010575413925}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 1, "neuron_code": 3, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.177125225909829, "Firing rate": 150.35754495177983, "firing_rate": 150.35754495177983, "i_spike": 59.0, "isi": 0.05942059498650865}, {"neuron_x_mouse": "m0bayes3", "mouse": "m0bayes", "neuron": "3", "i_trial": 1, "neuron_code": 3, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.8374409225439503, "Firing rate": 68.77663484906796, "firing_rate": 68.77663484906796, "i_spike": 56.5, "isi": 0.062048801920173056}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 0, "neuron_code": 4, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.9014627752647772, "Firing rate": 79.70081736049517, "firing_rate": 79.70081736049517, "i_spike": 51.5, "isi": 0.06617708073547568}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 0, "neuron_code": 4, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.545960162630093, "Firing rate": 351.5281937428238, "firing_rate": 351.5281937428238, "i_spike": 55.5, "isi": 0.06283250571485327}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 1, "neuron_code": 4, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.648237212952105, "Firing rate": 44.487419274179445, "firing_rate": 44.487419274179445, "i_spike": 53.5, "isi": 0.06501001309389697}, {"neuron_x_mouse": "m0bayes4", "mouse": "m0bayes", "neuron": "4", "i_trial": 1, "neuron_code": 4, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.994035007405457, "Firing rate": 98.63589903886849, "firing_rate": 98.63589903886849, "i_spike": 65.0, "isi": 0.05360739512472813}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 0, "neuron_code": 5, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.9978064925747214, "Firing rate": 99.49619960289007, "firing_rate": 99.49619960289007, "i_spike": 53.0, "isi": 0.06639601247618775}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 0, "neuron_code": 5, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.052551937569613, "Firing rate": 112.86309031871926, "firing_rate": 112.86309031871926, "i_spike": 63.5, "isi": 0.05421430981909002}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 1, "neuron_code": 5, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.0777915305924948, "Firing rate": 119.61662115057057, "firing_rate": 119.61662115057057, "i_spike": 61.0, "isi": 0.05665750609347544}, {"neuron_x_mouse": "m0bayes5", "mouse": "m0bayes", "neuron": "5", "i_trial": 1, "neuron_code": 5, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.849087520532959, "Firing rate": 70.6459908173959, "firing_rate": 70.6459908173959, "i_spike": 56.0, "isi": 0.060251659363726846}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 0, "neuron_code": 6, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.8730607095586203, "Firing rate": 74.65531109728305, "firing_rate": 74.65531109728305, "i_spike": 58.0, "isi": 0.05997408771649483}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 0, "neuron_code": 6, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.143609529661916, "Firing rate": 139.19047908726432, "firing_rate": 139.19047908726432, "i_spike": 79.5, "isi": 0.04369199460778513}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 1, "neuron_code": 6, "stim": 0, "mouse_code": 0, "log_firing_rate": 1.7966497454755685, "Firing rate": 62.6108710054724, "firing_rate": 62.6108710054724, "i_spike": 60.5, "isi": 0.05761526524611284}, {"neuron_x_mouse": "m0bayes6", "mouse": "m0bayes", "neuron": "6", "i_trial": 1, "neuron_code": 6, "stim": 1, "mouse_code": 0, "log_firing_rate": 2.0295514583980654, "Firing rate": 107.04132058115556, "firing_rate": 107.04132058115556, "i_spike": 60.5, "isi": 0.05753952896719993}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 0, "neuron_code": 7, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.175093772131598, "Firing rate": 149.65587556524846, "firing_rate": 149.65587556524846, "i_spike": 60.5, "isi": 0.05732854228728324}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 0, "neuron_code": 7, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.9049223212120006, "Firing rate": 80.33824147331369, "firing_rate": 80.33824147331369, "i_spike": 66.0, "isi": 0.052575029662015466}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 1, "neuron_code": 7, "stim": 0, "mouse_code": 0, "log_firing_rate": 2.1902881611532146, "Firing rate": 154.98446238740812, "firing_rate": 154.98446238740812, "i_spike": 91.5, "isi": 0.03828699542374697}, {"neuron_x_mouse": "m0bayes7", "mouse": "m0bayes", "neuron": "7", "i_trial": 1, "neuron_code": 7, "stim": 1, "mouse_code": 0, "log_firing_rate": 1.9942946116611162, "Firing rate": 98.69487734728786, "firing_rate": 98.69487734728786, "i_spike": 78.0, "isi": 0.04507669101263239}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 0, "neuron_code": 8, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.6634551213358122, "Firing rate": 46.073915485432664, "firing_rate": 46.073915485432664, "i_spike": 46.0, "isi": 0.0751006791688033}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 0, "neuron_code": 8, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.773879469168139, "Firing rate": 59.41272461143767, "firing_rate": 59.41272461143767, "i_spike": 45.0, "isi": 0.07478933236585619}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 1, "neuron_code": 8, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.9950054569094833, "Firing rate": 98.85655159030578, "firing_rate": 98.85655159030578, "i_spike": 35.5, "isi": 0.09777713815951747}, {"neuron_x_mouse": "m1bayes0", "mouse": "m1bayes", "neuron": "0", "i_trial": 1, "neuron_code": 8, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.7214698723329067, "Firing rate": 52.658668350965485, "firing_rate": 52.658668350965485, "i_spike": 52.5, "isi": 0.0661165827916966}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 0, "neuron_code": 9, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.4563545861882843, "Firing rate": 285.99246183857093, "firing_rate": 285.99246183857093, "i_spike": 45.5, "isi": 0.07515811429567877}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 0, "neuron_code": 9, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.167908774970964, "Firing rate": 147.20032706762748, "firing_rate": 147.20032706762748, "i_spike": 60.0, "isi": 0.056036909050284946}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 1, "neuron_code": 9, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.4547378540524134, "Firing rate": 284.9297874091862, "firing_rate": 284.9297874091862, "i_spike": 46.5, "isi": 0.07395712749681901}, {"neuron_x_mouse": "m1bayes1", "mouse": "m1bayes", "neuron": "1", "i_trial": 1, "neuron_code": 9, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.7568186557108967, "Firing rate": 57.12400594906865, "firing_rate": 57.12400594906865, "i_spike": 54.0, "isi": 0.06425786139178388}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 0, "neuron_code": 10, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.2321194204355397, "Firing rate": 170.6551584733089, "firing_rate": 170.6551584733089, "i_spike": 43.5, "isi": 0.07901096452066207}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 0, "neuron_code": 10, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.01493624354958, "Firing rate": 103.49902141474054, "firing_rate": 103.49902141474054, "i_spike": 47.0, "isi": 0.07267800252431801}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 1, "neuron_code": 10, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.8203422470808517, "Firing rate": 66.12143146872059, "firing_rate": 66.12143146872059, "i_spike": 46.0, "isi": 0.07461729113219553}, {"neuron_x_mouse": "m1bayes2", "mouse": "m1bayes", "neuron": "2", "i_trial": 1, "neuron_code": 10, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.7678489286524817, "Firing rate": 58.5934309096138, "firing_rate": 58.5934309096138, "i_spike": 50.5, "isi": 0.06854934972345945}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 0, "neuron_code": 11, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.760836023780515, "Firing rate": 57.654873524720024, "firing_rate": 57.654873524720024, "i_spike": 52.0, "isi": 0.06512556513090531}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 0, "neuron_code": 11, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.5942952308643217, "Firing rate": 392.91194388943694, "firing_rate": 392.91194388943694, "i_spike": 44.0, "isi": 0.07844107254727575}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 1, "neuron_code": 11, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.821622455225177, "Firing rate": 66.31663100554381, "firing_rate": 66.31663100554381, "i_spike": 48.0, "isi": 0.07206539618612508}, {"neuron_x_mouse": "m1bayes3", "mouse": "m1bayes", "neuron": "3", "i_trial": 1, "neuron_code": 11, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.4043385033245555, "Firing rate": 253.7105362939055, "firing_rate": 253.7105362939055, "i_spike": 41.0, "isi": 0.08594523779670785}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 0, "neuron_code": 12, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.1285552104369883, "Firing rate": 134.44826754925194, "firing_rate": 134.44826754925194, "i_spike": 55.5, "isi": 0.06277094761056275}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 0, "neuron_code": 12, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.0506322032137656, "Firing rate": 112.36529678620077, "firing_rate": 112.36529678620077, "i_spike": 54.0, "isi": 0.06474773851043349}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 1, "neuron_code": 12, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.9679457674024632, "Firing rate": 92.88503891866263, "firing_rate": 92.88503891866263, "i_spike": 58.0, "isi": 0.0592705429614918}, {"neuron_x_mouse": "m1bayes4", "mouse": "m1bayes", "neuron": "4", "i_trial": 1, "neuron_code": 12, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.863484666029211, "Firing rate": 73.02720281394943, "firing_rate": 73.02720281394943, "i_spike": 64.0, "isi": 0.05470674890309753}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 0, "neuron_code": 13, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.1681454649420466, "Firing rate": 147.28057293406712, "firing_rate": 147.28057293406712, "i_spike": 53.0, "isi": 0.06611549815597663}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 0, "neuron_code": 13, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.2540080978409316, "Firing rate": 179.47670916899588, "firing_rate": 179.47670916899588, "i_spike": 61.5, "isi": 0.05610025052052354}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 1, "neuron_code": 13, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.3299510451995236, "Firing rate": 213.77211064524147, "firing_rate": 213.77211064524147, "i_spike": 57.5, "isi": 0.0608540744058374}, {"neuron_x_mouse": "m1bayes5", "mouse": "m1bayes", "neuron": "5", "i_trial": 1, "neuron_code": 13, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.177637299531942, "Firing rate": 150.53493505305016, "firing_rate": 150.53493505305016, "i_spike": 58.0, "isi": 0.060459755837402464}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 0, "neuron_code": 14, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.7670645622338097, "Firing rate": 58.48770255223036, "firing_rate": 58.48770255223036, "i_spike": 55.0, "isi": 0.061399898424160194}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 0, "neuron_code": 14, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.0157851743234914, "Firing rate": 103.70153247335134, "firing_rate": 103.70153247335134, "i_spike": 68.0, "isi": 0.051452158988121326}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 1, "neuron_code": 14, "stim": 0, "mouse_code": 1, "log_firing_rate": 1.9261997143061855, "Firing rate": 84.37226621819255, "firing_rate": 84.37226621819255, "i_spike": 50.5, "isi": 0.06790507282263712}, {"neuron_x_mouse": "m1bayes6", "mouse": "m1bayes", "neuron": "6", "i_trial": 1, "neuron_code": 14, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.950600461528675, "Firing rate": 89.24840462084015, "firing_rate": 89.24840462084015, "i_spike": 63.0, "isi": 0.05542630070675075}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 0, "neuron_code": 15, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.1245320959983394, "Firing rate": 133.20854848112023, "firing_rate": 133.20854848112023, "i_spike": 84.0, "isi": 0.041627666791160325}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 0, "neuron_code": 15, "stim": 1, "mouse_code": 1, "log_firing_rate": 1.9705985900922807, "Firing rate": 93.45414963845319, "firing_rate": 93.45414963845319, "i_spike": 66.5, "isi": 0.052641613174121964}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 1, "neuron_code": 15, "stim": 0, "mouse_code": 1, "log_firing_rate": 2.4949499402917565, "Firing rate": 312.5719054919104, "firing_rate": 312.5719054919104, "i_spike": 73.5, "isi": 0.04731175497726034}, {"neuron_x_mouse": "m1bayes7", "mouse": "m1bayes", "neuron": "7", "i_trial": 1, "neuron_code": 15, "stim": 1, "mouse_code": 1, "log_firing_rate": 2.380472140802884, "Firing rate": 240.14422148164377, "firing_rate": 240.14422148164377, "i_spike": 69.0, "isi": 0.05000989258347325}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 0, "neuron_code": 16, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.8175392351802016, "Firing rate": 65.69604651417774, "firing_rate": 65.69604651417774, "i_spike": 44.0, "isi": 0.08007729735821204}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 0, "neuron_code": 16, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.6320023112936082, "Firing rate": 42.855080111739554, "firing_rate": 42.855080111739554, "i_spike": 45.5, "isi": 0.07752487070657021}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 1, "neuron_code": 16, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.223832471610026, "Firing rate": 167.42968941377015, "firing_rate": 167.42968941377015, "i_spike": 54.0, "isi": 0.06397894030115876}, {"neuron_x_mouse": "m2bayes0", "mouse": "m2bayes", "neuron": "0", "i_trial": 1, "neuron_code": 16, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.2841668078139112, "Firing rate": 192.38305095160933, "firing_rate": 192.38305095160933, "i_spike": 49.0, "isi": 0.0718177319814981}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 0, "neuron_code": 17, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.7129134439937952, "Firing rate": 51.63134564184319, "firing_rate": 51.63134564184319, "i_spike": 42.5, "isi": 0.08192558150587909}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 0, "neuron_code": 17, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.7855693658300027, "Firing rate": 61.03365322541321, "firing_rate": 61.03365322541321, "i_spike": 53.5, "isi": 0.06301681169208502}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 1, "neuron_code": 17, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.6559737168968511, "Firing rate": 45.28701717874332, "firing_rate": 45.28701717874332, "i_spike": 51.5, "isi": 0.06572072095488198}, {"neuron_x_mouse": "m2bayes1", "mouse": "m2bayes", "neuron": "1", "i_trial": 1, "neuron_code": 17, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.2463657308815885, "Firing rate": 176.34604780422396, "firing_rate": 176.34604780422396, "i_spike": 53.0, "isi": 0.0659016809741831}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 0, "neuron_code": 18, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.8129505005024644, "Firing rate": 65.00555948607246, "firing_rate": 65.00555948607246, "i_spike": 51.0, "isi": 0.0679283884867692}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 0, "neuron_code": 18, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.8781956696897408, "Firing rate": 75.543250818214, "firing_rate": 75.543250818214, "i_spike": 50.5, "isi": 0.06701171607154217}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 1, "neuron_code": 18, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.626890362976629, "Firing rate": 42.353603148448315, "firing_rate": 42.353603148448315, "i_spike": 45.0, "isi": 0.07712433892762321}, {"neuron_x_mouse": "m2bayes2", "mouse": "m2bayes", "neuron": "2", "i_trial": 1, "neuron_code": 18, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.999872777687906, "Firing rate": 99.97071027034669, "firing_rate": 99.97071027034669, "i_spike": 60.5, "isi": 0.0562865384649508}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 0, "neuron_code": 19, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.9291234323846713, "Firing rate": 84.94218579503205, "firing_rate": 84.94218579503205, "i_spike": 52.5, "isi": 0.06711409932282497}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 0, "neuron_code": 19, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.6128870657101326, "Firing rate": 410.09744704649194, "firing_rate": 410.09744704649194, "i_spike": 66.5, "isi": 0.052470104934795446}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 1, "neuron_code": 19, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.511650395902551, "Firing rate": 32.48257096293888, "firing_rate": 32.48257096293888, "i_spike": 39.5, "isi": 0.08931413907854545}, {"neuron_x_mouse": "m2bayes3", "mouse": "m2bayes", "neuron": "3", "i_trial": 1, "neuron_code": 19, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.641911514113693, "Firing rate": 43.844135787708716, "firing_rate": 43.844135787708716, "i_spike": 54.0, "isi": 0.06420065489610799}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 0, "neuron_code": 20, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.881470549039317, "Firing rate": 76.11505210941523, "firing_rate": 76.11505210941523, "i_spike": 53.5, "isi": 0.0644232199920282}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 0, "neuron_code": 20, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.2239006778085253, "Firing rate": 167.45598640784272, "firing_rate": 167.45598640784272, "i_spike": 69.0, "isi": 0.050836152917855155}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 1, "neuron_code": 20, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.8457444566638233, "Firing rate": 70.10426763213259, "firing_rate": 70.10426763213259, "i_spike": 55.5, "isi": 0.06175140396210567}, {"neuron_x_mouse": "m2bayes4", "mouse": "m2bayes", "neuron": "4", "i_trial": 1, "neuron_code": 20, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9329864647122348, "Firing rate": 85.7011135074983, "firing_rate": 85.7011135074983, "i_spike": 54.0, "isi": 0.06274941927068939}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 0, "neuron_code": 21, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.59380457800239, "Firing rate": 392.4682944341622, "firing_rate": 392.4682944341622, "i_spike": 66.0, "isi": 0.05147864250017872}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 0, "neuron_code": 21, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9093511925427442, "Firing rate": 81.16171073137343, "firing_rate": 81.16171073137343, "i_spike": 56.0, "isi": 0.061480799891144085}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 1, "neuron_code": 21, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.9989681719912866, "Firing rate": 99.76269483581075, "firing_rate": 99.76269483581075, "i_spike": 53.0, "isi": 0.065652681998859}, {"neuron_x_mouse": "m2bayes5", "mouse": "m2bayes", "neuron": "5", "i_trial": 1, "neuron_code": 21, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.8871609226016017, "Firing rate": 77.118917100983, "firing_rate": 77.118917100983, "i_spike": 74.0, "isi": 0.04727424152500645}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 0, "neuron_code": 22, "stim": 0, "mouse_code": 2, "log_firing_rate": 1.9710420820850796, "Firing rate": 93.54963170868358, "firing_rate": 93.54963170868358, "i_spike": 66.0, "isi": 0.05189133151577384}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 0, "neuron_code": 22, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9347428583469082, "Firing rate": 86.04841168213729, "firing_rate": 86.04841168213729, "i_spike": 58.5, "isi": 0.059984112955849364}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 1, "neuron_code": 22, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.019187282313777, "Firing rate": 104.51708346929767, "firing_rate": 104.51708346929767, "i_spike": 81.0, "isi": 0.04228567734500925}, {"neuron_x_mouse": "m2bayes6", "mouse": "m2bayes", "neuron": "6", "i_trial": 1, "neuron_code": 22, "stim": 1, "mouse_code": 2, "log_firing_rate": 1.9263865673419622, "Firing rate": 84.40857477534466, "firing_rate": 84.40857477534466, "i_spike": 53.5, "isi": 0.06524538641784876}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 0, "neuron_code": 23, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.169753983516621, "Firing rate": 147.8270749162596, "firing_rate": 147.8270749162596, "i_spike": 78.5, "isi": 0.04436403219068477}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 0, "neuron_code": 23, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.1553506914214804, "Firing rate": 143.00482518477446, "firing_rate": 143.00482518477446, "i_spike": 67.5, "isi": 0.05201048170683691}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 1, "neuron_code": 23, "stim": 0, "mouse_code": 2, "log_firing_rate": 2.1227970292073404, "Firing rate": 132.6774234890127, "firing_rate": 132.6774234890127, "i_spike": 70.5, "isi": 0.049871534290331435}, {"neuron_x_mouse": "m2bayes7", "mouse": "m2bayes", "neuron": "7", "i_trial": 1, "neuron_code": 23, "stim": 1, "mouse_code": 2, "log_firing_rate": 2.176110133569741, "Firing rate": 150.00651916786785, "firing_rate": 150.00651916786785, "i_spike": 85.0, "isi": 0.04043426721125785}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 0, "neuron_code": 24, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.6651656547497409, "Firing rate": 46.25574229551771, "firing_rate": 46.25574229551771, "i_spike": 47.5, "isi": 0.0731796043594004}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 0, "neuron_code": 24, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.7356697208936727, "Firing rate": 54.40887183085131, "firing_rate": 54.40887183085131, "i_spike": 44.0, "isi": 0.07632085712026318}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 1, "neuron_code": 24, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.8063215374264456, "Firing rate": 640.2086496024908, "firing_rate": 640.2086496024908, "i_spike": 43.0, "isi": 0.0813296771465568}, {"neuron_x_mouse": "m3bayes0", "mouse": "m3bayes", "neuron": "0", "i_trial": 1, "neuron_code": 24, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.8624475690960083, "Firing rate": 72.85302162148069, "firing_rate": 72.85302162148069, "i_spike": 54.0, "isi": 0.06427709868371013}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 0, "neuron_code": 25, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.1521784839762836, "Firing rate": 141.96408380616225, "firing_rate": 141.96408380616225, "i_spike": 56.5, "isi": 0.061976362727346176}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 0, "neuron_code": 25, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.991318955447922, "Firing rate": 98.02096086825098, "firing_rate": 98.02096086825098, "i_spike": 48.0, "isi": 0.0726807144659594}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 1, "neuron_code": 25, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.088102967746123, "Firing rate": 122.49065803877957, "firing_rate": 122.49065803877957, "i_spike": 45.0, "isi": 0.07784761841411925}, {"neuron_x_mouse": "m3bayes1", "mouse": "m3bayes", "neuron": "1", "i_trial": 1, "neuron_code": 25, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.8919783190143995, "Firing rate": 77.97911805711679, "firing_rate": 77.97911805711679, "i_spike": 61.0, "isi": 0.05650996862018096}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 0, "neuron_code": 26, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.183084996294012, "Firing rate": 152.43510571796222, "firing_rate": 152.43510571796222, "i_spike": 42.0, "isi": 0.08295681970877901}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 0, "neuron_code": 26, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.273569557827998, "Firing rate": 187.7455092793998, "firing_rate": 187.7455092793998, "i_spike": 67.0, "isi": 0.050336541894118306}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 1, "neuron_code": 26, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.2381690335307285, "Firing rate": 173.0489759151756, "firing_rate": 173.0489759151756, "i_spike": 52.5, "isi": 0.0653632788078801}, {"neuron_x_mouse": "m3bayes2", "mouse": "m3bayes", "neuron": "2", "i_trial": 1, "neuron_code": 26, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.1897388819355075, "Firing rate": 154.788567813445, "firing_rate": 154.788567813445, "i_spike": 49.0, "isi": 0.07051304195254136}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 0, "neuron_code": 27, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.134117427799081, "Firing rate": 136.18128498612646, "firing_rate": 136.18128498612646, "i_spike": 57.5, "isi": 0.060031542917066694}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 0, "neuron_code": 27, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.0863872148442737, "Firing rate": 122.00769287695735, "firing_rate": 122.00769287695735, "i_spike": 49.5, "isi": 0.0687118438483838}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 1, "neuron_code": 27, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.862814601004069, "Firing rate": 72.9146173516947, "firing_rate": 72.9146173516947, "i_spike": 48.5, "isi": 0.07036952404287836}, {"neuron_x_mouse": "m3bayes3", "mouse": "m3bayes", "neuron": "3", "i_trial": 1, "neuron_code": 27, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.6530891948183473, "Firing rate": 44.98722395633707, "firing_rate": 44.98722395633707, "i_spike": 51.0, "isi": 0.06837025044169054}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 0, "neuron_code": 28, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.9510468191801826, "Firing rate": 89.3401791852871, "firing_rate": 89.3401791852871, "i_spike": 57.5, "isi": 0.06035753017153586}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 0, "neuron_code": 28, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.0153919930202306, "Firing rate": 103.6076904971179, "firing_rate": 103.6076904971179, "i_spike": 72.5, "isi": 0.04800438993221131}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 1, "neuron_code": 28, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.967772341114755, "Firing rate": 92.84795465384421, "firing_rate": 92.84795465384421, "i_spike": 46.0, "isi": 0.07336928552479359}, {"neuron_x_mouse": "m3bayes4", "mouse": "m3bayes", "neuron": "4", "i_trial": 1, "neuron_code": 28, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.2375744396066377, "Firing rate": 172.81221613601775, "firing_rate": 172.81221613601775, "i_spike": 54.0, "isi": 0.06469408586081199}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 0, "neuron_code": 29, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.1132551203894527, "Firing rate": 129.79415051725525, "firing_rate": 129.79415051725525, "i_spike": 60.0, "isi": 0.057525966611727604}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 0, "neuron_code": 29, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.7250830558389105, "Firing rate": 530.9859819461409, "firing_rate": 530.9859819461409, "i_spike": 53.0, "isi": 0.06595910920970613}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 1, "neuron_code": 29, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.8189178796308954, "Firing rate": 65.90492644043947, "firing_rate": 65.90492644043947, "i_spike": 54.5, "isi": 0.06458909331093214}, {"neuron_x_mouse": "m3bayes5", "mouse": "m3bayes", "neuron": "5", "i_trial": 1, "neuron_code": 29, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.9890085002109945, "Firing rate": 97.50087208489688, "firing_rate": 97.50087208489688, "i_spike": 67.5, "isi": 0.05171038443005165}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 0, "neuron_code": 30, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.0328832816251743, "Firing rate": 107.8656789955257, "firing_rate": 107.8656789955257, "i_spike": 56.0, "isi": 0.062360043799819305}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 0, "neuron_code": 30, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.885628520527244, "Firing rate": 76.84728357771405, "firing_rate": 76.84728357771405, "i_spike": 63.5, "isi": 0.05527770721124143}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 1, "neuron_code": 30, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.078529597501598, "Firing rate": 119.82007787084133, "firing_rate": 119.82007787084133, "i_spike": 56.5, "isi": 0.06158844215710912}, {"neuron_x_mouse": "m3bayes6", "mouse": "m3bayes", "neuron": "6", "i_trial": 1, "neuron_code": 30, "stim": 1, "mouse_code": 3, "log_firing_rate": 1.987369516435852, "Firing rate": 97.13360702854472, "firing_rate": 97.13360702854472, "i_spike": 73.5, "isi": 0.04700363048236111}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 0, "neuron_code": 31, "stim": 0, "mouse_code": 3, "log_firing_rate": 2.0940228228841224, "Firing rate": 124.17175601630439, "firing_rate": 124.17175601630439, "i_spike": 79.0, "isi": 0.04427889672978752}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 0, "neuron_code": 31, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.2001486883925896, "Firing rate": 158.54359015582898, "firing_rate": 158.54359015582898, "i_spike": 76.0, "isi": 0.04617597225671832}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 1, "neuron_code": 31, "stim": 0, "mouse_code": 3, "log_firing_rate": 1.9884803432834641, "Firing rate": 97.38237078406969, "firing_rate": 97.38237078406969, "i_spike": 72.5, "isi": 0.04685530781716274}, {"neuron_x_mouse": "m3bayes7", "mouse": "m3bayes", "neuron": "7", "i_trial": 1, "neuron_code": 31, "stim": 1, "mouse_code": 3, "log_firing_rate": 2.2010616901142592, "Firing rate": 158.87724125077807, "firing_rate": 158.87724125077807, "i_spike": 71.0, "isi": 0.04959203919978858}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./neurons_example"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="model_comparison.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Compare to alternative models</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Max Myroshnychenko<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>