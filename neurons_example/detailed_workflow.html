
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neurons example via low-level, flexible interface &#8212; Bayes Window examples</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Compare to alternative models" href="model_comparison.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bayes Window examples</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/metropolis.html">
   Intuition for maximal likelihood or posterior inference
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../radon_example/radon.html">
   Radon example from Gelman and Hill (2006)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_lfp.html">
   Multilevel modeling of LFP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_neurons.html">
   Bayesian Methods for Multilevel Modeling of Neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/quick_lfp.html">
   LFP example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_stim_strength.html">
   LFP example with stim strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_roc.html">
   Compare to ANOVA and LMM: ROC curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Neurons example, pt. 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="posteriors.html">
   Neurons example, no slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_strength.html">
   Neurons example with nominal stim strengths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_type.html">
   Neurons example with stim types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lme.html">
   Linear mixed effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monster.html">
   Neurons example, pt. 2: large datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_comparison.html">
   Compare to alternative models
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Neurons example via low-level, flexible interface
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mmyros/bayes-window"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mmyros/bayes-window/issues/new?title=Issue%20on%20page%20%2Fneurons_example/detailed_workflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mmyros/bayes-window/master?urlpath=tree/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare">
   Prepare
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-data">
   Make some data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimate-model">
   Estimate model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-data-back">
   Add data back
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-elements-of-interactivity-wip">
   Appendix: Elements of interactivity (WIP)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neurons-example-via-low-level-flexible-interface">
<h1>Neurons example via low-level, flexible interface<a class="headerlink" href="#neurons-example-via-low-level-flexible-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare">
<h2>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">bayes_window.fitting</span> <span class="kn">import</span> <span class="n">fit_numpyro</span>
<span class="kn">from</span> <span class="nn">bayes_window.generative_models</span> <span class="kn">import</span> <span class="n">generate_fake_spikes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/optimizers.py:30: FutureWarning: jax.experimental.optimizers is deprecated, import jax.example_libraries.optimizers instead
  FutureWarning)
/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/stax.py:30: FutureWarning: jax.experimental.stax is deprecated, import jax.example_libraries.stax instead
  FutureWarning)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-data">
<h2>Make some data<a class="headerlink" href="#make-some-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">df_monster</span><span class="p">,</span> <span class="n">index_cols</span><span class="p">,</span> <span class="n">firing_rates</span> <span class="o">=</span> <span class="n">generate_fake_spikes</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                                <span class="n">n_neurons</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                                                <span class="n">n_mice</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                <span class="n">dur</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="p">)</span>


<span class="c1"># df[&#39;log_isi&#39;] = np.log10(df[&#39;isi&#39;])</span>

<span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">visualization</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>

<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;isi&#39;</span>
<span class="n">ddf</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_fold_change</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                 <span class="n">index_cols</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">),</span>
                                 <span class="n">treatment_name</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span>
                                 <span class="n">do_take_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span>  <span class="n">df</span><span class="o">=</span><span class="n">ddf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-f7cbc0fdb8d24eca95d7e665d63019c7"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-f7cbc0fdb8d24eca95d7e665d63019c7") {
      outputDiv = document.getElementById("altair-viz-f7cbc0fdb8d24eca95d7e665d63019c7");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.8}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "size": {"value": 1.0}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right"}, "field": "isi diff", "scale": {"domain": [0.7924104305933112, 1.2287795121204546], "zero": false}, "title": "isi diff"}}}, {"mark": {"type": "circle", "clip": true, "filled": true, "opacity": 0}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7924104305933112, 1.2287795121204546], "zero": false}}}}, {"mark": {"type": "boxplot", "clip": true, "color": "black", "median": {"color": "red", "strokeWidth": 20}, "opacity": 0.3, "size": 9}, "encoding": {"x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7924104305933112, 1.2287795121204546], "zero": false}}}}], "data": {"name": "data-85ccfbf69fba7ab8a310e5f20467f021"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-85ccfbf69fba7ab8a310e5f20467f021": [{"mouse": "m0bayes", "neuron": "0", "isi diff": 0.9091261927458862}, {"mouse": "m0bayes", "neuron": "1", "isi diff": 1.0887292051941597}, {"mouse": "m0bayes", "neuron": "2", "isi diff": 1.0453063620314609}, {"mouse": "m0bayes", "neuron": "3", "isi diff": 1.0141268835738357}, {"mouse": "m0bayes", "neuron": "4", "isi diff": 0.8150070991204155}, {"mouse": "m0bayes", "neuron": "5", "isi diff": 1.0529187853530078}, {"mouse": "m0bayes", "neuron": "6", "isi diff": 0.8035523909904266}, {"mouse": "m0bayes", "neuron": "7", "isi diff": 0.8284141840348541}, {"mouse": "m1bayes", "neuron": "0", "isi diff": 0.8216014561288961}, {"mouse": "m1bayes", "neuron": "1", "isi diff": 1.0049707588867705}, {"mouse": "m1bayes", "neuron": "2", "isi diff": 0.995008099855641}, {"mouse": "m1bayes", "neuron": "3", "isi diff": 1.0118973176482104}, {"mouse": "m1bayes", "neuron": "4", "isi diff": 0.978155800415639}, {"mouse": "m1bayes", "neuron": "5", "isi diff": 0.9218131162270116}, {"mouse": "m1bayes", "neuron": "6", "isi diff": 1.1733537254237782}, {"mouse": "m1bayes", "neuron": "7", "isi diff": 0.943671235327611}, {"mouse": "m2bayes", "neuron": "0", "isi diff": 1.2965221403052816}, {"mouse": "m2bayes", "neuron": "1", "isi diff": 0.8514404812430759}, {"mouse": "m2bayes", "neuron": "2", "isi diff": 1.3445879470123239}, {"mouse": "m2bayes", "neuron": "3", "isi diff": 1.0946726476378086}, {"mouse": "m2bayes", "neuron": "4", "isi diff": 0.9746160292586441}, {"mouse": "m2bayes", "neuron": "5", "isi diff": 1.0253178335400615}, {"mouse": "m2bayes", "neuron": "6", "isi diff": 1.0803179789035278}, {"mouse": "m2bayes", "neuron": "7", "isi diff": 0.9797318408723906}, {"mouse": "m3bayes", "neuron": "0", "isi diff": 0.8908317153474131}, {"mouse": "m3bayes", "neuron": "1", "isi diff": 0.7787924789968367}, {"mouse": "m3bayes", "neuron": "2", "isi diff": 0.7414421323182527}, {"mouse": "m3bayes", "neuron": "3", "isi diff": 0.9744005258984564}, {"mouse": "m3bayes", "neuron": "4", "isi diff": 0.9413598167329256}, {"mouse": "m3bayes", "neuron": "5", "isi diff": 0.9390091248973701}, {"mouse": "m3bayes", "neuron": "6", "isi diff": 0.8536689782002842}, {"mouse": "m3bayes", "neuron": "7", "isi diff": 0.9857353702336851}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>TODO leave axis labels here somehow</p>
</div>
<div class="section" id="estimate-model">
<h2>Estimate model<a class="headerlink" href="#estimate-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y = list(set(df.columns) - set(index_cols))[0]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">fit_numpyro</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">treatment</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">condition</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">]),</span>
                    <span class="n">group</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">]),</span>
                    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">model_hierarchical</span><span class="p">,</span>
                    <span class="n">n_draws</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-data-back">
<h2>Add data back<a class="headerlink" href="#add-data-back" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload(utils)</span>
<span class="c1"># df_both, trace = utils.add_data_to_posterior(df, posterior=trace.posterior, y=y,</span>
<span class="c1">#                                              fold_change_index_cols=[&#39;neuron&#39;, &#39;stim&#39;, &#39;mouse_code&#39;, ],</span>
<span class="c1">#                                              treatment_name=&#39;stim&#39;, b_name=&#39;slope_per_condition&#39;,</span>
<span class="c1">#                                              posterior_index_name=&#39;neuron&#39;, group_name=&#39;mouse&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + [markdown] hideCode=false hidePrompt=false</span>
<span class="c1"># # ## Plot data and posterior</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># # BayesWindow.lot(df_both, y=f&#39;{y} diff&#39;, x=&#39;neuron&#39;,color=&#39;mouse_code&#39;,title=y,hold_for_facet=False,add_box=False)</span>
<span class="c1"># reload(visualization)</span>
<span class="c1">#</span>
<span class="c1"># chart_d, _ = visualization.plot_data(df=df_both, x=&#39;neuron&#39;, y=f&#39;{y} diff&#39;, color=&#39;mouse_code&#39;, highlight=False)</span>
<span class="c1"># chart_d</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># chart_p = visualization.plot_posterior(df=df_both, title=f&#39;d_{y}&#39;, x=&#39;neuron&#39;, )</span>
<span class="c1"># chart_p</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).resolve_scale(y=&#39;independent&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).facet(column=&#39;neuron&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix-elements-of-interactivity-wip">
<h2>Appendix: Elements of interactivity (WIP)<a class="headerlink" href="#appendix-elements-of-interactivity-wip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="c1">#axis=alt.Axis(labels=False, tickCount=0, title=&#39;&#39;)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">lines</span><span class="o">+</span><span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-d2900ff8ad9f449f9533b6141babcc16"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d2900ff8ad9f449f9533b6141babcc16") {
      outputDiv = document.getElementById("altair-viz-d2900ff8ad9f449f9533b6141babcc16");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector001"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04660645935147441, 0.0855822303041496], "zero": false}}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04660645935147441, 0.0855822303041496], "zero": false}}}, "selection": {"selector001": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}], "data": {"name": "data-f3282b1c7ea0c80c0c7e658322183f41"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-f3282b1c7ea0c80c0c7e658322183f41": [{"neuron_code": 0, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "log_firing_rate": 1.6663104244784408, "Firing rate": 46.37783001763207, "firing_rate": 46.37783001763207, "i_spike": 45.0, "isi": 0.07761089622118496}, {"neuron_code": 0, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "log_firing_rate": 2.3296751966527287, "Firing rate": 213.63637324801567, "firing_rate": 213.63637324801567, "i_spike": 46.0, "isi": 0.07572149663565791}, {"neuron_code": 0, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "log_firing_rate": 1.6798976530076044, "Firing rate": 47.85173103721719, "firing_rate": 47.85173103721719, "i_spike": 43.0, "isi": 0.08057284291543804}, {"neuron_code": 0, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "log_firing_rate": 1.8533834438046997, "Firing rate": 71.3482694541228, "firing_rate": 71.3482694541228, "i_spike": 50.5, "isi": 0.06808748387992859}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "log_firing_rate": 1.95283864675475, "Firing rate": 89.7095435090419, "firing_rate": 89.7095435090419, "i_spike": 45.5, "isi": 0.07600870716647246}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "log_firing_rate": 1.6553916889439417, "Firing rate": 45.22636557805854, "firing_rate": 45.22636557805854, "i_spike": 52.0, "isi": 0.06643977669145545}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "log_firing_rate": 1.9211751254895484, "Firing rate": 83.40174271279022, "firing_rate": 83.40174271279022, "i_spike": 57.0, "isi": 0.06167640695439336}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "log_firing_rate": 2.023427244674968, "Firing rate": 105.54246780408366, "firing_rate": 105.54246780408366, "i_spike": 42.0, "isi": 0.08346202817242196}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "log_firing_rate": 1.8907206756169759, "Firing rate": 77.75363035913605, "firing_rate": 77.75363035913605, "i_spike": 51.0, "isi": 0.06858902248364884}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "log_firing_rate": 1.7848938578766205, "Firing rate": 60.93879438506826, "firing_rate": 60.93879438506826, "i_spike": 45.5, "isi": 0.07737368109231504}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "log_firing_rate": 1.757079286689947, "Firing rate": 57.158297782210404, "firing_rate": 57.158297782210404, "i_spike": 47.5, "isi": 0.07012546186821655}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "log_firing_rate": 1.9389765030233874, "Firing rate": 86.89134165071832, "firing_rate": 86.89134165071832, "i_spike": 50.0, "isi": 0.06762545190660336}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "log_firing_rate": 2.0273699241781147, "Firing rate": 106.5049822128941, "firing_rate": 106.5049822128941, "i_spike": 63.0, "isi": 0.05547122002155108}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "log_firing_rate": 2.1318761830741404, "Firing rate": 135.4803104264911, "firing_rate": 135.4803104264911, "i_spike": 63.0, "isi": 0.05521805676567571}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "log_firing_rate": 1.7489877314760076, "Firing rate": 56.1032127032266, "firing_rate": 56.1032127032266, "i_spike": 51.0, "isi": 0.06590598174869569}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "log_firing_rate": 1.9765907352382897, "Firing rate": 94.75251260882027, "firing_rate": 94.75251260882027, "i_spike": 51.5, "isi": 0.0678738266024973}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "log_firing_rate": 1.9151662642085094, "Firing rate": 82.25574955212124, "firing_rate": 82.25574955212124, "i_spike": 55.0, "isi": 0.06314492576306131}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "log_firing_rate": 1.9897748051270372, "Firing rate": 97.67306251442677, "firing_rate": 97.67306251442677, "i_spike": 60.5, "isi": 0.05766171708401511}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "log_firing_rate": 1.9451781682674214, "Firing rate": 88.14103953424245, "firing_rate": 88.14103953424245, "i_spike": 42.0, "isi": 0.08383985578407409}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "log_firing_rate": 2.016525624962679, "Firing rate": 103.87848927220108, "firing_rate": 103.87848927220108, "i_spike": 55.0, "isi": 0.062131923339563695}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "log_firing_rate": 2.058575701168154, "Firing rate": 114.43943399576757, "firing_rate": 114.43943399576757, "i_spike": 54.0, "isi": 0.06502201334947832}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "log_firing_rate": 2.2876101012894705, "Firing rate": 193.91441807971594, "firing_rate": 193.91441807971594, "i_spike": 59.5, "isi": 0.05877599461091542}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "log_firing_rate": 1.9613211792016687, "Firing rate": 91.4789517045481, "firing_rate": 91.4789517045481, "i_spike": 59.5, "isi": 0.05811365621662445}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "log_firing_rate": 1.842323127624514, "Firing rate": 69.55416281565954, "firing_rate": 69.55416281565954, "i_spike": 49.5, "isi": 0.07087586502225485}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "log_firing_rate": 1.7272098813579115, "Firing rate": 53.35927023652161, "firing_rate": 53.35927023652161, "i_spike": 60.0, "isi": 0.057948856413999536}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "log_firing_rate": 2.4490963323651687, "Firing rate": 281.25246170534155, "firing_rate": 281.25246170534155, "i_spike": 71.5, "isi": 0.048817866809798154}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "log_firing_rate": 2.098650876381444, "Firing rate": 125.50206634727292, "firing_rate": 125.50206634727292, "i_spike": 58.0, "isi": 0.059294404954437385}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "log_firing_rate": 2.1328011143131462, "Firing rate": 135.76915477007356, "firing_rate": 135.76915477007356, "i_spike": 76.5, "isi": 0.04539323619032486}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "log_firing_rate": 1.7991849828465982, "Firing rate": 62.977437104253134, "firing_rate": 62.977437104253134, "i_spike": 57.0, "isi": 0.061102050265639855}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "log_firing_rate": 2.032004772473387, "Firing rate": 107.64770429991358, "firing_rate": 107.64770429991358, "i_spike": 79.5, "isi": 0.04385750878503755}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "log_firing_rate": 2.2331696504289473, "Firing rate": 171.06834366383765, "firing_rate": 171.06834366383765, "i_spike": 79.0, "isi": 0.04388127648811457}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "log_firing_rate": 2.0151438429723667, "Firing rate": 103.54850736083914, "firing_rate": 103.54850736083914, "i_spike": 79.5, "isi": 0.043112168184938404}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "log_firing_rate": 1.5328314600283028, "Firing rate": 34.10605279758676, "firing_rate": 34.10605279758676, "i_spike": 35.0, "isi": 0.09385192920826789}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "log_firing_rate": 2.3428177626454474, "Firing rate": 220.20022715414103, "firing_rate": 220.20022715414103, "i_spike": 43.5, "isi": 0.08099582838732101}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "log_firing_rate": 1.7710993579352552, "Firing rate": 59.03361218811726, "firing_rate": 59.03361218811726, "i_spike": 38.0, "isi": 0.09248746376891379}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "log_firing_rate": 1.7138263419093873, "Firing rate": 51.73999017473991, "firing_rate": 51.73999017473991, "i_spike": 46.5, "isi": 0.07210088821690604}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "log_firing_rate": 1.9518843964429273, "Firing rate": 89.51264627823409, "firing_rate": 89.51264627823409, "i_spike": 51.0, "isi": 0.06854158489570239}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "log_firing_rate": 1.5726622298194617, "Firing rate": 37.381973890666444, "firing_rate": 37.381973890666444, "i_spike": 38.5, "isi": 0.08878199009389137}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "log_firing_rate": 2.1151149670087137, "Firing rate": 130.35118001479424, "firing_rate": 130.35118001479424, "i_spike": 42.0, "isi": 0.08293449437136358}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "log_firing_rate": 1.7769834489992442, "Firing rate": 59.8388789976557, "firing_rate": 59.8388789976557, "i_spike": 55.0, "isi": 0.06344704024032452}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "log_firing_rate": 1.9554442954782552, "Firing rate": 90.24939422016051, "firing_rate": 90.24939422016051, "i_spike": 54.0, "isi": 0.06386386999344715}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "log_firing_rate": 2.034015470300679, "Firing rate": 108.14724744822499, "firing_rate": 108.14724744822499, "i_spike": 57.0, "isi": 0.05953374432919331}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "log_firing_rate": 1.8895131827423814, "Firing rate": 77.53774791097574, "firing_rate": 77.53774791097574, "i_spike": 45.5, "isi": 0.07574926546915904}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "log_firing_rate": 2.057401176073664, "Firing rate": 114.13035708709339, "firing_rate": 114.13035708709339, "i_spike": 41.5, "isi": 0.07938245630234265}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "log_firing_rate": 2.205339174756203, "Firing rate": 160.44979803105144, "firing_rate": 160.44979803105144, "i_spike": 45.5, "isi": 0.07428580463062659}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "log_firing_rate": 2.228425379510321, "Firing rate": 169.20974832222979, "firing_rate": 169.20974832222979, "i_spike": 55.5, "isi": 0.06178075458328285}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "log_firing_rate": 2.172529464261199, "Firing rate": 148.77483054050091, "firing_rate": 148.77483054050091, "i_spike": 66.0, "isi": 0.0534201522756555}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "log_firing_rate": 1.7277225245329388, "Firing rate": 53.42229294980848, "firing_rate": 53.42229294980848, "i_spike": 52.0, "isi": 0.06744456065788194}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "log_firing_rate": 2.474489164127447, "Firing rate": 298.1873147715974, "firing_rate": 298.1873147715974, "i_spike": 54.0, "isi": 0.0638143535907843}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "log_firing_rate": 1.683760616834297, "Firing rate": 48.27926133438604, "firing_rate": 48.27926133438604, "i_spike": 61.5, "isi": 0.05660051544322663}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "log_firing_rate": 2.0128325079526745, "Firing rate": 102.99888135150388, "firing_rate": 102.99888135150388, "i_spike": 60.0, "isi": 0.05851082443679985}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "log_firing_rate": 1.9089847062563394, "Firing rate": 81.09325002444842, "firing_rate": 81.09325002444842, "i_spike": 54.5, "isi": 0.06305256698133047}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "log_firing_rate": 1.9949730756329487, "Firing rate": 98.84918105687149, "firing_rate": 98.84918105687149, "i_spike": 62.5, "isi": 0.05481030225471106}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "log_firing_rate": 2.249972938792012, "Firing rate": 177.8168607595556, "firing_rate": 177.8168607595556, "i_spike": 74.5, "isi": 0.04656315207551359}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "log_firing_rate": 2.250890507198533, "Firing rate": 178.1929457006692, "firing_rate": 178.1929457006692, "i_spike": 67.0, "isi": 0.05215361370277925}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "log_firing_rate": 2.2338076320645133, "Firing rate": 171.31982893036775, "firing_rate": 171.31982893036775, "i_spike": 66.5, "isi": 0.052037588617104724}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "log_firing_rate": 1.9985371385507964, "Firing rate": 99.6637303604343, "firing_rate": 99.6637303604343, "i_spike": 68.5, "isi": 0.050117994048944646}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "log_firing_rate": 1.923969740891794, "Firing rate": 83.9401499877872, "firing_rate": 83.9401499877872, "i_spike": 60.5, "isi": 0.05736421749293488}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "log_firing_rate": 2.0694780133159973, "Firing rate": 117.34862718240316, "firing_rate": 117.34862718240316, "i_spike": 69.0, "isi": 0.050429337267269475}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "log_firing_rate": 2.0787857603605824, "Firing rate": 119.8907730070552, "firing_rate": 119.8907730070552, "i_spike": 57.5, "isi": 0.06061336828836388}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "log_firing_rate": 2.340949772955236, "Firing rate": 219.25513476406528, "firing_rate": 219.25513476406528, "i_spike": 75.0, "isi": 0.04668688714968735}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "log_firing_rate": 1.886001899841315, "Firing rate": 76.9133804890684, "firing_rate": 76.9133804890684, "i_spike": 80.0, "isi": 0.04301990361527198}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "log_firing_rate": 1.8873284683570808, "Firing rate": 77.14867442110095, "firing_rate": 77.14867442110095, "i_spike": 61.5, "isi": 0.0571677961802205}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "log_firing_rate": 2.3331277521308906, "Firing rate": 215.3415090476531, "firing_rate": 215.3415090476531, "i_spike": 63.5, "isi": 0.05498477369722001}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "log_firing_rate": 2.2117777223982293, "Firing rate": 162.8462350961711, "firing_rate": 162.8462350961711, "i_spike": 49.0, "isi": 0.06950931431928385}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "log_firing_rate": 2.432711401038399, "Firing rate": 270.839124367633, "firing_rate": 270.839124367633, "i_spike": 47.0, "isi": 0.07524105490556886}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "log_firing_rate": 2.296301302981331, "Firing rate": 197.8341689605457, "firing_rate": 197.8341689605457, "i_spike": 43.5, "isi": 0.07946439581093698}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "log_firing_rate": 1.4582747118939854, "Firing rate": 28.72597061583477, "firing_rate": 28.72597061583477, "i_spike": 30.0, "isi": 0.11790665860168363}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "log_firing_rate": 2.7349033052104152, "Firing rate": 543.1293913669488, "firing_rate": 543.1293913669488, "i_spike": 45.5, "isi": 0.07429446119475647}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "log_firing_rate": 2.198359914549782, "Firing rate": 157.8919231504682, "firing_rate": 157.8919231504682, "i_spike": 50.0, "isi": 0.06783414486987437}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "log_firing_rate": 2.0729452144123144, "Firing rate": 118.28923262468051, "firing_rate": 118.28923262468051, "i_spike": 44.0, "isi": 0.07822630138492363}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "log_firing_rate": 3.021431391889098, "Firing rate": 1050.5854744504222, "firing_rate": 1050.5854744504222, "i_spike": 56.5, "isi": 0.0620282066205294}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "log_firing_rate": 2.542446675860244, "Firing rate": 348.69576746549535, "firing_rate": 348.69576746549535, "i_spike": 54.5, "isi": 0.06417670966209792}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "log_firing_rate": 2.4151814759517953, "Firing rate": 260.1246302815211, "firing_rate": 260.1246302815211, "i_spike": 42.5, "isi": 0.08115314408945787}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "log_firing_rate": 1.9013106817627226, "Firing rate": 79.67291036518716, "firing_rate": 79.67291036518716, "i_spike": 49.0, "isi": 0.07122829168206773}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "log_firing_rate": 1.6840043519687717, "Firing rate": 48.30636426892448, "firing_rate": 48.30636426892448, "i_spike": 34.0, "isi": 0.10091078868309482}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "log_firing_rate": 1.9203217698905402, "Firing rate": 83.23802553536271, "firing_rate": 83.23802553536271, "i_spike": 56.5, "isi": 0.06239586418875065}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "log_firing_rate": 1.8599472404040152, "Firing rate": 72.43479584340517, "firing_rate": 72.43479584340517, "i_spike": 57.5, "isi": 0.06095784676633729}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "log_firing_rate": 2.3549667845159146, "Firing rate": 226.44711108713676, "firing_rate": 226.44711108713676, "i_spike": 55.5, "isi": 0.0634775733424374}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "log_firing_rate": 2.2031671325546944, "Firing rate": 159.6493418656382, "firing_rate": 159.6493418656382, "i_spike": 45.5, "isi": 0.07683236236320062}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "log_firing_rate": 2.051708238245999, "Firing rate": 112.64404521705198, "firing_rate": 112.64404521705198, "i_spike": 56.5, "isi": 0.06204892241541356}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "log_firing_rate": 2.0817302771779094, "Firing rate": 120.70639434369137, "firing_rate": 120.70639434369137, "i_spike": 60.0, "isi": 0.057730017623095486}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "log_firing_rate": 1.7288216905290155, "Firing rate": 53.55767191704656, "firing_rate": 53.55767191704656, "i_spike": 52.5, "isi": 0.06529397899860677}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "log_firing_rate": 2.2989673736802296, "Firing rate": 199.05237955136556, "firing_rate": 199.05237955136556, "i_spike": 53.0, "isi": 0.06638041530731198}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "log_firing_rate": 1.8575926145045647, "Firing rate": 72.04313688485489, "firing_rate": 72.04313688485489, "i_spike": 54.0, "isi": 0.06301462369400955}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "log_firing_rate": 1.9495797481313146, "Firing rate": 89.03889223202201, "firing_rate": 89.03889223202201, "i_spike": 62.0, "isi": 0.05657984089078366}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "log_firing_rate": 2.514263236435292, "Firing rate": 326.78584499496236, "firing_rate": 326.78584499496236, "i_spike": 67.5, "isi": 0.05160482782687694}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "log_firing_rate": 2.055453776485718, "Firing rate": 113.61973616845678, "firing_rate": 113.61973616845678, "i_spike": 57.5, "isi": 0.060941526824161776}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "log_firing_rate": 1.8138173789913894, "Firing rate": 65.13544416551944, "firing_rate": 65.13544416551944, "i_spike": 71.5, "isi": 0.048828727736082586}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "log_firing_rate": 1.8726252464472632, "Firing rate": 74.58049241481478, "firing_rate": 74.58049241481478, "i_spike": 67.5, "isi": 0.0519453037270616}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "log_firing_rate": 2.0816786069674427, "Firing rate": 120.69203414788936, "firing_rate": 120.69203414788936, "i_spike": 65.0, "isi": 0.054006539264188975}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "log_firing_rate": 2.015742126764778, "Firing rate": 103.69125401769755, "firing_rate": 103.69125401769755, "i_spike": 58.5, "isi": 0.05914948407867644}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "log_firing_rate": 2.996953282377114, "Firing rate": 993.0092233802881, "firing_rate": 993.0092233802881, "i_spike": 56.0, "isi": 0.061556207729495445}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "log_firing_rate": 2.017063992289657, "Firing rate": 104.00734069551844, "firing_rate": 104.00734069551844, "i_spike": 62.0, "isi": 0.05628151104561241}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "log_firing_rate": 2.2672205346134815, "Firing rate": 185.02079155200386, "firing_rate": 185.02079155200386, "i_spike": 77.0, "isi": 0.045145515002436035}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "log_firing_rate": 1.842425884517141, "Firing rate": 69.57062172899626, "firing_rate": 69.57062172899626, "i_spike": 71.5, "isi": 0.048257564190798234}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "log_firing_rate": 2.644350530016021, "Firing rate": 440.9105899728469, "firing_rate": 440.9105899728469, "i_spike": 41.0, "isi": 0.08587837794513918}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "log_firing_rate": 1.9253171504769093, "Firing rate": 84.20098082841025, "firing_rate": 84.20098082841025, "i_spike": 52.0, "isi": 0.06651254829429913}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "log_firing_rate": 1.8262022485455212, "Firing rate": 67.01966436360541, "firing_rate": 67.01966436360541, "i_spike": 48.0, "isi": 0.07018767416878004}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "log_firing_rate": 1.9644342293091666, "Firing rate": 92.1370343436995, "firing_rate": 92.1370343436995, "i_spike": 48.0, "isi": 0.0725160406178423}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "log_firing_rate": 1.9063190608795106, "Firing rate": 80.59703418082198, "firing_rate": 80.59703418082198, "i_spike": 41.5, "isi": 0.08503224182802611}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "log_firing_rate": 1.8283878868895502, "Firing rate": 67.35779888823205, "firing_rate": 67.35779888823205, "i_spike": 62.5, "isi": 0.05493518014585742}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "log_firing_rate": 1.6768818813166184, "Firing rate": 47.52059626460304, "firing_rate": 47.52059626460304, "i_spike": 46.5, "isi": 0.07527611550032383}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "log_firing_rate": 1.77097369473317, "Firing rate": 59.01653327070108, "firing_rate": 59.01653327070108, "i_spike": 49.0, "isi": 0.06991176286179895}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "log_firing_rate": 1.8363632582176164, "Firing rate": 68.60618312542967, "firing_rate": 68.60618312542967, "i_spike": 39.0, "isi": 0.08936146993693798}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "log_firing_rate": 2.2427659364954855, "Firing rate": 174.89038608553275, "firing_rate": 174.89038608553275, "i_spike": 58.0, "isi": 0.06038746229333994}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "log_firing_rate": 2.0243545316892178, "Firing rate": 105.76805831993488, "firing_rate": 105.76805831993488, "i_spike": 48.5, "isi": 0.06889309050349131}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "log_firing_rate": 1.999444570812644, "Firing rate": 99.87218945064252, "firing_rate": 99.87218945064252, "i_spike": 60.5, "isi": 0.05694913644869976}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "log_firing_rate": 3.7606958069881298, "Firing rate": 5763.626201369603, "firing_rate": 5763.626201369603, "i_spike": 54.5, "isi": 0.06351660579329312}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "log_firing_rate": 2.2745826457842426, "Firing rate": 188.18397842828523, "firing_rate": 188.18397842828523, "i_spike": 59.5, "isi": 0.05862642483244139}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "log_firing_rate": 1.9869851692454465, "Firing rate": 97.04768257943363, "firing_rate": 97.04768257943363, "i_spike": 59.0, "isi": 0.059643084346006965}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "log_firing_rate": 2.4758238005704873, "Firing rate": 299.10508786514885, "firing_rate": 299.10508786514885, "i_spike": 56.0, "isi": 0.061380442008783544}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "log_firing_rate": 2.103966860742785, "Firing rate": 127.04771565310571, "firing_rate": 127.04771565310571, "i_spike": 62.0, "isi": 0.05590947573480207}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "log_firing_rate": 2.164512165858627, "Firing rate": 146.0535662744148, "firing_rate": 146.0535662744148, "i_spike": 60.5, "isi": 0.057751775442807365}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "log_firing_rate": 2.1971411644779986, "Firing rate": 157.4494560086051, "firing_rate": 157.4494560086051, "i_spike": 51.5, "isi": 0.06810481269650635}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "log_firing_rate": 1.996580391947181, "Firing rate": 99.21569797249656, "firing_rate": 99.21569797249656, "i_spike": 59.0, "isi": 0.0589902923871533}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "log_firing_rate": 2.1117319605861518, "Firing rate": 129.33973314939092, "firing_rate": 129.33973314939092, "i_spike": 53.0, "isi": 0.0661316692581943}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "log_firing_rate": 2.7680534260131027, "Firing rate": 586.2102744596904, "firing_rate": 586.2102744596904, "i_spike": 67.0, "isi": 0.05217799050736163}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "log_firing_rate": 1.8261985124252702, "Firing rate": 67.0190878136868, "firing_rate": 67.0190878136868, "i_spike": 66.5, "isi": 0.052316924651260456}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "log_firing_rate": 2.657509129787201, "Firing rate": 454.47409111429096, "firing_rate": 454.47409111429096, "i_spike": 58.5, "isi": 0.05904632000487943}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "log_firing_rate": 1.7525814991621775, "Firing rate": 56.569390454345175, "firing_rate": 56.569390454345175, "i_spike": 54.0, "isi": 0.06452759141944864}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "log_firing_rate": 2.164121236513587, "Firing rate": 145.9221555902302, "firing_rate": 145.9221555902302, "i_spike": 68.0, "isi": 0.05092836628361026}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "log_firing_rate": 1.937931075188755, "Firing rate": 86.6824295280791, "firing_rate": 86.6824295280791, "i_spike": 61.0, "isi": 0.056885271950897966}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "log_firing_rate": 2.306824402986719, "Firing rate": 202.6863038239062, "firing_rate": 202.6863038239062, "i_spike": 66.5, "isi": 0.05271802873012423}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "log_firing_rate": 2.7084832754650376, "Firing rate": 511.07339739315773, "firing_rate": 511.07339739315773, "i_spike": 58.0, "isi": 0.06033364089281631}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "log_firing_rate": 2.1651769419123017, "Firing rate": 146.27730216243526, "firing_rate": 146.27730216243526, "i_spike": 66.0, "isi": 0.053057677143611856}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "log_firing_rate": 1.9730800981157295, "Firing rate": 93.98966422812005, "firing_rate": 93.98966422812005, "i_spike": 72.0, "isi": 0.04825260732846218}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "log_firing_rate": 2.5196330858818268, "Firing rate": 330.8514831734401, "firing_rate": 330.8514831734401, "i_spike": 64.0, "isi": 0.05397962844907694}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>

<span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-value</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>


<span class="c1"># Transparent selectors across the chart. This is what tells us</span>
<span class="c1"># the x-value of the cursor</span>
<span class="n">selectors</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="c1">#tooltip=color,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">text</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-d93e54ca9a414dc59b57c23b2478dfd3"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-d93e54ca9a414dc59b57c23b2478dfd3") {
      outputDiv = document.getElementById("altair-viz-d93e54ca9a414dc59b57c23b2478dfd3");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04660645935147441, 0.0855822303041496], "zero": false}}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}}, "selection": {"selector002": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["neuron"], "empty": "none"}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04660645935147441, 0.0855822303041496], "zero": false}}}, "selection": {"selector003": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "text": {"condition": {"type": "quantitative", "field": "isi", "selection": "selector002"}, "value": " "}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.04660645935147441, 0.0855822303041496], "zero": false}}}}], "data": {"name": "data-f3282b1c7ea0c80c0c7e658322183f41"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-f3282b1c7ea0c80c0c7e658322183f41": [{"neuron_code": 0, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "log_firing_rate": 1.6663104244784408, "Firing rate": 46.37783001763207, "firing_rate": 46.37783001763207, "i_spike": 45.0, "isi": 0.07761089622118496}, {"neuron_code": 0, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "log_firing_rate": 2.3296751966527287, "Firing rate": 213.63637324801567, "firing_rate": 213.63637324801567, "i_spike": 46.0, "isi": 0.07572149663565791}, {"neuron_code": 0, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 0, "neuron": "0", "log_firing_rate": 1.6798976530076044, "Firing rate": 47.85173103721719, "firing_rate": 47.85173103721719, "i_spike": 43.0, "isi": 0.08057284291543804}, {"neuron_code": 0, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes0", "mouse_code": 0, "stim": 1, "neuron": "0", "log_firing_rate": 1.8533834438046997, "Firing rate": 71.3482694541228, "firing_rate": 71.3482694541228, "i_spike": 50.5, "isi": 0.06808748387992859}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "log_firing_rate": 1.95283864675475, "Firing rate": 89.7095435090419, "firing_rate": 89.7095435090419, "i_spike": 45.5, "isi": 0.07600870716647246}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "log_firing_rate": 1.6553916889439417, "Firing rate": 45.22636557805854, "firing_rate": 45.22636557805854, "i_spike": 52.0, "isi": 0.06643977669145545}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 0, "neuron": "1", "log_firing_rate": 1.9211751254895484, "Firing rate": 83.40174271279022, "firing_rate": 83.40174271279022, "i_spike": 57.0, "isi": 0.06167640695439336}, {"neuron_code": 1, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes1", "mouse_code": 0, "stim": 1, "neuron": "1", "log_firing_rate": 2.023427244674968, "Firing rate": 105.54246780408366, "firing_rate": 105.54246780408366, "i_spike": 42.0, "isi": 0.08346202817242196}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "log_firing_rate": 1.8907206756169759, "Firing rate": 77.75363035913605, "firing_rate": 77.75363035913605, "i_spike": 51.0, "isi": 0.06858902248364884}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "log_firing_rate": 1.7848938578766205, "Firing rate": 60.93879438506826, "firing_rate": 60.93879438506826, "i_spike": 45.5, "isi": 0.07737368109231504}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 0, "neuron": "2", "log_firing_rate": 1.757079286689947, "Firing rate": 57.158297782210404, "firing_rate": 57.158297782210404, "i_spike": 47.5, "isi": 0.07012546186821655}, {"neuron_code": 2, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes2", "mouse_code": 0, "stim": 1, "neuron": "2", "log_firing_rate": 1.9389765030233874, "Firing rate": 86.89134165071832, "firing_rate": 86.89134165071832, "i_spike": 50.0, "isi": 0.06762545190660336}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "log_firing_rate": 2.0273699241781147, "Firing rate": 106.5049822128941, "firing_rate": 106.5049822128941, "i_spike": 63.0, "isi": 0.05547122002155108}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "log_firing_rate": 2.1318761830741404, "Firing rate": 135.4803104264911, "firing_rate": 135.4803104264911, "i_spike": 63.0, "isi": 0.05521805676567571}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 0, "neuron": "3", "log_firing_rate": 1.7489877314760076, "Firing rate": 56.1032127032266, "firing_rate": 56.1032127032266, "i_spike": 51.0, "isi": 0.06590598174869569}, {"neuron_code": 3, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes3", "mouse_code": 0, "stim": 1, "neuron": "3", "log_firing_rate": 1.9765907352382897, "Firing rate": 94.75251260882027, "firing_rate": 94.75251260882027, "i_spike": 51.5, "isi": 0.0678738266024973}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "log_firing_rate": 1.9151662642085094, "Firing rate": 82.25574955212124, "firing_rate": 82.25574955212124, "i_spike": 55.0, "isi": 0.06314492576306131}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "log_firing_rate": 1.9897748051270372, "Firing rate": 97.67306251442677, "firing_rate": 97.67306251442677, "i_spike": 60.5, "isi": 0.05766171708401511}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 0, "neuron": "4", "log_firing_rate": 1.9451781682674214, "Firing rate": 88.14103953424245, "firing_rate": 88.14103953424245, "i_spike": 42.0, "isi": 0.08383985578407409}, {"neuron_code": 4, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes4", "mouse_code": 0, "stim": 1, "neuron": "4", "log_firing_rate": 2.016525624962679, "Firing rate": 103.87848927220108, "firing_rate": 103.87848927220108, "i_spike": 55.0, "isi": 0.062131923339563695}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "log_firing_rate": 2.058575701168154, "Firing rate": 114.43943399576757, "firing_rate": 114.43943399576757, "i_spike": 54.0, "isi": 0.06502201334947832}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "log_firing_rate": 2.2876101012894705, "Firing rate": 193.91441807971594, "firing_rate": 193.91441807971594, "i_spike": 59.5, "isi": 0.05877599461091542}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 0, "neuron": "5", "log_firing_rate": 1.9613211792016687, "Firing rate": 91.4789517045481, "firing_rate": 91.4789517045481, "i_spike": 59.5, "isi": 0.05811365621662445}, {"neuron_code": 5, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes5", "mouse_code": 0, "stim": 1, "neuron": "5", "log_firing_rate": 1.842323127624514, "Firing rate": 69.55416281565954, "firing_rate": 69.55416281565954, "i_spike": 49.5, "isi": 0.07087586502225485}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "log_firing_rate": 1.7272098813579115, "Firing rate": 53.35927023652161, "firing_rate": 53.35927023652161, "i_spike": 60.0, "isi": 0.057948856413999536}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "log_firing_rate": 2.4490963323651687, "Firing rate": 281.25246170534155, "firing_rate": 281.25246170534155, "i_spike": 71.5, "isi": 0.048817866809798154}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 0, "neuron": "6", "log_firing_rate": 2.098650876381444, "Firing rate": 125.50206634727292, "firing_rate": 125.50206634727292, "i_spike": 58.0, "isi": 0.059294404954437385}, {"neuron_code": 6, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes6", "mouse_code": 0, "stim": 1, "neuron": "6", "log_firing_rate": 2.1328011143131462, "Firing rate": 135.76915477007356, "firing_rate": 135.76915477007356, "i_spike": 76.5, "isi": 0.04539323619032486}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "log_firing_rate": 1.7991849828465982, "Firing rate": 62.977437104253134, "firing_rate": 62.977437104253134, "i_spike": 57.0, "isi": 0.061102050265639855}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 0, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "log_firing_rate": 2.032004772473387, "Firing rate": 107.64770429991358, "firing_rate": 107.64770429991358, "i_spike": 79.5, "isi": 0.04385750878503755}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 0, "neuron": "7", "log_firing_rate": 2.2331696504289473, "Firing rate": 171.06834366383765, "firing_rate": 171.06834366383765, "i_spike": 79.0, "isi": 0.04388127648811457}, {"neuron_code": 7, "mouse": "m0bayes", "i_trial": 1, "neuron_x_mouse": "m0bayes7", "mouse_code": 0, "stim": 1, "neuron": "7", "log_firing_rate": 2.0151438429723667, "Firing rate": 103.54850736083914, "firing_rate": 103.54850736083914, "i_spike": 79.5, "isi": 0.043112168184938404}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "log_firing_rate": 1.5328314600283028, "Firing rate": 34.10605279758676, "firing_rate": 34.10605279758676, "i_spike": 35.0, "isi": 0.09385192920826789}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "log_firing_rate": 2.3428177626454474, "Firing rate": 220.20022715414103, "firing_rate": 220.20022715414103, "i_spike": 43.5, "isi": 0.08099582838732101}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 0, "neuron": "0", "log_firing_rate": 1.7710993579352552, "Firing rate": 59.03361218811726, "firing_rate": 59.03361218811726, "i_spike": 38.0, "isi": 0.09248746376891379}, {"neuron_code": 8, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes0", "mouse_code": 1, "stim": 1, "neuron": "0", "log_firing_rate": 1.7138263419093873, "Firing rate": 51.73999017473991, "firing_rate": 51.73999017473991, "i_spike": 46.5, "isi": 0.07210088821690604}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "log_firing_rate": 1.9518843964429273, "Firing rate": 89.51264627823409, "firing_rate": 89.51264627823409, "i_spike": 51.0, "isi": 0.06854158489570239}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "log_firing_rate": 1.5726622298194617, "Firing rate": 37.381973890666444, "firing_rate": 37.381973890666444, "i_spike": 38.5, "isi": 0.08878199009389137}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 0, "neuron": "1", "log_firing_rate": 2.1151149670087137, "Firing rate": 130.35118001479424, "firing_rate": 130.35118001479424, "i_spike": 42.0, "isi": 0.08293449437136358}, {"neuron_code": 9, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes1", "mouse_code": 1, "stim": 1, "neuron": "1", "log_firing_rate": 1.7769834489992442, "Firing rate": 59.8388789976557, "firing_rate": 59.8388789976557, "i_spike": 55.0, "isi": 0.06344704024032452}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "log_firing_rate": 1.9554442954782552, "Firing rate": 90.24939422016051, "firing_rate": 90.24939422016051, "i_spike": 54.0, "isi": 0.06386386999344715}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "log_firing_rate": 2.034015470300679, "Firing rate": 108.14724744822499, "firing_rate": 108.14724744822499, "i_spike": 57.0, "isi": 0.05953374432919331}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 0, "neuron": "2", "log_firing_rate": 1.8895131827423814, "Firing rate": 77.53774791097574, "firing_rate": 77.53774791097574, "i_spike": 45.5, "isi": 0.07574926546915904}, {"neuron_code": 10, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes2", "mouse_code": 1, "stim": 1, "neuron": "2", "log_firing_rate": 2.057401176073664, "Firing rate": 114.13035708709339, "firing_rate": 114.13035708709339, "i_spike": 41.5, "isi": 0.07938245630234265}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "log_firing_rate": 2.205339174756203, "Firing rate": 160.44979803105144, "firing_rate": 160.44979803105144, "i_spike": 45.5, "isi": 0.07428580463062659}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "log_firing_rate": 2.228425379510321, "Firing rate": 169.20974832222979, "firing_rate": 169.20974832222979, "i_spike": 55.5, "isi": 0.06178075458328285}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 0, "neuron": "3", "log_firing_rate": 2.172529464261199, "Firing rate": 148.77483054050091, "firing_rate": 148.77483054050091, "i_spike": 66.0, "isi": 0.0534201522756555}, {"neuron_code": 11, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes3", "mouse_code": 1, "stim": 1, "neuron": "3", "log_firing_rate": 1.7277225245329388, "Firing rate": 53.42229294980848, "firing_rate": 53.42229294980848, "i_spike": 52.0, "isi": 0.06744456065788194}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "log_firing_rate": 2.474489164127447, "Firing rate": 298.1873147715974, "firing_rate": 298.1873147715974, "i_spike": 54.0, "isi": 0.0638143535907843}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "log_firing_rate": 1.683760616834297, "Firing rate": 48.27926133438604, "firing_rate": 48.27926133438604, "i_spike": 61.5, "isi": 0.05660051544322663}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 0, "neuron": "4", "log_firing_rate": 2.0128325079526745, "Firing rate": 102.99888135150388, "firing_rate": 102.99888135150388, "i_spike": 60.0, "isi": 0.05851082443679985}, {"neuron_code": 12, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes4", "mouse_code": 1, "stim": 1, "neuron": "4", "log_firing_rate": 1.9089847062563394, "Firing rate": 81.09325002444842, "firing_rate": 81.09325002444842, "i_spike": 54.5, "isi": 0.06305256698133047}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "log_firing_rate": 1.9949730756329487, "Firing rate": 98.84918105687149, "firing_rate": 98.84918105687149, "i_spike": 62.5, "isi": 0.05481030225471106}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "log_firing_rate": 2.249972938792012, "Firing rate": 177.8168607595556, "firing_rate": 177.8168607595556, "i_spike": 74.5, "isi": 0.04656315207551359}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 0, "neuron": "5", "log_firing_rate": 2.250890507198533, "Firing rate": 178.1929457006692, "firing_rate": 178.1929457006692, "i_spike": 67.0, "isi": 0.05215361370277925}, {"neuron_code": 13, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes5", "mouse_code": 1, "stim": 1, "neuron": "5", "log_firing_rate": 2.2338076320645133, "Firing rate": 171.31982893036775, "firing_rate": 171.31982893036775, "i_spike": 66.5, "isi": 0.052037588617104724}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "log_firing_rate": 1.9985371385507964, "Firing rate": 99.6637303604343, "firing_rate": 99.6637303604343, "i_spike": 68.5, "isi": 0.050117994048944646}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "log_firing_rate": 1.923969740891794, "Firing rate": 83.9401499877872, "firing_rate": 83.9401499877872, "i_spike": 60.5, "isi": 0.05736421749293488}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 0, "neuron": "6", "log_firing_rate": 2.0694780133159973, "Firing rate": 117.34862718240316, "firing_rate": 117.34862718240316, "i_spike": 69.0, "isi": 0.050429337267269475}, {"neuron_code": 14, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes6", "mouse_code": 1, "stim": 1, "neuron": "6", "log_firing_rate": 2.0787857603605824, "Firing rate": 119.8907730070552, "firing_rate": 119.8907730070552, "i_spike": 57.5, "isi": 0.06061336828836388}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "log_firing_rate": 2.340949772955236, "Firing rate": 219.25513476406528, "firing_rate": 219.25513476406528, "i_spike": 75.0, "isi": 0.04668688714968735}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 0, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "log_firing_rate": 1.886001899841315, "Firing rate": 76.9133804890684, "firing_rate": 76.9133804890684, "i_spike": 80.0, "isi": 0.04301990361527198}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 0, "neuron": "7", "log_firing_rate": 1.8873284683570808, "Firing rate": 77.14867442110095, "firing_rate": 77.14867442110095, "i_spike": 61.5, "isi": 0.0571677961802205}, {"neuron_code": 15, "mouse": "m1bayes", "i_trial": 1, "neuron_x_mouse": "m1bayes7", "mouse_code": 1, "stim": 1, "neuron": "7", "log_firing_rate": 2.3331277521308906, "Firing rate": 215.3415090476531, "firing_rate": 215.3415090476531, "i_spike": 63.5, "isi": 0.05498477369722001}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "log_firing_rate": 2.2117777223982293, "Firing rate": 162.8462350961711, "firing_rate": 162.8462350961711, "i_spike": 49.0, "isi": 0.06950931431928385}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "log_firing_rate": 2.432711401038399, "Firing rate": 270.839124367633, "firing_rate": 270.839124367633, "i_spike": 47.0, "isi": 0.07524105490556886}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 0, "neuron": "0", "log_firing_rate": 2.296301302981331, "Firing rate": 197.8341689605457, "firing_rate": 197.8341689605457, "i_spike": 43.5, "isi": 0.07946439581093698}, {"neuron_code": 16, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes0", "mouse_code": 2, "stim": 1, "neuron": "0", "log_firing_rate": 1.4582747118939854, "Firing rate": 28.72597061583477, "firing_rate": 28.72597061583477, "i_spike": 30.0, "isi": 0.11790665860168363}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "log_firing_rate": 2.7349033052104152, "Firing rate": 543.1293913669488, "firing_rate": 543.1293913669488, "i_spike": 45.5, "isi": 0.07429446119475647}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "log_firing_rate": 2.198359914549782, "Firing rate": 157.8919231504682, "firing_rate": 157.8919231504682, "i_spike": 50.0, "isi": 0.06783414486987437}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 0, "neuron": "1", "log_firing_rate": 2.0729452144123144, "Firing rate": 118.28923262468051, "firing_rate": 118.28923262468051, "i_spike": 44.0, "isi": 0.07822630138492363}, {"neuron_code": 17, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes1", "mouse_code": 2, "stim": 1, "neuron": "1", "log_firing_rate": 3.021431391889098, "Firing rate": 1050.5854744504222, "firing_rate": 1050.5854744504222, "i_spike": 56.5, "isi": 0.0620282066205294}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "log_firing_rate": 2.542446675860244, "Firing rate": 348.69576746549535, "firing_rate": 348.69576746549535, "i_spike": 54.5, "isi": 0.06417670966209792}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "log_firing_rate": 2.4151814759517953, "Firing rate": 260.1246302815211, "firing_rate": 260.1246302815211, "i_spike": 42.5, "isi": 0.08115314408945787}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 0, "neuron": "2", "log_firing_rate": 1.9013106817627226, "Firing rate": 79.67291036518716, "firing_rate": 79.67291036518716, "i_spike": 49.0, "isi": 0.07122829168206773}, {"neuron_code": 18, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes2", "mouse_code": 2, "stim": 1, "neuron": "2", "log_firing_rate": 1.6840043519687717, "Firing rate": 48.30636426892448, "firing_rate": 48.30636426892448, "i_spike": 34.0, "isi": 0.10091078868309482}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "log_firing_rate": 1.9203217698905402, "Firing rate": 83.23802553536271, "firing_rate": 83.23802553536271, "i_spike": 56.5, "isi": 0.06239586418875065}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "log_firing_rate": 1.8599472404040152, "Firing rate": 72.43479584340517, "firing_rate": 72.43479584340517, "i_spike": 57.5, "isi": 0.06095784676633729}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 0, "neuron": "3", "log_firing_rate": 2.3549667845159146, "Firing rate": 226.44711108713676, "firing_rate": 226.44711108713676, "i_spike": 55.5, "isi": 0.0634775733424374}, {"neuron_code": 19, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes3", "mouse_code": 2, "stim": 1, "neuron": "3", "log_firing_rate": 2.2031671325546944, "Firing rate": 159.6493418656382, "firing_rate": 159.6493418656382, "i_spike": 45.5, "isi": 0.07683236236320062}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "log_firing_rate": 2.051708238245999, "Firing rate": 112.64404521705198, "firing_rate": 112.64404521705198, "i_spike": 56.5, "isi": 0.06204892241541356}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "log_firing_rate": 2.0817302771779094, "Firing rate": 120.70639434369137, "firing_rate": 120.70639434369137, "i_spike": 60.0, "isi": 0.057730017623095486}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 0, "neuron": "4", "log_firing_rate": 1.7288216905290155, "Firing rate": 53.55767191704656, "firing_rate": 53.55767191704656, "i_spike": 52.5, "isi": 0.06529397899860677}, {"neuron_code": 20, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes4", "mouse_code": 2, "stim": 1, "neuron": "4", "log_firing_rate": 2.2989673736802296, "Firing rate": 199.05237955136556, "firing_rate": 199.05237955136556, "i_spike": 53.0, "isi": 0.06638041530731198}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "log_firing_rate": 1.8575926145045647, "Firing rate": 72.04313688485489, "firing_rate": 72.04313688485489, "i_spike": 54.0, "isi": 0.06301462369400955}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "log_firing_rate": 1.9495797481313146, "Firing rate": 89.03889223202201, "firing_rate": 89.03889223202201, "i_spike": 62.0, "isi": 0.05657984089078366}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 0, "neuron": "5", "log_firing_rate": 2.514263236435292, "Firing rate": 326.78584499496236, "firing_rate": 326.78584499496236, "i_spike": 67.5, "isi": 0.05160482782687694}, {"neuron_code": 21, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes5", "mouse_code": 2, "stim": 1, "neuron": "5", "log_firing_rate": 2.055453776485718, "Firing rate": 113.61973616845678, "firing_rate": 113.61973616845678, "i_spike": 57.5, "isi": 0.060941526824161776}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "log_firing_rate": 1.8138173789913894, "Firing rate": 65.13544416551944, "firing_rate": 65.13544416551944, "i_spike": 71.5, "isi": 0.048828727736082586}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "log_firing_rate": 1.8726252464472632, "Firing rate": 74.58049241481478, "firing_rate": 74.58049241481478, "i_spike": 67.5, "isi": 0.0519453037270616}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 0, "neuron": "6", "log_firing_rate": 2.0816786069674427, "Firing rate": 120.69203414788936, "firing_rate": 120.69203414788936, "i_spike": 65.0, "isi": 0.054006539264188975}, {"neuron_code": 22, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes6", "mouse_code": 2, "stim": 1, "neuron": "6", "log_firing_rate": 2.015742126764778, "Firing rate": 103.69125401769755, "firing_rate": 103.69125401769755, "i_spike": 58.5, "isi": 0.05914948407867644}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "log_firing_rate": 2.996953282377114, "Firing rate": 993.0092233802881, "firing_rate": 993.0092233802881, "i_spike": 56.0, "isi": 0.061556207729495445}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 0, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "log_firing_rate": 2.017063992289657, "Firing rate": 104.00734069551844, "firing_rate": 104.00734069551844, "i_spike": 62.0, "isi": 0.05628151104561241}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 0, "neuron": "7", "log_firing_rate": 2.2672205346134815, "Firing rate": 185.02079155200386, "firing_rate": 185.02079155200386, "i_spike": 77.0, "isi": 0.045145515002436035}, {"neuron_code": 23, "mouse": "m2bayes", "i_trial": 1, "neuron_x_mouse": "m2bayes7", "mouse_code": 2, "stim": 1, "neuron": "7", "log_firing_rate": 1.842425884517141, "Firing rate": 69.57062172899626, "firing_rate": 69.57062172899626, "i_spike": 71.5, "isi": 0.048257564190798234}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "log_firing_rate": 2.644350530016021, "Firing rate": 440.9105899728469, "firing_rate": 440.9105899728469, "i_spike": 41.0, "isi": 0.08587837794513918}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "log_firing_rate": 1.9253171504769093, "Firing rate": 84.20098082841025, "firing_rate": 84.20098082841025, "i_spike": 52.0, "isi": 0.06651254829429913}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 0, "neuron": "0", "log_firing_rate": 1.8262022485455212, "Firing rate": 67.01966436360541, "firing_rate": 67.01966436360541, "i_spike": 48.0, "isi": 0.07018767416878004}, {"neuron_code": 24, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes0", "mouse_code": 3, "stim": 1, "neuron": "0", "log_firing_rate": 1.9644342293091666, "Firing rate": 92.1370343436995, "firing_rate": 92.1370343436995, "i_spike": 48.0, "isi": 0.0725160406178423}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "log_firing_rate": 1.9063190608795106, "Firing rate": 80.59703418082198, "firing_rate": 80.59703418082198, "i_spike": 41.5, "isi": 0.08503224182802611}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "log_firing_rate": 1.8283878868895502, "Firing rate": 67.35779888823205, "firing_rate": 67.35779888823205, "i_spike": 62.5, "isi": 0.05493518014585742}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 0, "neuron": "1", "log_firing_rate": 1.6768818813166184, "Firing rate": 47.52059626460304, "firing_rate": 47.52059626460304, "i_spike": 46.5, "isi": 0.07527611550032383}, {"neuron_code": 25, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes1", "mouse_code": 3, "stim": 1, "neuron": "1", "log_firing_rate": 1.77097369473317, "Firing rate": 59.01653327070108, "firing_rate": 59.01653327070108, "i_spike": 49.0, "isi": 0.06991176286179895}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "log_firing_rate": 1.8363632582176164, "Firing rate": 68.60618312542967, "firing_rate": 68.60618312542967, "i_spike": 39.0, "isi": 0.08936146993693798}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "log_firing_rate": 2.2427659364954855, "Firing rate": 174.89038608553275, "firing_rate": 174.89038608553275, "i_spike": 58.0, "isi": 0.06038746229333994}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 0, "neuron": "2", "log_firing_rate": 2.0243545316892178, "Firing rate": 105.76805831993488, "firing_rate": 105.76805831993488, "i_spike": 48.5, "isi": 0.06889309050349131}, {"neuron_code": 26, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes2", "mouse_code": 3, "stim": 1, "neuron": "2", "log_firing_rate": 1.999444570812644, "Firing rate": 99.87218945064252, "firing_rate": 99.87218945064252, "i_spike": 60.5, "isi": 0.05694913644869976}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "log_firing_rate": 3.7606958069881298, "Firing rate": 5763.626201369603, "firing_rate": 5763.626201369603, "i_spike": 54.5, "isi": 0.06351660579329312}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "log_firing_rate": 2.2745826457842426, "Firing rate": 188.18397842828523, "firing_rate": 188.18397842828523, "i_spike": 59.5, "isi": 0.05862642483244139}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 0, "neuron": "3", "log_firing_rate": 1.9869851692454465, "Firing rate": 97.04768257943363, "firing_rate": 97.04768257943363, "i_spike": 59.0, "isi": 0.059643084346006965}, {"neuron_code": 27, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes3", "mouse_code": 3, "stim": 1, "neuron": "3", "log_firing_rate": 2.4758238005704873, "Firing rate": 299.10508786514885, "firing_rate": 299.10508786514885, "i_spike": 56.0, "isi": 0.061380442008783544}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "log_firing_rate": 2.103966860742785, "Firing rate": 127.04771565310571, "firing_rate": 127.04771565310571, "i_spike": 62.0, "isi": 0.05590947573480207}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "log_firing_rate": 2.164512165858627, "Firing rate": 146.0535662744148, "firing_rate": 146.0535662744148, "i_spike": 60.5, "isi": 0.057751775442807365}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 0, "neuron": "4", "log_firing_rate": 2.1971411644779986, "Firing rate": 157.4494560086051, "firing_rate": 157.4494560086051, "i_spike": 51.5, "isi": 0.06810481269650635}, {"neuron_code": 28, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes4", "mouse_code": 3, "stim": 1, "neuron": "4", "log_firing_rate": 1.996580391947181, "Firing rate": 99.21569797249656, "firing_rate": 99.21569797249656, "i_spike": 59.0, "isi": 0.0589902923871533}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "log_firing_rate": 2.1117319605861518, "Firing rate": 129.33973314939092, "firing_rate": 129.33973314939092, "i_spike": 53.0, "isi": 0.0661316692581943}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "log_firing_rate": 2.7680534260131027, "Firing rate": 586.2102744596904, "firing_rate": 586.2102744596904, "i_spike": 67.0, "isi": 0.05217799050736163}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 0, "neuron": "5", "log_firing_rate": 1.8261985124252702, "Firing rate": 67.0190878136868, "firing_rate": 67.0190878136868, "i_spike": 66.5, "isi": 0.052316924651260456}, {"neuron_code": 29, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes5", "mouse_code": 3, "stim": 1, "neuron": "5", "log_firing_rate": 2.657509129787201, "Firing rate": 454.47409111429096, "firing_rate": 454.47409111429096, "i_spike": 58.5, "isi": 0.05904632000487943}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "log_firing_rate": 1.7525814991621775, "Firing rate": 56.569390454345175, "firing_rate": 56.569390454345175, "i_spike": 54.0, "isi": 0.06452759141944864}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "log_firing_rate": 2.164121236513587, "Firing rate": 145.9221555902302, "firing_rate": 145.9221555902302, "i_spike": 68.0, "isi": 0.05092836628361026}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 0, "neuron": "6", "log_firing_rate": 1.937931075188755, "Firing rate": 86.6824295280791, "firing_rate": 86.6824295280791, "i_spike": 61.0, "isi": 0.056885271950897966}, {"neuron_code": 30, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes6", "mouse_code": 3, "stim": 1, "neuron": "6", "log_firing_rate": 2.306824402986719, "Firing rate": 202.6863038239062, "firing_rate": 202.6863038239062, "i_spike": 66.5, "isi": 0.05271802873012423}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "log_firing_rate": 2.7084832754650376, "Firing rate": 511.07339739315773, "firing_rate": 511.07339739315773, "i_spike": 58.0, "isi": 0.06033364089281631}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 0, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "log_firing_rate": 2.1651769419123017, "Firing rate": 146.27730216243526, "firing_rate": 146.27730216243526, "i_spike": 66.0, "isi": 0.053057677143611856}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 0, "neuron": "7", "log_firing_rate": 1.9730800981157295, "Firing rate": 93.98966422812005, "firing_rate": 93.98966422812005, "i_spike": 72.0, "isi": 0.04825260732846218}, {"neuron_code": 31, "mouse": "m3bayes", "i_trial": 1, "neuron_x_mouse": "m3bayes7", "mouse_code": 3, "stim": 1, "neuron": "7", "log_firing_rate": 2.5196330858818268, "Firing rate": 330.8514831734401, "firing_rate": 330.8514831734401, "i_spike": 64.0, "isi": 0.05397962844907694}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./neurons_example"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="model_comparison.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Compare to alternative models</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Max Myroshnychenko<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>