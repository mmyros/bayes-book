
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neurons example via low-level, flexible interface &#8212; Bayes Window examples</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Compare to alternative models" href="model_comparison.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Bayes Window examples</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/metropolis.html">
   Intuition for maximal likelihood or posterior inference
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../radon_example/radon.html">
   Radon example from Gelman and Hill (2006)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_lfp.html">
   Multilevel modeling of LFP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../motivation/multilevel_modeling_neurons.html">
   Bayesian Methods for Multilevel Modeling of Neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/quick_lfp.html">
   LFP example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_stim_strength.html">
   LFP example with stim strength
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lfp_example/lfp_roc.html">
   Compare to ANOVA and LMM: ROC curve
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Neurons example, pt. 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="posteriors.html">
   Neurons example, no slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_strength.html">
   Neurons example with nominal stim strengths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stim_type.html">
   Neurons example with stim types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lme.html">
   Linear mixed effects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="monster.html">
   Neurons example, pt. 2: large datasets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_comparison.html">
   Compare to alternative models
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Neurons example via low-level, flexible interface
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/mmyros/bayes-window"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/mmyros/bayes-window/issues/new?title=Issue%20on%20page%20%2Fneurons_example/detailed_workflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mmyros/bayes-window/master?urlpath=tree/neurons_example/detailed_workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare">
   Prepare
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-some-data">
   Make some data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#estimate-model">
   Estimate model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-data-back">
   Add data back
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix-elements-of-interactivity-wip">
   Appendix: Elements of interactivity (WIP)
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="neurons-example-via-low-level-flexible-interface">
<h1>Neurons example via low-level, flexible interface<a class="headerlink" href="#neurons-example-via-low-level-flexible-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prepare">
<h2>Prepare<a class="headerlink" href="#prepare" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">bayes_window.fitting</span> <span class="kn">import</span> <span class="n">fit_numpyro</span>
<span class="kn">from</span> <span class="nn">bayes_window.generative_models</span> <span class="kn">import</span> <span class="n">generate_fake_spikes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="n">trans</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/optimizers.py:30: FutureWarning: jax.experimental.optimizers is deprecated, import jax.example_libraries.optimizers instead
  FutureWarning)
/opt/hostedtoolcache/Python/3.7.12/x64/lib/python3.7/site-packages/jax/experimental/stax.py:30: FutureWarning: jax.experimental.stax is deprecated, import jax.example_libraries.stax instead
  FutureWarning)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-data">
<h2>Make some data<a class="headerlink" href="#make-some-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">,</span> <span class="n">df_monster</span><span class="p">,</span> <span class="n">index_cols</span><span class="p">,</span> <span class="n">firing_rates</span> <span class="o">=</span> <span class="n">generate_fake_spikes</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                                <span class="n">n_neurons</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                                                                <span class="n">n_mice</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                                                <span class="n">dur</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="p">)</span>


<span class="c1"># df[&#39;log_isi&#39;] = np.log10(df[&#39;isi&#39;])</span>

<span class="kn">from</span> <span class="nn">bayes_window</span> <span class="kn">import</span> <span class="n">visualization</span><span class="p">,</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="kn">import</span> <span class="n">reload</span>

<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;isi&#39;</span>
<span class="n">ddf</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_fold_change</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                                 <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                 <span class="n">index_cols</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;neuron&#39;</span><span class="p">),</span>
                                 <span class="n">treatment_name</span><span class="o">=</span><span class="s1">&#39;stim&#39;</span><span class="p">,</span>
                                 <span class="n">do_take_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">plot_data</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span>  <span class="n">df</span><span class="o">=</span><span class="n">ddf</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-9a8df81058214c718b89991912f89b84"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-9a8df81058214c718b89991912f89b84") {
      outputDiv = document.getElementById("altair-viz-9a8df81058214c718b89991912f89b84");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.8}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "size": {"value": 1.0}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right"}, "field": "isi diff", "scale": {"domain": [0.7359280159895206, 1.112683414650557], "zero": false}, "title": "isi diff"}}}, {"mark": {"type": "circle", "clip": true, "filled": true, "opacity": 0}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "detail": {"type": "ordinal", "field": ""}, "x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7359280159895206, 1.112683414650557], "zero": false}}}}, {"mark": {"type": "boxplot", "clip": true, "color": "black", "median": {"color": "red", "strokeWidth": 20}, "opacity": 0.3, "size": 9}, "encoding": {"x": {"type": "ordinal", "field": "neuron"}, "y": {"type": "quantitative", "axis": {"orient": "right", "title": ""}, "field": "isi diff", "scale": {"domain": [0.7359280159895206, 1.112683414650557], "zero": false}}}}], "data": {"name": "data-b3992593f1730cd6266a8e87ef78cafc"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-b3992593f1730cd6266a8e87ef78cafc": [{"mouse": "m0bayes", "neuron": "0", "isi diff": 1.1083098527029993}, {"mouse": "m0bayes", "neuron": "1", "isi diff": 0.9429882413765125}, {"mouse": "m0bayes", "neuron": "2", "isi diff": 1.004321325183471}, {"mouse": "m0bayes", "neuron": "3", "isi diff": 0.9836581318362161}, {"mouse": "m0bayes", "neuron": "4", "isi diff": 1.1180288792531277}, {"mouse": "m0bayes", "neuron": "5", "isi diff": 1.0199042760996657}, {"mouse": "m0bayes", "neuron": "6", "isi diff": 0.9272996509107767}, {"mouse": "m0bayes", "neuron": "7", "isi diff": 1.081168149278934}, {"mouse": "m1bayes", "neuron": "0", "isi diff": 0.6799685951083962}, {"mouse": "m1bayes", "neuron": "1", "isi diff": 0.9062620367202598}, {"mouse": "m1bayes", "neuron": "2", "isi diff": 0.7140358935875226}, {"mouse": "m1bayes", "neuron": "3", "isi diff": 1.068857492739983}, {"mouse": "m1bayes", "neuron": "4", "isi diff": 1.2216217091879693}, {"mouse": "m1bayes", "neuron": "5", "isi diff": 1.0855961303516983}, {"mouse": "m1bayes", "neuron": "6", "isi diff": 0.791349167178969}, {"mouse": "m1bayes", "neuron": "7", "isi diff": 0.9976367896636509}, {"mouse": "m2bayes", "neuron": "0", "isi diff": 1.003869475754238}, {"mouse": "m2bayes", "neuron": "1", "isi diff": 0.8038322113559759}, {"mouse": "m2bayes", "neuron": "2", "isi diff": 0.8712281103823569}, {"mouse": "m2bayes", "neuron": "3", "isi diff": 0.7896256875776511}, {"mouse": "m2bayes", "neuron": "4", "isi diff": 1.0673411144967369}, {"mouse": "m2bayes", "neuron": "5", "isi diff": 1.033708419948547}, {"mouse": "m2bayes", "neuron": "6", "isi diff": 1.0226445619545492}, {"mouse": "m2bayes", "neuron": "7", "isi diff": 0.8406267247754565}, {"mouse": "m3bayes", "neuron": "0", "isi diff": 0.7928962162947282}, {"mouse": "m3bayes", "neuron": "1", "isi diff": 0.7538397525002463}, {"mouse": "m3bayes", "neuron": "2", "isi diff": 0.9953044619128306}, {"mouse": "m3bayes", "neuron": "3", "isi diff": 0.7922892127216618}, {"mouse": "m3bayes", "neuron": "4", "isi diff": 1.0526665060342733}, {"mouse": "m3bayes", "neuron": "5", "isi diff": 1.0386774202364508}, {"mouse": "m3bayes", "neuron": "6", "isi diff": 1.0503001511713776}, {"mouse": "m3bayes", "neuron": "7", "isi diff": 0.8881686026074214}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<p>TODO leave axis labels here somehow</p>
</div>
<div class="section" id="estimate-model">
<h2>Estimate model<a class="headerlink" href="#estimate-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># y = list(set(df.columns) - set(index_cols))[0]</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">fit_numpyro</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">treatment</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;stim&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="n">condition</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;neuron&#39;</span><span class="p">]),</span>
                    <span class="n">group</span><span class="o">=</span><span class="n">trans</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">]),</span>
                    <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">model_hierarchical</span><span class="p">,</span>
                    <span class="n">n_draws</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-data-back">
<h2>Add data back<a class="headerlink" href="#add-data-back" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload(utils)</span>
<span class="c1"># df_both, trace = utils.add_data_to_posterior(df, posterior=trace.posterior, y=y,</span>
<span class="c1">#                                              fold_change_index_cols=[&#39;neuron&#39;, &#39;stim&#39;, &#39;mouse_code&#39;, ],</span>
<span class="c1">#                                              treatment_name=&#39;stim&#39;, b_name=&#39;slope_per_condition&#39;,</span>
<span class="c1">#                                              posterior_index_name=&#39;neuron&#39;, group_name=&#39;mouse&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + [markdown] hideCode=false hidePrompt=false</span>
<span class="c1"># # ## Plot data and posterior</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># # BayesWindow.lot(df_both, y=f&#39;{y} diff&#39;, x=&#39;neuron&#39;,color=&#39;mouse_code&#39;,title=y,hold_for_facet=False,add_box=False)</span>
<span class="c1"># reload(visualization)</span>
<span class="c1">#</span>
<span class="c1"># chart_d, _ = visualization.plot_data(df=df_both, x=&#39;neuron&#39;, y=f&#39;{y} diff&#39;, color=&#39;mouse_code&#39;, highlight=False)</span>
<span class="c1"># chart_d</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># chart_p = visualization.plot_posterior(df=df_both, title=f&#39;d_{y}&#39;, x=&#39;neuron&#39;, )</span>
<span class="c1"># chart_p</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).resolve_scale(y=&#39;independent&#39;)</span>
<span class="c1">#</span>
<span class="c1"># + hideCode=false hidePrompt=false</span>
<span class="c1"># (chart_d + chart_p).facet(column=&#39;neuron&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="appendix-elements-of-interactivity-wip">
<h2>Appendix: Elements of interactivity (WIP)<a class="headerlink" href="#appendix-elements-of-interactivity-wip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="c1">#axis=alt.Axis(labels=False, tickCount=0, title=&#39;&#39;)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">lines</span><span class="o">+</span><span class="n">points</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-96866b0a119f452aa776694ee983c4e6"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-96866b0a119f452aa776694ee983c4e6") {
      outputDiv = document.getElementById("altair-viz-96866b0a119f452aa776694ee983c4e6");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector001"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.0488001063317953, 0.09315299387158013], "zero": false}}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.0488001063317953, 0.09315299387158013], "zero": false}}}, "selection": {"selector001": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}], "data": {"name": "data-018b7f0fa625fab2206ad57d0e1fb720"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-018b7f0fa625fab2206ad57d0e1fb720": [{"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.0287791467103675, "Firing rate": 106.8511367220051, "firing_rate": 106.8511367220051, "i_spike": 35.5, "isi": 0.09586702735617403}, {"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.888152219431406, "Firing rate": 77.2951455712081, "firing_rate": 77.2951455712081, "i_spike": 49.0, "isi": 0.06938830963190289}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7804951357126013, "Firing rate": 60.32469512601141, "firing_rate": 60.32469512601141, "i_spike": 43.5, "isi": 0.08027488807176461}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9807968320311549, "Firing rate": 95.6746389589182, "firing_rate": 95.6746389589182, "i_spike": 49.0, "isi": 0.07072458751282588}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.60389434521973, "Firing rate": 40.1693075422204, "firing_rate": 40.1693075422204, "i_spike": 45.5, "isi": 0.07494942910840988}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.830949171434896, "Firing rate": 677.5622030571651, "firing_rate": 677.5622030571651, "i_spike": 55.5, "isi": 0.06205554292242925}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.057399150827541, "Firing rate": 114.12982486406511, "firing_rate": 114.12982486406511, "i_spike": 56.5, "isi": 0.06137686548636755}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7597313816613502, "Firing rate": 57.50841282420635, "firing_rate": 57.50841282420635, "i_spike": 50.5, "isi": 0.06971393083938743}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.961154345613815, "Firing rate": 91.44381694841965, "firing_rate": 91.44381694841965, "i_spike": 61.5, "isi": 0.05669616737410285}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.124418010434087, "Firing rate": 133.1735602942126, "firing_rate": 133.1735602942126, "i_spike": 55.5, "isi": 0.06300452779703669}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.8424706312651455, "Firing rate": 69.5777901817132, "firing_rate": 69.5777901817132, "i_spike": 65.0, "isi": 0.05328715846797061}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.650245980556241, "Firing rate": 446.93666145109546, "firing_rate": 446.93666145109546, "i_spike": 67.5, "isi": 0.05215666504979185}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7669577564445893, "Firing rate": 58.47332047413593, "firing_rate": 58.47332047413593, "i_spike": 60.0, "isi": 0.05860534479679852}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9742323339388193, "Firing rate": 94.23936127464658, "firing_rate": 94.23936127464658, "i_spike": 56.0, "isi": 0.06122745127201878}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.2332208452626587, "Firing rate": 171.088510467654, "firing_rate": 171.088510467654, "i_spike": 82.5, "isi": 0.04171026408252973}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.658807011827811, "Firing rate": 455.8343110762482, "firing_rate": 455.8343110762482, "i_spike": 63.0, "isi": 0.055685604529106696}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.2932095061384805, "Firing rate": 196.43076415357413, "firing_rate": 196.43076415357413, "i_spike": 37.5, "isi": 0.09197668224040262}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.5800073582133565, "Firing rate": 38.01958378907624, "firing_rate": 38.01958378907624, "i_spike": 33.0, "isi": 0.10656850120716019}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.1331384665735245, "Firing rate": 135.87465881599363, "firing_rate": 135.87465881599363, "i_spike": 42.5, "isi": 0.08168825883317743}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.675758863154722, "Firing rate": 47.39787411272408, "firing_rate": 47.39787411272408, "i_spike": 39.5, "isi": 0.08452875398139272}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.6045312670964003, "Firing rate": 40.22826173535397, "firing_rate": 40.22826173535397, "i_spike": 39.0, "isi": 0.08877407748429665}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.7253590842157345, "Firing rate": 53.13235726644105, "firing_rate": 53.13235726644105, "i_spike": 40.5, "isi": 0.08536828748745495}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8819039004811342, "Firing rate": 76.1910397880472, "firing_rate": 76.1910397880472, "i_spike": 52.5, "isi": 0.0657398448300991}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0687903157451126, "Firing rate": 117.16295476625199, "firing_rate": 117.16295476625199, "i_spike": 62.0, "isi": 0.055063596747366876}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.1592924543847727, "Firing rate": 144.30868006494063, "firing_rate": 144.30868006494063, "i_spike": 59.5, "isi": 0.058283462378306936}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8195318559134468, "Firing rate": 65.99816427695586, "firing_rate": 65.99816427695586, "i_spike": 63.0, "isi": 0.0547575790750348}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0784478508685664, "Firing rate": 119.79752643037288, "firing_rate": 119.79752643037288, "i_spike": 66.0, "isi": 0.052535821871554304}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8474834697525035, "Firing rate": 70.38554370687628, "firing_rate": 70.38554370687628, "i_spike": 59.5, "isi": 0.05902297278434249}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.097996053455225, "Firing rate": 125.3129787379539, "firing_rate": 125.3129787379539, "i_spike": 61.0, "isi": 0.05752914070485048}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.793100142046089, "Firing rate": 62.101221418496365, "firing_rate": 62.101221418496365, "i_spike": 52.5, "isi": 0.06668991264317461}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.198136440526753, "Firing rate": 157.81069792634494, "firing_rate": 157.81069792634494, "i_spike": 69.5, "isi": 0.05008933968337417}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.325845701413527, "Firing rate": 211.76086456706952, "firing_rate": 211.76086456706952, "i_spike": 78.0, "isi": 0.044760916232476834}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.6188027215370822, "Firing rate": 41.57217258166482, "firing_rate": 41.57217258166482, "i_spike": 37.5, "isi": 0.09094753085532499}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.9229488338247642, "Firing rate": 83.7430614868749, "firing_rate": 83.7430614868749, "i_spike": 47.0, "isi": 0.07320875598463418}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.166441678683907, "Firing rate": 146.70390653065934, "firing_rate": 146.70390653065934, "i_spike": 47.5, "isi": 0.07420159334452443}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.1989229218427893, "Firing rate": 158.09674258268916, "firing_rate": 158.09674258268916, "i_spike": 45.5, "isi": 0.07689298829895631}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8337183167891113, "Firing rate": 68.18962730558536, "firing_rate": 68.18962730558536, "i_spike": 46.5, "isi": 0.07325868376103088}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.6048398668106683, "Firing rate": 402.5685717541662, "firing_rate": 402.5685717541662, "i_spike": 59.0, "isi": 0.059308461551573516}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8360911682429826, "Firing rate": 68.56321410538973, "firing_rate": 68.56321410538973, "i_spike": 42.5, "isi": 0.08277939856764525}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0843524257626793, "Firing rate": 121.43739033827886, "firing_rate": 121.43739033827886, "i_spike": 54.5, "isi": 0.06448725237318}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.1383182085567958, "Firing rate": 137.50491076186384, "firing_rate": 137.50491076186384, "i_spike": 59.5, "isi": 0.05606900613784995}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.3169420465960355, "Firing rate": 207.46366539820582, "firing_rate": 207.46366539820582, "i_spike": 50.5, "isi": 0.06963848790908173}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.306983891741586, "Firing rate": 202.76075128749613, "firing_rate": 202.76075128749613, "i_spike": 59.5, "isi": 0.05897462692736115}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.272416349963913, "Firing rate": 187.2476388121454, "firing_rate": 187.2476388121454, "i_spike": 64.5, "isi": 0.05429080743408067}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.082481778213417, "Firing rate": 120.91544491267233, "firing_rate": 120.91544491267233, "i_spike": 77.0, "isi": 0.04529665695748603}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.766243783294815, "Firing rate": 58.37727024900301, "firing_rate": 58.37727024900301, "i_spike": 64.0, "isi": 0.05422059902037592}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8717357314532728, "Firing rate": 74.42789417411862, "firing_rate": 74.42789417411862, "i_spike": 60.5, "isi": 0.0578192591207897}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.2747248667398425, "Firing rate": 188.24561422857306, "firing_rate": 188.24561422857306, "i_spike": 60.0, "isi": 0.0583351686678796}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.6369861396612275, "Firing rate": 43.349704327792885, "firing_rate": 43.349704327792885, "i_spike": 36.5, "isi": 0.09323911113703558}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.8611287387861641, "Firing rate": 72.63212303888466, "firing_rate": 72.63212303888466, "i_spike": 36.5, "isi": 0.09430845100920474}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.649570954462079, "Firing rate": 44.62425251432948, "firing_rate": 44.62425251432948, "i_spike": 34.0, "isi": 0.10298315156960297}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.6551329268600052, "Firing rate": 45.19942675342678, "firing_rate": 45.19942675342678, "i_spike": 37.0, "isi": 0.093301419712603}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.69527364698441, "Firing rate": 49.57624700967144, "firing_rate": 49.57624700967144, "i_spike": 60.0, "isi": 0.05731461647927743}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9208896212244086, "Firing rate": 83.34693260320056, "firing_rate": 83.34693260320056, "i_spike": 49.5, "isi": 0.06931637193428561}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7041853100676316, "Firing rate": 50.6040539493955, "firing_rate": 50.6040539493955, "i_spike": 53.5, "isi": 0.06377522396332294}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.8876746850385686, "Firing rate": 77.21020135400671, "firing_rate": 77.21020135400671, "i_spike": 44.5, "isi": 0.07889890042665214}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.3025158662274516, "Firing rate": 200.68544057708996, "firing_rate": 200.68544057708996, "i_spike": 62.5, "isi": 0.055406825403252244}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7129895664096098, "Firing rate": 51.640396291562276, "firing_rate": 51.640396291562276, "i_spike": 55.0, "isi": 0.0636710256761196}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0794802226698827, "Firing rate": 120.08263873540653, "firing_rate": 120.08263873540653, "i_spike": 61.0, "isi": 0.056886594850964804}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 3.8196248620566235, "Firing rate": 6601.229959822827, "firing_rate": 6601.229959822827, "i_spike": 59.0, "isi": 0.05977495416560611}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.047980227518541, "Firing rate": 111.68124005879586, "firing_rate": 111.68124005879586, "i_spike": 71.0, "isi": 0.049034070213298586}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0279807408897277, "Firing rate": 106.65488232844875, "firing_rate": 106.65488232844875, "i_spike": 62.0, "isi": 0.05645901896491608}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7959656093743934, "Firing rate": 62.512318897200444, "firing_rate": 62.512318897200444, "i_spike": 55.0, "isi": 0.06414183514845788}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.077038536883599, "Firing rate": 119.40940570472054, "firing_rate": 119.40940570472054, "i_spike": 63.5, "isi": 0.05492136012339617}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9168744609697081, "Firing rate": 82.5799206003511, "firing_rate": 82.5799206003511, "i_spike": 36.5, "isi": 0.09299306180716288}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.488699937077217, "Firing rate": 308.1058448500362, "firing_rate": 308.1058448500362, "i_spike": 37.5, "isi": 0.09016105638847716}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.0247972916540875, "Firing rate": 105.87594304608051, "firing_rate": 105.87594304608051, "i_spike": 50.5, "isi": 0.06835606609958876}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7242696189685587, "Firing rate": 52.99923719702183, "firing_rate": 52.99923719702183, "i_spike": 47.5, "isi": 0.07403466383069986}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7747779647103115, "Firing rate": 59.53576860259345, "firing_rate": 59.53576860259345, "i_spike": 47.0, "isi": 0.07467401981438761}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.856114230934512, "Firing rate": 71.79831149851739, "firing_rate": 71.79831149851739, "i_spike": 55.5, "isi": 0.06292299525234912}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.2746652796410833, "Firing rate": 188.21978788032956, "firing_rate": 188.21978788032956, "i_spike": 53.0, "isi": 0.06567643123845332}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.0337482943970966, "Firing rate": 108.0807362357806, "firing_rate": 108.0807362357806, "i_spike": 55.5, "isi": 0.06327209657626072}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7102837921532275, "Firing rate": 51.31966256461215, "firing_rate": 51.31966256461215, "i_spike": 55.5, "isi": 0.06305145559685234}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.623860433018629, "Firing rate": 42.05914433573161, "firing_rate": 42.05914433573161, "i_spike": 49.0, "isi": 0.07077737847115707}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.086492484252036, "Firing rate": 122.03727012196846, "firing_rate": 122.03727012196846, "i_spike": 62.5, "isi": 0.055440335913260225}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9008971531842567, "Firing rate": 79.59708314221336, "firing_rate": 79.59708314221336, "i_spike": 67.0, "isi": 0.0521022705808042}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.170949775879492, "Firing rate": 148.23466487937475, "firing_rate": 148.23466487937475, "i_spike": 73.0, "isi": 0.04801754450370519}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.014432853608186, "Firing rate": 103.37912538695966, "firing_rate": 103.37912538695966, "i_spike": 55.5, "isi": 0.0631033654585714}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.390138352660599, "Firing rate": 245.54910338671107, "firing_rate": 245.54910338671107, "i_spike": 68.5, "isi": 0.0498686472448898}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.17312642339557, "Firing rate": 148.97946947630794, "firing_rate": 148.97946947630794, "i_spike": 63.0, "isi": 0.055432663769367396}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.962784046672919, "Firing rate": 917.8760682766582, "firing_rate": 917.8760682766582, "i_spike": 49.5, "isi": 0.06995952779906722}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.260618762062384, "Firing rate": 182.22953293955686, "firing_rate": 182.22953293955686, "i_spike": 53.0, "isi": 0.06504496165531086}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.7643335769016688, "Firing rate": 58.12106677568765, "firing_rate": 58.12106677568765, "i_spike": 40.0, "isi": 0.0841152109661999}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0265559749635838, "Firing rate": 106.30555886161268, "firing_rate": 106.30555886161268, "i_spike": 52.5, "isi": 0.06652095760468996}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.9780418262117756, "Firing rate": 950.6963493028608, "firing_rate": 950.6963493028608, "i_spike": 58.0, "isi": 0.05930866628732656}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.9134500223799815, "Firing rate": 81.93133330423775, "firing_rate": 81.93133330423775, "i_spike": 54.0, "isi": 0.06503523289672261}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8957398838001527, "Firing rate": 78.65745378781511, "firing_rate": 78.65745378781511, "i_spike": 66.5, "isi": 0.05235340454476834}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8522054768028797, "Firing rate": 71.15500881700275, "firing_rate": 71.15500881700275, "i_spike": 45.5, "isi": 0.07676825913408296}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.6796696123981292, "Firing rate": 47.82661150662776, "firing_rate": 47.82661150662776, "i_spike": 51.0, "isi": 0.06756685722480459}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.1509753562194547, "Firing rate": 141.57134438654137, "firing_rate": 141.57134438654137, "i_spike": 49.5, "isi": 0.07052653304381483}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0210947001175086, "Firing rate": 104.97713116630348, "firing_rate": 104.97713116630348, "i_spike": 56.5, "isi": 0.05997895555411129}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8971385204106188, "Firing rate": 78.91117686536084, "firing_rate": 78.91117686536084, "i_spike": 57.5, "isi": 0.06112884023102998}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.09361903015509, "Firing rate": 124.05635885506653, "firing_rate": 124.05635885506653, "i_spike": 76.0, "isi": 0.04624706385358471}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0022255183188964, "Firing rate": 100.51375977318186, "firing_rate": 100.51375977318186, "i_spike": 66.0, "isi": 0.05205358056113488}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.530388800168889, "Firing rate": 339.1476406623546, "firing_rate": 339.1476406623546, "i_spike": 78.5, "isi": 0.04481352384371034}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.7625749512434323, "Firing rate": 578.8618806477893, "firing_rate": 578.8618806477893, "i_spike": 70.0, "isi": 0.04981258096695497}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.299312910645884, "Firing rate": 199.2108142702025, "firing_rate": 199.2108142702025, "i_spike": 46.5, "isi": 0.07403925826623017}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8441335742513445, "Firing rate": 69.84471897092841, "firing_rate": 69.84471897092841, "i_spike": 38.0, "isi": 0.09075222734556197}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.2862005880236786, "Firing rate": 193.28608432423695, "firing_rate": 193.28608432423695, "i_spike": 53.0, "isi": 0.06631494635546518}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8204981856691582, "Firing rate": 66.14517741635231, "firing_rate": 66.14517741635231, "i_spike": 62.5, "isi": 0.05513974533091999}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.5088052830744627, "Firing rate": 322.7046943426696, "firing_rate": 322.7046943426696, "i_spike": 58.0, "isi": 0.060387590945790215}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.472431307738566, "Firing rate": 296.77772936645704, "firing_rate": 296.77772936645704, "i_spike": 60.5, "isi": 0.05510863256369343}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.018912385818528, "Firing rate": 104.45094795533947, "firing_rate": 104.45094795533947, "i_spike": 56.0, "isi": 0.061735038216968116}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 3.77525614723118, "Firing rate": 5960.135691608573, "firing_rate": 5960.135691608573, "i_spike": 63.5, "isi": 0.05455049228943895}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.425248738430856, "Firing rate": 266.22494036881653, "firing_rate": 266.22494036881653, "i_spike": 54.5, "isi": 0.06402760616986113}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0501405500672263, "Firing rate": 112.23816302035134, "firing_rate": 112.23816302035134, "i_spike": 49.5, "isi": 0.07014517062678283}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.771820435125257, "Firing rate": 59.131709564599554, "firing_rate": 59.131709564599554, "i_spike": 59.5, "isi": 0.05850585420279421}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0308241700419605, "Firing rate": 107.35546813022263, "firing_rate": 107.35546813022263, "i_spike": 59.5, "isi": 0.05857757898575768}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.004448737867266, "Firing rate": 101.02962427459981, "firing_rate": 101.02962427459981, "i_spike": 68.0, "isi": 0.05071131320510058}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.080338831272671, "Firing rate": 120.32027927069372, "firing_rate": 120.32027927069372, "i_spike": 69.0, "isi": 0.0510594674412988}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.006550000011574, "Firing rate": 101.51962386581975, "firing_rate": 101.51962386581975, "i_spike": 72.0, "isi": 0.04889176399435442}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0957887205498387, "Firing rate": 124.67768235798627, "firing_rate": 124.67768235798627, "i_spike": 71.0, "isi": 0.04875075220580193}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7129953889790646, "Firing rate": 51.64108863701497, "firing_rate": 51.64108863701497, "i_spike": 47.0, "isi": 0.07407410375892211}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9176720904259803, "Firing rate": 82.73172704512176, "firing_rate": 82.73172704512176, "i_spike": 47.0, "isi": 0.07463164864213223}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.007159580492023, "Firing rate": 101.66221796911948, "firing_rate": 101.66221796911948, "i_spike": 65.0, "isi": 0.05304419379015969}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.122172983668936, "Firing rate": 132.4869138232593, "firing_rate": 132.4869138232593, "i_spike": 35.5, "isi": 0.0949229188448354}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.6494585974372233, "Firing rate": 44.612709195352735, "firing_rate": 44.612709195352735, "i_spike": 54.5, "isi": 0.06314543853624136}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7853062493498477, "Firing rate": 60.996687302488056, "firing_rate": 60.996687302488056, "i_spike": 55.5, "isi": 0.0628909492482099}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0644173227729214, "Firing rate": 115.98913850392412, "firing_rate": 115.98913850392412, "i_spike": 61.5, "isi": 0.056943878795214196}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9598246573572768, "Firing rate": 91.16426971856897, "firing_rate": 91.16426971856897, "i_spike": 59.5, "isi": 0.05609529089347159}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 3.2307297954964778, "Firing rate": 1701.0998077524973, "firing_rate": 1701.0998077524973, "i_spike": 53.0, "isi": 0.06455134352306668}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.26956072024762, "Firing rate": 186.02046268303891, "firing_rate": 186.02046268303891, "i_spike": 57.0, "isi": 0.06079792191872519}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.1711091446972834, "Firing rate": 148.28907109300155, "firing_rate": 148.28907109300155, "i_spike": 70.0, "isi": 0.049751367714446076}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9763902613433886, "Firing rate": 94.70878416532676, "firing_rate": 94.70878416532676, "i_spike": 49.0, "isi": 0.07142234905887407}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.099618182629192, "Firing rate": 125.78190925248916, "firing_rate": 125.78190925248916, "i_spike": 62.5, "isi": 0.05579369818303655}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.838187535206748, "Firing rate": 688.9497314808656, "firing_rate": 688.9497314808656, "i_spike": 63.0, "isi": 0.055005709328377936}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.061096595860693, "Firing rate": 115.10563786518883, "firing_rate": 115.10563786518883, "i_spike": 63.0, "isi": 0.05495805383263194}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0490378816217922, "Firing rate": 111.95355314313629, "firing_rate": 111.95355314313629, "i_spike": 68.0, "isi": 0.050790137933945205}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="n">y</span><span class="o">=</span><span class="s1">&#39;isi&#39;</span>
<span class="n">color</span><span class="o">=</span><span class="s1">&#39;mouse&#39;</span>
<span class="n">x</span><span class="o">=</span><span class="s1">&#39;neuron&#39;</span>

<span class="n">base</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mean(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                    <span class="n">scale</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">domain</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.95</span><span class="p">])))),</span>
<span class="p">)</span>

<span class="c1"># Create a selection that chooses the nearest point &amp; selects based on x-value</span>
<span class="n">nearest</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                        <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">empty</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>


<span class="c1"># Transparent selectors across the chart. This is what tells us</span>
<span class="c1"># the x-value of the cursor</span>
<span class="n">selectors</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">nearest</span>
<span class="p">)</span>

<span class="n">highlight</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">selection</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span>
                          <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">nearest</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lines</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">mark_line</span><span class="p">(</span><span class="n">clip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="c1">#tooltip=color,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="o">~</span><span class="n">highlight</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="p">)</span>

<span class="c1"># Draw text labels near the points, and highlight based on selection</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">mark_text</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dy</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span><span class="n">nearest</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">points</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_selection</span><span class="p">(</span>
    <span class="n">highlight</span>
<span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">selectors</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">text</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div id="altair-viz-fd87dbb7a1d144e1a717f83b2e91ee11"></div>
<script type="text/javascript">
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== "altair-viz-fd87dbb7a1d144e1a717f83b2e91ee11") {
      outputDiv = document.getElementById("altair-viz-fd87dbb7a1d144e1a717f83b2e91ee11");
    }
    const paths = {
      "vega": "https://cdn.jsdelivr.net/npm//vega@5?noext",
      "vega-lib": "https://cdn.jsdelivr.net/npm//vega-lib?noext",
      "vega-lite": "https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext",
      "vega-embed": "https://cdn.jsdelivr.net/npm//vega-embed@6?noext",
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () => resolve(paths[lib]);
        s.onerror = () => reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName("head")[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `<div class="error" style="color:red;">${err}</div>`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === "function" && define.amd) {
      requirejs.config({paths});
      require(["vega-embed"], displayChart, err => showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === "function") {
      displayChart(vegaEmbed);
    } else {
      loadScript("vega")
        .then(() => loadScript("vega-lite"))
        .then(() => loadScript("vega-embed"))
        .catch(showError)
        .then(() => displayChart(vegaEmbed));
    }
  })({"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}}, "layer": [{"mark": {"type": "line", "clip": true, "fill": null, "opacity": 0.6}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.0488001063317953, 0.09315299387158013], "zero": false}}}}, {"mark": "point", "encoding": {"opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}}, "selection": {"selector002": {"type": "single", "nearest": true, "on": "mouseover", "fields": ["neuron"], "empty": "none"}}}, {"mark": "circle", "encoding": {"color": {"type": "nominal", "field": "mouse"}, "opacity": {"value": 0}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.0488001063317953, 0.09315299387158013], "zero": false}}}, "selection": {"selector003": {"type": "single", "on": "mouseover", "fields": ["mouse"], "nearest": true}}}, {"mark": {"type": "text", "align": "left", "dx": 5, "dy": -5}, "encoding": {"color": {"type": "nominal", "field": "mouse"}, "size": {"condition": {"value": 1, "selection": {"not": "selector003"}}, "value": 3}, "text": {"condition": {"type": "quantitative", "field": "isi", "selection": "selector002"}, "value": " "}, "x": {"type": "nominal", "field": "neuron"}, "y": {"type": "quantitative", "aggregate": "mean", "field": "isi", "scale": {"domain": [0.0488001063317953, 0.09315299387158013], "zero": false}}}}], "data": {"name": "data-018b7f0fa625fab2206ad57d0e1fb720"}, "$schema": "https://vega.github.io/schema/vega-lite/v4.8.1.json", "datasets": {"data-018b7f0fa625fab2206ad57d0e1fb720": [{"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.0287791467103675, "Firing rate": 106.8511367220051, "firing_rate": 106.8511367220051, "i_spike": 35.5, "isi": 0.09586702735617403}, {"stim": 0, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.888152219431406, "Firing rate": 77.2951455712081, "firing_rate": 77.2951455712081, "i_spike": 49.0, "isi": 0.06938830963190289}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7804951357126013, "Firing rate": 60.32469512601141, "firing_rate": 60.32469512601141, "i_spike": 43.5, "isi": 0.08027488807176461}, {"stim": 0, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9807968320311549, "Firing rate": 95.6746389589182, "firing_rate": 95.6746389589182, "i_spike": 49.0, "isi": 0.07072458751282588}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.60389434521973, "Firing rate": 40.1693075422204, "firing_rate": 40.1693075422204, "i_spike": 45.5, "isi": 0.07494942910840988}, {"stim": 0, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.830949171434896, "Firing rate": 677.5622030571651, "firing_rate": 677.5622030571651, "i_spike": 55.5, "isi": 0.06205554292242925}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.057399150827541, "Firing rate": 114.12982486406511, "firing_rate": 114.12982486406511, "i_spike": 56.5, "isi": 0.06137686548636755}, {"stim": 0, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7597313816613502, "Firing rate": 57.50841282420635, "firing_rate": 57.50841282420635, "i_spike": 50.5, "isi": 0.06971393083938743}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.961154345613815, "Firing rate": 91.44381694841965, "firing_rate": 91.44381694841965, "i_spike": 61.5, "isi": 0.05669616737410285}, {"stim": 0, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.124418010434087, "Firing rate": 133.1735602942126, "firing_rate": 133.1735602942126, "i_spike": 55.5, "isi": 0.06300452779703669}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.8424706312651455, "Firing rate": 69.5777901817132, "firing_rate": 69.5777901817132, "i_spike": 65.0, "isi": 0.05328715846797061}, {"stim": 0, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.650245980556241, "Firing rate": 446.93666145109546, "firing_rate": 446.93666145109546, "i_spike": 67.5, "isi": 0.05215666504979185}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7669577564445893, "Firing rate": 58.47332047413593, "firing_rate": 58.47332047413593, "i_spike": 60.0, "isi": 0.05860534479679852}, {"stim": 0, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9742323339388193, "Firing rate": 94.23936127464658, "firing_rate": 94.23936127464658, "i_spike": 56.0, "isi": 0.06122745127201878}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.2332208452626587, "Firing rate": 171.088510467654, "firing_rate": 171.088510467654, "i_spike": 82.5, "isi": 0.04171026408252973}, {"stim": 0, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.658807011827811, "Firing rate": 455.8343110762482, "firing_rate": 455.8343110762482, "i_spike": 63.0, "isi": 0.055685604529106696}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.2932095061384805, "Firing rate": 196.43076415357413, "firing_rate": 196.43076415357413, "i_spike": 37.5, "isi": 0.09197668224040262}, {"stim": 0, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.5800073582133565, "Firing rate": 38.01958378907624, "firing_rate": 38.01958378907624, "i_spike": 33.0, "isi": 0.10656850120716019}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.1331384665735245, "Firing rate": 135.87465881599363, "firing_rate": 135.87465881599363, "i_spike": 42.5, "isi": 0.08168825883317743}, {"stim": 0, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.675758863154722, "Firing rate": 47.39787411272408, "firing_rate": 47.39787411272408, "i_spike": 39.5, "isi": 0.08452875398139272}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.6045312670964003, "Firing rate": 40.22826173535397, "firing_rate": 40.22826173535397, "i_spike": 39.0, "isi": 0.08877407748429665}, {"stim": 0, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.7253590842157345, "Firing rate": 53.13235726644105, "firing_rate": 53.13235726644105, "i_spike": 40.5, "isi": 0.08536828748745495}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8819039004811342, "Firing rate": 76.1910397880472, "firing_rate": 76.1910397880472, "i_spike": 52.5, "isi": 0.0657398448300991}, {"stim": 0, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0687903157451126, "Firing rate": 117.16295476625199, "firing_rate": 117.16295476625199, "i_spike": 62.0, "isi": 0.055063596747366876}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.1592924543847727, "Firing rate": 144.30868006494063, "firing_rate": 144.30868006494063, "i_spike": 59.5, "isi": 0.058283462378306936}, {"stim": 0, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8195318559134468, "Firing rate": 65.99816427695586, "firing_rate": 65.99816427695586, "i_spike": 63.0, "isi": 0.0547575790750348}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0784478508685664, "Firing rate": 119.79752643037288, "firing_rate": 119.79752643037288, "i_spike": 66.0, "isi": 0.052535821871554304}, {"stim": 0, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8474834697525035, "Firing rate": 70.38554370687628, "firing_rate": 70.38554370687628, "i_spike": 59.5, "isi": 0.05902297278434249}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.097996053455225, "Firing rate": 125.3129787379539, "firing_rate": 125.3129787379539, "i_spike": 61.0, "isi": 0.05752914070485048}, {"stim": 0, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.793100142046089, "Firing rate": 62.101221418496365, "firing_rate": 62.101221418496365, "i_spike": 52.5, "isi": 0.06668991264317461}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.198136440526753, "Firing rate": 157.81069792634494, "firing_rate": 157.81069792634494, "i_spike": 69.5, "isi": 0.05008933968337417}, {"stim": 0, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.325845701413527, "Firing rate": 211.76086456706952, "firing_rate": 211.76086456706952, "i_spike": 78.0, "isi": 0.044760916232476834}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.6188027215370822, "Firing rate": 41.57217258166482, "firing_rate": 41.57217258166482, "i_spike": 37.5, "isi": 0.09094753085532499}, {"stim": 0, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.9229488338247642, "Firing rate": 83.7430614868749, "firing_rate": 83.7430614868749, "i_spike": 47.0, "isi": 0.07320875598463418}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.166441678683907, "Firing rate": 146.70390653065934, "firing_rate": 146.70390653065934, "i_spike": 47.5, "isi": 0.07420159334452443}, {"stim": 0, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.1989229218427893, "Firing rate": 158.09674258268916, "firing_rate": 158.09674258268916, "i_spike": 45.5, "isi": 0.07689298829895631}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8337183167891113, "Firing rate": 68.18962730558536, "firing_rate": 68.18962730558536, "i_spike": 46.5, "isi": 0.07325868376103088}, {"stim": 0, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.6048398668106683, "Firing rate": 402.5685717541662, "firing_rate": 402.5685717541662, "i_spike": 59.0, "isi": 0.059308461551573516}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8360911682429826, "Firing rate": 68.56321410538973, "firing_rate": 68.56321410538973, "i_spike": 42.5, "isi": 0.08277939856764525}, {"stim": 0, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0843524257626793, "Firing rate": 121.43739033827886, "firing_rate": 121.43739033827886, "i_spike": 54.5, "isi": 0.06448725237318}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.1383182085567958, "Firing rate": 137.50491076186384, "firing_rate": 137.50491076186384, "i_spike": 59.5, "isi": 0.05606900613784995}, {"stim": 0, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.3169420465960355, "Firing rate": 207.46366539820582, "firing_rate": 207.46366539820582, "i_spike": 50.5, "isi": 0.06963848790908173}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.306983891741586, "Firing rate": 202.76075128749613, "firing_rate": 202.76075128749613, "i_spike": 59.5, "isi": 0.05897462692736115}, {"stim": 0, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.272416349963913, "Firing rate": 187.2476388121454, "firing_rate": 187.2476388121454, "i_spike": 64.5, "isi": 0.05429080743408067}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.082481778213417, "Firing rate": 120.91544491267233, "firing_rate": 120.91544491267233, "i_spike": 77.0, "isi": 0.04529665695748603}, {"stim": 0, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.766243783294815, "Firing rate": 58.37727024900301, "firing_rate": 58.37727024900301, "i_spike": 64.0, "isi": 0.05422059902037592}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8717357314532728, "Firing rate": 74.42789417411862, "firing_rate": 74.42789417411862, "i_spike": 60.5, "isi": 0.0578192591207897}, {"stim": 0, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.2747248667398425, "Firing rate": 188.24561422857306, "firing_rate": 188.24561422857306, "i_spike": 60.0, "isi": 0.0583351686678796}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.6369861396612275, "Firing rate": 43.349704327792885, "firing_rate": 43.349704327792885, "i_spike": 36.5, "isi": 0.09323911113703558}, {"stim": 0, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.8611287387861641, "Firing rate": 72.63212303888466, "firing_rate": 72.63212303888466, "i_spike": 36.5, "isi": 0.09430845100920474}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.649570954462079, "Firing rate": 44.62425251432948, "firing_rate": 44.62425251432948, "i_spike": 34.0, "isi": 0.10298315156960297}, {"stim": 0, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.6551329268600052, "Firing rate": 45.19942675342678, "firing_rate": 45.19942675342678, "i_spike": 37.0, "isi": 0.093301419712603}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.69527364698441, "Firing rate": 49.57624700967144, "firing_rate": 49.57624700967144, "i_spike": 60.0, "isi": 0.05731461647927743}, {"stim": 0, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9208896212244086, "Firing rate": 83.34693260320056, "firing_rate": 83.34693260320056, "i_spike": 49.5, "isi": 0.06931637193428561}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7041853100676316, "Firing rate": 50.6040539493955, "firing_rate": 50.6040539493955, "i_spike": 53.5, "isi": 0.06377522396332294}, {"stim": 0, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.8876746850385686, "Firing rate": 77.21020135400671, "firing_rate": 77.21020135400671, "i_spike": 44.5, "isi": 0.07889890042665214}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.3025158662274516, "Firing rate": 200.68544057708996, "firing_rate": 200.68544057708996, "i_spike": 62.5, "isi": 0.055406825403252244}, {"stim": 0, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7129895664096098, "Firing rate": 51.640396291562276, "firing_rate": 51.640396291562276, "i_spike": 55.0, "isi": 0.0636710256761196}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0794802226698827, "Firing rate": 120.08263873540653, "firing_rate": 120.08263873540653, "i_spike": 61.0, "isi": 0.056886594850964804}, {"stim": 0, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 3.8196248620566235, "Firing rate": 6601.229959822827, "firing_rate": 6601.229959822827, "i_spike": 59.0, "isi": 0.05977495416560611}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.047980227518541, "Firing rate": 111.68124005879586, "firing_rate": 111.68124005879586, "i_spike": 71.0, "isi": 0.049034070213298586}, {"stim": 0, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0279807408897277, "Firing rate": 106.65488232844875, "firing_rate": 106.65488232844875, "i_spike": 62.0, "isi": 0.05645901896491608}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7959656093743934, "Firing rate": 62.512318897200444, "firing_rate": 62.512318897200444, "i_spike": 55.0, "isi": 0.06414183514845788}, {"stim": 0, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.077038536883599, "Firing rate": 119.40940570472054, "firing_rate": 119.40940570472054, "i_spike": 63.5, "isi": 0.05492136012339617}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9168744609697081, "Firing rate": 82.5799206003511, "firing_rate": 82.5799206003511, "i_spike": 36.5, "isi": 0.09299306180716288}, {"stim": 1, "neuron_x_mouse": "m0bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 0, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.488699937077217, "Firing rate": 308.1058448500362, "firing_rate": 308.1058448500362, "i_spike": 37.5, "isi": 0.09016105638847716}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.0247972916540875, "Firing rate": 105.87594304608051, "firing_rate": 105.87594304608051, "i_spike": 50.5, "isi": 0.06835606609958876}, {"stim": 1, "neuron_x_mouse": "m0bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 1, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7242696189685587, "Firing rate": 52.99923719702183, "firing_rate": 52.99923719702183, "i_spike": 47.5, "isi": 0.07403466383069986}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7747779647103115, "Firing rate": 59.53576860259345, "firing_rate": 59.53576860259345, "i_spike": 47.0, "isi": 0.07467401981438761}, {"stim": 1, "neuron_x_mouse": "m0bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 2, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.856114230934512, "Firing rate": 71.79831149851739, "firing_rate": 71.79831149851739, "i_spike": 55.5, "isi": 0.06292299525234912}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.2746652796410833, "Firing rate": 188.21978788032956, "firing_rate": 188.21978788032956, "i_spike": 53.0, "isi": 0.06567643123845332}, {"stim": 1, "neuron_x_mouse": "m0bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 3, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.0337482943970966, "Firing rate": 108.0807362357806, "firing_rate": 108.0807362357806, "i_spike": 55.5, "isi": 0.06327209657626072}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.7102837921532275, "Firing rate": 51.31966256461215, "firing_rate": 51.31966256461215, "i_spike": 55.5, "isi": 0.06305145559685234}, {"stim": 1, "neuron_x_mouse": "m0bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 4, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.623860433018629, "Firing rate": 42.05914433573161, "firing_rate": 42.05914433573161, "i_spike": 49.0, "isi": 0.07077737847115707}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.086492484252036, "Firing rate": 122.03727012196846, "firing_rate": 122.03727012196846, "i_spike": 62.5, "isi": 0.055440335913260225}, {"stim": 1, "neuron_x_mouse": "m0bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 5, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 1.9008971531842567, "Firing rate": 79.59708314221336, "firing_rate": 79.59708314221336, "i_spike": 67.0, "isi": 0.0521022705808042}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.170949775879492, "Firing rate": 148.23466487937475, "firing_rate": 148.23466487937475, "i_spike": 73.0, "isi": 0.04801754450370519}, {"stim": 1, "neuron_x_mouse": "m0bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 6, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.014432853608186, "Firing rate": 103.37912538695966, "firing_rate": 103.37912538695966, "i_spike": 55.5, "isi": 0.0631033654585714}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.390138352660599, "Firing rate": 245.54910338671107, "firing_rate": 245.54910338671107, "i_spike": 68.5, "isi": 0.0498686472448898}, {"stim": 1, "neuron_x_mouse": "m0bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 7, "mouse": "m0bayes", "mouse_code": 0, "log_firing_rate": 2.17312642339557, "Firing rate": 148.97946947630794, "firing_rate": 148.97946947630794, "i_spike": 63.0, "isi": 0.055432663769367396}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.962784046672919, "Firing rate": 917.8760682766582, "firing_rate": 917.8760682766582, "i_spike": 49.5, "isi": 0.06995952779906722}, {"stim": 1, "neuron_x_mouse": "m1bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 8, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.260618762062384, "Firing rate": 182.22953293955686, "firing_rate": 182.22953293955686, "i_spike": 53.0, "isi": 0.06504496165531086}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.7643335769016688, "Firing rate": 58.12106677568765, "firing_rate": 58.12106677568765, "i_spike": 40.0, "isi": 0.0841152109661999}, {"stim": 1, "neuron_x_mouse": "m1bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 9, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0265559749635838, "Firing rate": 106.30555886161268, "firing_rate": 106.30555886161268, "i_spike": 52.5, "isi": 0.06652095760468996}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.9780418262117756, "Firing rate": 950.6963493028608, "firing_rate": 950.6963493028608, "i_spike": 58.0, "isi": 0.05930866628732656}, {"stim": 1, "neuron_x_mouse": "m1bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 10, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.9134500223799815, "Firing rate": 81.93133330423775, "firing_rate": 81.93133330423775, "i_spike": 54.0, "isi": 0.06503523289672261}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8957398838001527, "Firing rate": 78.65745378781511, "firing_rate": 78.65745378781511, "i_spike": 66.5, "isi": 0.05235340454476834}, {"stim": 1, "neuron_x_mouse": "m1bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 11, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8522054768028797, "Firing rate": 71.15500881700275, "firing_rate": 71.15500881700275, "i_spike": 45.5, "isi": 0.07676825913408296}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.6796696123981292, "Firing rate": 47.82661150662776, "firing_rate": 47.82661150662776, "i_spike": 51.0, "isi": 0.06756685722480459}, {"stim": 1, "neuron_x_mouse": "m1bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 12, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.1509753562194547, "Firing rate": 141.57134438654137, "firing_rate": 141.57134438654137, "i_spike": 49.5, "isi": 0.07052653304381483}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0210947001175086, "Firing rate": 104.97713116630348, "firing_rate": 104.97713116630348, "i_spike": 56.5, "isi": 0.05997895555411129}, {"stim": 1, "neuron_x_mouse": "m1bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 13, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 1.8971385204106188, "Firing rate": 78.91117686536084, "firing_rate": 78.91117686536084, "i_spike": 57.5, "isi": 0.06112884023102998}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.09361903015509, "Firing rate": 124.05635885506653, "firing_rate": 124.05635885506653, "i_spike": 76.0, "isi": 0.04624706385358471}, {"stim": 1, "neuron_x_mouse": "m1bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 14, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.0022255183188964, "Firing rate": 100.51375977318186, "firing_rate": 100.51375977318186, "i_spike": 66.0, "isi": 0.05205358056113488}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.530388800168889, "Firing rate": 339.1476406623546, "firing_rate": 339.1476406623546, "i_spike": 78.5, "isi": 0.04481352384371034}, {"stim": 1, "neuron_x_mouse": "m1bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 15, "mouse": "m1bayes", "mouse_code": 1, "log_firing_rate": 2.7625749512434323, "Firing rate": 578.8618806477893, "firing_rate": 578.8618806477893, "i_spike": 70.0, "isi": 0.04981258096695497}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.299312910645884, "Firing rate": 199.2108142702025, "firing_rate": 199.2108142702025, "i_spike": 46.5, "isi": 0.07403925826623017}, {"stim": 1, "neuron_x_mouse": "m2bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 16, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8441335742513445, "Firing rate": 69.84471897092841, "firing_rate": 69.84471897092841, "i_spike": 38.0, "isi": 0.09075222734556197}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.2862005880236786, "Firing rate": 193.28608432423695, "firing_rate": 193.28608432423695, "i_spike": 53.0, "isi": 0.06631494635546518}, {"stim": 1, "neuron_x_mouse": "m2bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 17, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.8204981856691582, "Firing rate": 66.14517741635231, "firing_rate": 66.14517741635231, "i_spike": 62.5, "isi": 0.05513974533091999}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.5088052830744627, "Firing rate": 322.7046943426696, "firing_rate": 322.7046943426696, "i_spike": 58.0, "isi": 0.060387590945790215}, {"stim": 1, "neuron_x_mouse": "m2bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 18, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.472431307738566, "Firing rate": 296.77772936645704, "firing_rate": 296.77772936645704, "i_spike": 60.5, "isi": 0.05510863256369343}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.018912385818528, "Firing rate": 104.45094795533947, "firing_rate": 104.45094795533947, "i_spike": 56.0, "isi": 0.061735038216968116}, {"stim": 1, "neuron_x_mouse": "m2bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 19, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 3.77525614723118, "Firing rate": 5960.135691608573, "firing_rate": 5960.135691608573, "i_spike": 63.5, "isi": 0.05455049228943895}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.425248738430856, "Firing rate": 266.22494036881653, "firing_rate": 266.22494036881653, "i_spike": 54.5, "isi": 0.06402760616986113}, {"stim": 1, "neuron_x_mouse": "m2bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 20, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0501405500672263, "Firing rate": 112.23816302035134, "firing_rate": 112.23816302035134, "i_spike": 49.5, "isi": 0.07014517062678283}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 1.771820435125257, "Firing rate": 59.131709564599554, "firing_rate": 59.131709564599554, "i_spike": 59.5, "isi": 0.05850585420279421}, {"stim": 1, "neuron_x_mouse": "m2bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 21, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0308241700419605, "Firing rate": 107.35546813022263, "firing_rate": 107.35546813022263, "i_spike": 59.5, "isi": 0.05857757898575768}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.004448737867266, "Firing rate": 101.02962427459981, "firing_rate": 101.02962427459981, "i_spike": 68.0, "isi": 0.05071131320510058}, {"stim": 1, "neuron_x_mouse": "m2bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 22, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.080338831272671, "Firing rate": 120.32027927069372, "firing_rate": 120.32027927069372, "i_spike": 69.0, "isi": 0.0510594674412988}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.006550000011574, "Firing rate": 101.51962386581975, "firing_rate": 101.51962386581975, "i_spike": 72.0, "isi": 0.04889176399435442}, {"stim": 1, "neuron_x_mouse": "m2bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 23, "mouse": "m2bayes", "mouse_code": 2, "log_firing_rate": 2.0957887205498387, "Firing rate": 124.67768235798627, "firing_rate": 124.67768235798627, "i_spike": 71.0, "isi": 0.04875075220580193}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 0, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7129953889790646, "Firing rate": 51.64108863701497, "firing_rate": 51.64108863701497, "i_spike": 47.0, "isi": 0.07407410375892211}, {"stim": 1, "neuron_x_mouse": "m3bayes0", "neuron": "0", "i_trial": 1, "neuron_code": 24, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9176720904259803, "Firing rate": 82.73172704512176, "firing_rate": 82.73172704512176, "i_spike": 47.0, "isi": 0.07463164864213223}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 0, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.007159580492023, "Firing rate": 101.66221796911948, "firing_rate": 101.66221796911948, "i_spike": 65.0, "isi": 0.05304419379015969}, {"stim": 1, "neuron_x_mouse": "m3bayes1", "neuron": "1", "i_trial": 1, "neuron_code": 25, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.122172983668936, "Firing rate": 132.4869138232593, "firing_rate": 132.4869138232593, "i_spike": 35.5, "isi": 0.0949229188448354}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 0, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.6494585974372233, "Firing rate": 44.612709195352735, "firing_rate": 44.612709195352735, "i_spike": 54.5, "isi": 0.06314543853624136}, {"stim": 1, "neuron_x_mouse": "m3bayes2", "neuron": "2", "i_trial": 1, "neuron_code": 26, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.7853062493498477, "Firing rate": 60.996687302488056, "firing_rate": 60.996687302488056, "i_spike": 55.5, "isi": 0.0628909492482099}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 0, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0644173227729214, "Firing rate": 115.98913850392412, "firing_rate": 115.98913850392412, "i_spike": 61.5, "isi": 0.056943878795214196}, {"stim": 1, "neuron_x_mouse": "m3bayes3", "neuron": "3", "i_trial": 1, "neuron_code": 27, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9598246573572768, "Firing rate": 91.16426971856897, "firing_rate": 91.16426971856897, "i_spike": 59.5, "isi": 0.05609529089347159}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 0, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 3.2307297954964778, "Firing rate": 1701.0998077524973, "firing_rate": 1701.0998077524973, "i_spike": 53.0, "isi": 0.06455134352306668}, {"stim": 1, "neuron_x_mouse": "m3bayes4", "neuron": "4", "i_trial": 1, "neuron_code": 28, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.26956072024762, "Firing rate": 186.02046268303891, "firing_rate": 186.02046268303891, "i_spike": 57.0, "isi": 0.06079792191872519}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 0, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.1711091446972834, "Firing rate": 148.28907109300155, "firing_rate": 148.28907109300155, "i_spike": 70.0, "isi": 0.049751367714446076}, {"stim": 1, "neuron_x_mouse": "m3bayes5", "neuron": "5", "i_trial": 1, "neuron_code": 29, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 1.9763902613433886, "Firing rate": 94.70878416532676, "firing_rate": 94.70878416532676, "i_spike": 49.0, "isi": 0.07142234905887407}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 0, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.099618182629192, "Firing rate": 125.78190925248916, "firing_rate": 125.78190925248916, "i_spike": 62.5, "isi": 0.05579369818303655}, {"stim": 1, "neuron_x_mouse": "m3bayes6", "neuron": "6", "i_trial": 1, "neuron_code": 30, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.838187535206748, "Firing rate": 688.9497314808656, "firing_rate": 688.9497314808656, "i_spike": 63.0, "isi": 0.055005709328377936}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 0, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.061096595860693, "Firing rate": 115.10563786518883, "firing_rate": 115.10563786518883, "i_spike": 63.0, "isi": 0.05495805383263194}, {"stim": 1, "neuron_x_mouse": "m3bayes7", "neuron": "7", "i_trial": 1, "neuron_code": 31, "mouse": "m3bayes", "mouse_code": 3, "log_firing_rate": 2.0490378816217922, "Firing rate": 111.95355314313629, "firing_rate": 111.95355314313629, "i_spike": 68.0, "isi": 0.050790137933945205}]}}, {"mode": "vega-lite"});
</script></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./neurons_example"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="model_comparison.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Compare to alternative models</p>
        </div>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Max Myroshnychenko<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>